<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Сǿ�Ĳ���</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="��վ��Сǿ�ļ����������͡����ݺ���Java��˼�������ص��о���֪ʶ������">
<meta property="og:type" content="website">
<meta property="og:title" content="Сǿ�Ĳ���">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="Сǿ�Ĳ���">
<meta property="og:description" content="��վ��Сǿ�ļ����������͡����ݺ���Java��˼�������ص��о���֪ʶ������">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="��ǿ��Сǿ">
<meta property="article:tag" content="��ǿ��Сǿ">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Сǿ�Ĳ���" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Сǿ�Ĳ���</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">��ӭ�����������</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-Spring5" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/01/30/Spring5/" class="article-date">
  <time class="dt-published" datetime="2022-01-30T05:47:47.000Z" itemprop="datePublished">2022-01-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/01/30/Spring5/">Spring5</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Spring5"><a href="#Spring5" class="headerlink" title="Spring5"></a>Spring5</h1><p>一个容器，创建对象，管理对象之间的关系，底层是使用反射实现的</p>
<p>dao类、service类、controller类、工具类放入Spring容器中（xml文件、注解）</p>
<p>实体类、servlet、listener、filter等不放入Spring容器中</p>
<p>spring-context：是ioc功能的，创建对象的</p>
<p>spring-webmvc做web开发使用的， 是servlet的升级。 spring-webmvc中也会用到spring-context中创建对象的功能的</p>
<h2 id="IOC容器"><a href="#IOC容器" class="headerlink" title="IOC容器"></a>IOC容器</h2><h3 id="IOC概念和原理"><a href="#IOC概念和原理" class="headerlink" title="IOC概念和原理"></a>IOC概念和原理</h3><ul>
<li>控制反转，把对象创建和对象的调用过程交给spring进行管理</li>
<li>目的：降低耦合度</li>
<li>底层原理：xml，反射，工厂模式</li>
<li>Spring提供IOC容器两种实现方式（两个接口）<ul>
<li><strong>BeanFactory</strong>：Spring内部使用的接口，不提倡开发人员使用。特点：加载配置文件时不会创建对象，获取对象时才会创建对象</li>
<li><strong>ApplicationContext：</strong>BeanFactory的子接口，提供了更多更强大的功能，一般由开发人员使用。特点：加载配置文件时会把配置文件里的对象进行创建<ul>
<li>FileSystemXmlApplicationContext：绝对路径，从盘符开始算起</li>
<li>ClassPathXmlApplicationContext：相对路径，从src开始算起</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="IOC操作Bean（基于xml）"><a href="#IOC操作Bean（基于xml）" class="headerlink" title="IOC操作Bean（基于xml）"></a>IOC操作Bean（基于xml）</h3><h4 id="xml实现Bean管理"><a href="#xml实现Bean管理" class="headerlink" title="xml实现Bean管理"></a>xml实现Bean管理</h4><h5 id="基于xml方式创建对象"><a href="#基于xml方式创建对象" class="headerlink" title="基于xml方式创建对象"></a>基于xml方式创建对象</h5><p>创建对象时，默认执行无参构造函数</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">声明bean，告诉spring要创建某个类的对象，将创建好的对象放入spring中的map集合</span></span><br><span class="line"><span class="comment">    id：对象的自定义名称</span></span><br><span class="line"><span class="comment">    class：类的额全限定名称（不能是接口）</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.entity.User&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>



<h5 id="基于xml方式注入属性"><a href="#基于xml方式注入属性" class="headerlink" title="基于xml方式注入属性"></a>基于xml方式注入属性</h5><h6 id="使用set方法进行注入"><a href="#使用set方法进行注入" class="headerlink" title="使用set方法进行注入"></a>使用set方法进行注入</h6><p>在类中给属性创建set方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserName</span><span class="params">(String userName)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userName = userName;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUserName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userName;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在xml配置文件中通过property标签进行属性注入</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">bean标签创建对象</span></span><br><span class="line"><span class="comment">	id：唯一标识</span></span><br><span class="line"><span class="comment">	class：类路径</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.entity.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">		property：使用set方法给属性赋值，一个property只能给一个属性赋值</span></span><br><span class="line"><span class="comment">			name：属性名</span></span><br><span class="line"><span class="comment">			value：属性值（简单类型）</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;狗子&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;bean1.xml&quot;</span>);</span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;user&quot;</span>, User.class);</span><br><span class="line">System.out.println(user.getUserName());</span><br></pre></td></tr></table></figure>



<h6 id="使用有参构造函数进行注入"><a href="#使用有参构造函数进行注入" class="headerlink" title="使用有参构造函数进行注入"></a>使用有参构造函数进行注入</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(String userName)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.userName = userName;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后再xml配置文件中通过constructor-arg标签进行属性注入</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">     声明bean，告诉spring要创建某个类的对象，将创建好的对象放入spring中的map集合</span></span><br><span class="line"><span class="comment">     id：对象的自定义名称</span></span><br><span class="line"><span class="comment">     class：类的额全限定名称（不能是接口）</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--constructor-arg：使用类中的构造方法，在创建对象时给属性赋值--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            name：构造方法的形参名</span></span><br><span class="line"><span class="comment">            value：传入简单类型的属性</span></span><br><span class="line"><span class="comment">            ref：bean标签的id值，创建的对象的名称</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;张贺强&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1234&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;interest&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;interest&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;interest&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.Interest&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            index：构造方法的参数的位置0、1、2......</span></span><br><span class="line"><span class="comment">            value：传入简单类型的属性</span></span><br><span class="line"><span class="comment">            ref：bean标签的id值，创建的对象的名称</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">value</span>=<span class="string">&quot;游泳&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;泳池&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;interest&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.Interest&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            省略index：根据构造方法的参数的位置一次赋值</span></span><br><span class="line"><span class="comment">            value：传入简单类型的属性</span></span><br><span class="line"><span class="comment">            ref：bean标签的id值，创建的对象的名称</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">&quot;游泳&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">&quot;泳池&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h6 id="null值"><a href="#null值" class="headerlink" title="null值"></a>null值</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.entity.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userName&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">null</span>/&gt;</span> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h6 id="属性值包含特殊符号"><a href="#属性值包含特殊符号" class="headerlink" title="属性值包含特殊符号"></a>属性值包含特殊符号</h6><p>因为包含特殊符号 &lt;&gt;，需要通过 <code>&lt;![CDATA[值]]&gt;</code> 来表示</p>
<h6 id="注入属性——外部bean"><a href="#注入属性——外部bean" class="headerlink" title="注入属性——外部bean"></a>注入属性——外部bean</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserDao</span><span class="params">(UserDao userDao)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过 ref 来指定创建userDaoImpl</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--创建UserDaoImpl对象--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaoImpl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.dao.UserDaoImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--创建UserService对象--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.service.UserService&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">		property：使用set方法给属性赋值</span></span><br><span class="line"><span class="comment">			name：属性名</span></span><br><span class="line"><span class="comment">			ref：属性值（引用类型）</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDaoImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h6 id="注入属性——内部bean"><a href="#注入属性——内部bean" class="headerlink" title="注入属性——内部bean"></a>注入属性——内部bean</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--内部 bean--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;emp&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.entity.Emp&quot;</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!--设置两个普通属性--&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;ename&quot;</span> <span class="attr">value</span>=<span class="string">&quot;狗子&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;女&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!--设置对象类型属性--&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dept&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dept&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.entity.Dept&quot;</span>&gt;</span></span><br><span class="line">        	 <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dname&quot;</span> <span class="attr">value</span>=<span class="string">&quot;技术部&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h6 id="注入属性——级联赋值"><a href="#注入属性——级联赋值" class="headerlink" title="注入属性——级联赋值"></a>注入属性——级联赋值</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--级联赋值--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;emp&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.entity.Emp&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--设置两个普通属性--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;ename&quot;</span> <span class="attr">value</span>=<span class="string">&quot;狗子&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;女&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--写法一：通过ref属性来获取外部bean--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dept&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dept&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--写法二：通过emp提供dept属性的get方法--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dept.dname&quot;</span> <span class="attr">value</span>=<span class="string">&quot;技术部&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dept&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.entity.Dept&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dname&quot;</span> <span class="attr">value</span>=<span class="string">&quot;运营部&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h6 id="引用类型自动注入"><a href="#引用类型自动注入" class="headerlink" title="引用类型自动注入"></a>引用类型自动注入</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans 				    	   http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">   	 <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">		声明bean，告诉spring要创建某个类的对象，将创建好的对象放入spring中的map集合</span></span><br><span class="line"><span class="comment">    	id：对象的自定义名称</span></span><br><span class="line"><span class="comment">    	class：类的额全限定名称（不能是接口）</span></span><br><span class="line"><span class="comment">	 	autowire：引用类型的自动注入</span></span><br><span class="line"><span class="comment">			byName：引用类型的属性名和Spring容器中的bean标签的id名一样，且数据类型一致Spring能					    够自动赋值</span></span><br><span class="line"><span class="comment">			byType：引用类型的数据类型和Spring容器中bean标签的class属性是同源关系Spring能够自动</span></span><br><span class="line"><span class="comment">				同源：</span></span><br><span class="line"><span class="comment">					引用类型的数据类型和bean标签的class属性值相同</span></span><br><span class="line"><span class="comment">					引用类型的数据类型和bean标签的class属性值是父子关系</span></span><br><span class="line"><span class="comment">					引用类型的数据类型和bean标签的class属性值是接口实现类关系</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.example.User&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byName(byType)&quot;</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;zhq&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>





<h6 id="注入集合属性（数组，List，Map）"><a href="#注入集合属性（数组，List，Map）" class="headerlink" title="注入集合属性（数组，List，Map）"></a>注入集合属性（数组，List，Map）</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Stu</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String[] courses;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; list;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,String&gt; map;</span><br><span class="line">    <span class="keyword">private</span> Set&lt;String&gt; set;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCourses</span><span class="params">(String[] courses)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.courses = courses;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setList</span><span class="params">(List&lt;String&gt; list)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.list = list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMap</span><span class="params">(Map&lt;String, String&gt; map)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.map = map;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSet</span><span class="params">(Set&lt;String&gt; set)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.set = set;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;stu&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.entity.Stu&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--数组类型属性注入--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;courses&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>java课程<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>数据库课程<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--List类型属性注入--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>张三<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>李四<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--Map类型属性注入--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;JAVA&quot;</span> <span class="attr">value</span>=<span class="string">&quot;java&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;PHP&quot;</span> <span class="attr">value</span>=<span class="string">&quot;php&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--Set类型属性注入--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;set&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>Mysql<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>Redis<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>赋值引用类型</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--创建多个 course 对象--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;course1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.entity.Course&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;cname&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Spring5 框架&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;course2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.entity.Course&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;cname&quot;</span> <span class="attr">value</span>=<span class="string">&quot;MyBatis 框架&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--注入 list 集合类型，值是对象--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;courseList&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;course1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">ref</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;course2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">ref</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>把集合注入部分提取出来</p>
<p>使用 util 标签，这样不同的bean都可以使用相同的集合注入</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--将集合注入部分提取出来--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">util:list</span> <span class="attr">id</span>=<span class="string">&quot;booklist&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>易筋经<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>九阳神功<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">util:list</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;book&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.entity.Book&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;list&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;booklist&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="Bean的作用域"><a href="#Bean的作用域" class="headerlink" title="Bean的作用域"></a>Bean的作用域</h3><p><strong>在Spring中，默认情况下bean是单实例对象</strong></p>
<p><strong>Scope属性值：</strong></p>
<p>​	singleton：默认值，表示单实例对象。加载配置文件时就会创建单实例对象</p>
<p>​	prototype：表示多实例对象。在调用getBean方法时创建多实例对象</p>
<h3 id="Bean的生命周期"><a href="#Bean的生命周期" class="headerlink" title="Bean的生命周期"></a>Bean的生命周期</h3><p><strong>bean的生命周期：</strong></p>
<p>（1）通过构造器创建 bean 实例（无参数构造）</p>
<p>（2）为 bean 的属性设置值和对其他 bean 引用（调用 set 方法）</p>
<p>（3）把 bean 实例传递 bean 后置处理器的方法 postProcessBeforeInitialization</p>
<p>（4）调用 bean 的初始化的方法（需要进行配置初始化的方法）</p>
<p>（5）把 bean 实例传递 bean 后置处理器的方法 postProcessAfterInitialization</p>
<p>（6）bean 可以使用了（对象获取到了）</p>
<p>（7）当容器关闭时候，调用 bean 的销毁的方法（需要进行配置销毁的方法）</p>
<h3 id="IOC操作Bean（基于注解）"><a href="#IOC操作Bean（基于注解）" class="headerlink" title="IOC操作Bean（基于注解）"></a>IOC操作Bean（基于注解）</h3><h4 id="基于注解创建对象"><a href="#基于注解创建对象" class="headerlink" title="基于注解创建对象"></a>基于注解创建对象</h4><ul>
<li>@Component</li>
<li>@Service：一般用于Service层</li>
<li>@Controller：一般用于web层</li>
<li>@Repository：一般用于Dao层</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">  声明组件扫描器component-scan，组件就是java对象,扫描包中和子包中的所有类，找到类中的注解</span></span><br><span class="line"><span class="comment">        base-package：指定注解在项目中的包名</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.service&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        加载属性配置文件（属性配置文件中时键值对的形式）</span></span><br><span class="line"><span class="comment">        在Spring注解中可以使用$&#123;键&#125;类获取属性配置文件中的值</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:test.properties&quot;</span> <span class="attr">file-encoding</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">     按功能模块或类功能创建多个配置文件,主配置文件一般不定义对象</span></span><br><span class="line"><span class="comment">  	 主配置文件导入其他配置文件</span></span><br><span class="line"><span class="comment">     classpath：用来指定配置文件存在的类路径，可一次定义多个用;分隔，也可使用*通配符</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;classpath:beans.xml&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//value可以省略,默认是类名并且首字母小写</span></span><br><span class="line"><span class="meta">@Component(value=&quot;stuService&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StuService</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>开启组件扫描的细节配置：</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">	use-default-fileters：配置是否使用默认过滤器</span></span><br><span class="line"><span class="comment">	include-filter：设置只扫描该包下类的什么注解</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.controller&quot;</span> <span class="attr">use-default-filters</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:include-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--exclude-filter：设置不扫描类中的什么注解--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.controller&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="基于注解进行属性注入"><a href="#基于注解进行属性注入" class="headerlink" title="基于注解进行属性注入"></a>基于注解进行属性注入</h4><p> required属性默认是true，表示引用类型赋值失败程序终止，false表示引用类型赋值失败程序正							 常执行，但引用类型赋值为null</p>
<p><strong>@Autowired</strong>：根据属性类型自动装配</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(value=&quot;stuService&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StuService</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> StuDao stuDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span>&#123;</span><br><span class="line">        stuDao.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>@Qualifier</strong>：根据属性名称自动装配</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(value=&quot;stuService&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StuService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(value=&quot;stuDaoImpl&quot;)</span>  <span class="comment">//这样就能显式指定stuDaoImpl这个实现类</span></span><br><span class="line">    <span class="keyword">public</span> StuDao stuDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span>&#123;</span><br><span class="line">        stuDao.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>@Resource</strong>：可以根据类型注入，也可以根据名称注入</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(value=&quot;stuService&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StuService</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//@Resource   //根据类型进行注入</span></span><br><span class="line">    <span class="meta">@Resource(name=&quot;stuDaoImpl&quot;)</span>  <span class="comment">//根据名称进行注入</span></span><br><span class="line">    <span class="keyword">public</span> StuDao stuDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span>&#123;</span><br><span class="line">        stuDao.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>@Value</strong>：注入普通类型属性</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Value(value = &quot;abc&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String name;</span><br></pre></td></tr></table></figure>



<h4 id="完全注解开发"><a href="#完全注解开发" class="headerlink" title="完全注解开发"></a>完全注解开发</h4><p>创建配置类，替代xml配置文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>    <span class="comment">//表明为一个配置类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="AOP"><a href="#AOP" class="headerlink" title="AOP"></a>AOP</h2><h3 id="底层原理"><a href="#底层原理" class="headerlink" title="底层原理"></a>底层原理</h3><ul>
<li><strong>面向切面编程</strong>，利用 AOP 可以对业务逻辑的各个部分进行隔离，从而使得<strong>业务逻辑各部分之间的耦合度降低</strong>，提高程序的可重用性，同时提高了开发的效率。通俗来说就是<strong>在不修改代码的情况下添加新的功能</strong></li>
<li>底层通过动态代理来实现：<ul>
<li><strong>有接口的情况</strong>，JDK动态代理：<strong>创建接口实现类的代理对象</strong></li>
<li><strong>无接口的情况</strong>，CGLIB动态代理：<strong>创建当前类子类的代理对象</strong></li>
</ul>
</li>
</ul>
<p><strong>JDK动态代理举例：</strong></p>
<ul>
<li><p>通过 java.lang.reflect.<strong>Proxy类</strong> 的 <strong>newProxyInstance方法</strong> 创建代理类</p>
</li>
<li><p>newProxyInstance方法：</p>
<p>参数一：类加载器</p>
<p>参数二：所增强方法所在的类，这个类实现的接口，支持多个接口</p>
<p>参数三：实现InvocationHandle接口，重写invoke方法来添加新的功能</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//所需代理的类实现的接口，支持多个接口</span></span><br><span class="line">        Class[] interfaces = &#123;UserDao.class&#125;;</span><br><span class="line">		</span><br><span class="line">        <span class="type">UserDao</span> <span class="variable">userDao</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserDaoImpl</span>();</span><br><span class="line">        </span><br><span class="line">		<span class="comment">//调用newProxyInstance方法来创建代理类</span></span><br><span class="line">        <span class="type">UserDao</span> <span class="variable">userDaoProxy</span> <span class="operator">=</span> (UserDao) Proxy.newProxyInstance(Main.class.getClassLoader(), interfaces, <span class="keyword">new</span> <span class="title class_">UserDaoProxy</span>(userDao));</span><br><span class="line">		</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> userDaoProxy.add(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">        System.out.println(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建内部类，实现InvocationHandler接口，重写invoke方法，添加新功能</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">UserDaoProxy</span> <span class="keyword">implements</span> <span class="title class_">InvocationHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">        Object obj;</span><br><span class="line">		<span class="comment">//通过有参构造函数将所需代理的类传过来</span></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">UserDaoProxy</span><span class="params">(Object obj)</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.obj = obj;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;            </span><br><span class="line">			<span class="comment">//执行原有的代码</span></span><br><span class="line">            <span class="type">Object</span> <span class="variable">invoke</span> <span class="operator">=</span> method.invoke(obj, args);</span><br><span class="line">            </span><br><span class="line">            System.out.println(<span class="string">&quot;添加新的业务&quot;</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> invoke;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="基于AspectJ实现AOP操作"><a href="#基于AspectJ实现AOP操作" class="headerlink" title="基于AspectJ实现AOP操作"></a>基于AspectJ实现AOP操作</h3><p><strong>AOP相关术语：</strong></p>
<ul>
<li><strong>连接点</strong>：类中可以被增强的方法</li>
<li><strong>切入点</strong>：实际被增强的方法</li>
<li><strong>通知</strong>：增强的那一部分逻辑代码<ul>
<li>前置通知：增强代码在原代码前面</li>
<li>后置通知：增强代码在原代码后面</li>
<li>环绕通知：增强代码既有在原代码前面，也有在原代码后面</li>
<li>异常通知：原代码发生异常后才会执行</li>
<li>最终通知：类似与finally那一部分</li>
</ul>
</li>
<li><strong>切面</strong>：把通知应用到切入点这一个动作</li>
</ul>
<p><strong>切入点表达式</strong></p>
<ul>
<li><p><strong>execution(访问权限类型?   返回值类型   包名类名?方法名(参数类型和个数)   抛出异常类型?)</strong></p>
<p>其中?表示可选，可以定义也可以不定义</p>
<p>通配符：</p>
<p>​	*：0个以上任意字符</p>
<p>​	..：用在方法参数中，表示任意多个参数；用在包名后，表示当前包以及子包路径</p>
<p>​	+：用在类后，表示当前类以及子类；用在接口后，表示当前接口以及实现类</p>
</li>
</ul>
<h4 id="基于注解方式"><a href="#基于注解方式" class="headerlink" title="基于注解方式"></a>基于注解方式</h4><p>**@Before(value&#x3D;”切入点表达式”)**：前置通知，在目标方法执行之前先执行，定义在方法上</p>
<p>**@AfterReturning(value&#x3D;”切入点表达式”, returning &#x3D; “和通知方法的形参同名”)**：后置通知，在目标方法执行之后才执行的，定义在方法上；能够获取目标方法的返回值（可修改）  returning 表示目标方法的执行结果</p>
<p>**@Around(value&#x3D;”切入点表达式”)**：环绕通知，在目标方法执行前后都能执行；控制目标方法是否被调用；修改原来目标方法的执行结果，定义在方法上</p>
<p>**@AfterThrowing(value&#x3D;”切入点表达式”, throwing&#x3D; “和通知方法的形参同名”)**：异常通知，可在目标方法抛出异常时执行，可以做异常监控程序，定义在方法上     throwing表示目标方法抛出的异常对象</p>
<p>**@After(value&#x3D;”切入点表达式”)****：最终通知， 总是在目标方法执行之后再执行，定义在方法上</p>
<p>**@Poincut(value&#x3D;”切入点表达式”)**：定义和管理切入点表达式，定义在方法上；此时在用该切入点，直接写方法名()</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aspects<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.15<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span>   <span class="comment">//使用Aspect注解</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserProxy</span> &#123;</span><br><span class="line">    <span class="comment">//前置通知</span></span><br><span class="line">    <span class="meta">@Before(value=&quot;execution(* com.entity.User.add(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;UserProxy.before()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//后置通知</span></span><br><span class="line">    <span class="meta">@AfterReturning(value=&quot;execution(* com.entity.User.add(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterReturning</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;UserProxy.afterReturning()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//最终通知</span></span><br><span class="line">    <span class="meta">@After(value=&quot;execution(* com.entity.User.add(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">After</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;UserProxy.After()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//异常通知</span></span><br><span class="line">    <span class="meta">@AfterThrowing(value=&quot;execution(* com.entity.User.add(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">AfterThrowing</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;UserProxy.AfterThrowing()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//环绕通知</span></span><br><span class="line">    <span class="meta">@Around(value=&quot;execution(* com.entity.User.add(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">Around</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class="keyword">throws</span> Throwable&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;UserProxy.Around()   _1&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//调用proceed方法执行原先部分的代码</span></span><br><span class="line">        proceedingJoinPoint.proceed();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;UserProxy.Around()   _2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配置xml文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--开启组件扫描--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.oymn&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--开启AspectJ生成代理对象，创建代理对象是在内存中实现的，修改目标对象的内存的结构--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:aspectj-autoproxy</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="comment">&lt;!--proxy-target-class：true表示使用cglib动态代理--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;aop:aspectj-autoproxy proxy-target-class=&quot;true&quot;/&gt;--&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以将<strong>该切入点进行抽取：通过@Pointcut注解</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut(value=&quot;execution(* com.oymn.spring5.User.add(..))&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pointDemo</span><span class="params">()</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//前置通知</span></span><br><span class="line"><span class="meta">@Before(value=&quot;pointDemo()&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">()</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;UserProxy.before()&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>设置增强类优先级：</strong></p>
<p><strong>@Order（数字值）来设置增强类的优先级，数字越小优先级越高</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Order(1)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PersonProxy</span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>完全注解开发</strong> ：</p>
<p>可以通过配置类来彻底摆脱xml配置文件：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableAspectJAutoProxy(proxyTargetClass = true)</span>  <span class="comment">//开启AspectJ生成代理对象</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Config</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="基于xml方式"><a href="#基于xml方式" class="headerlink" title="基于xml方式"></a>基于xml方式</h4><p>创建Book和BookProxy类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Book</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">buy</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;buy()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookProxy</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;before()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配置xml文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--创建对象--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;book&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.oymn.spring5.Book&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookProxy&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.oymn.spring5.BookProxy&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--切入点--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;p&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* com.entity.Book.buy(..))&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置切面--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;bookProxy&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">&quot;before&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;p&quot;</span>/&gt;</span>  <span class="comment">&lt;!--将bookProxy中的before方法配置为切入点的前置通知--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>





<h2 id="事务管理"><a href="#事务管理" class="headerlink" title="事务管理"></a>事务管理</h2><ul>
<li><p>事务是数据库操作最基本单位，要么都成功，要么都失败</p>
</li>
<li><p><strong>事务四个特性ACID：原子性，一致性，隔离性，持久性</strong></p>
</li>
<li><p>Spring事务管理有两种方式：编程式事务管理 和 声明式事务管理，<strong>一般使用声明式事务管理，底层使用AOP原理</strong></p>
</li>
<li><p>声明式事务管理有两种方式：基于xml配置方式 和 基于注解方式，<strong>一般使用注解方式</strong></p>
</li>
<li><p>Spring事务管理提供了一个接口<strong>事务管理器</strong>，这个接口针对不同的框架提供不同的实现类</p>
<p>对于使用JdbcTemplate进行数据库交互，则使用DataSourceTransactionManager实现类，如果整合Hibernate框架则使用HibernateTransactionManager实现类</p>
</li>
</ul>
<h3 id="注解实现声明式事务管理"><a href="#注解实现声明式事务管理" class="headerlink" title="注解实现声明式事务管理"></a>注解实现声明式事务管理</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 数据库连接池 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">destroy-method</span>=<span class="string">&quot;close&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/book&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;4213&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--创建JdbcTemplate对象--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;jdbcTemplate&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.core.JdbcTemplate&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--注入数据库连接池--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--创建事务管理器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    开启事务注解，告诉Spring使用注解管理事务，创建代理对象</span></span><br><span class="line"><span class="comment">    annotation-driven要是tx的，表示事务</span></span><br><span class="line"><span class="comment">    transaction-manager指定事务管理器对象</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">tx:annotation-driven</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在service类上面或者service类的方法上面添加事务注解@Transactional</p>
<ul>
<li>@Transactional添加在类上面，这个类里面所有方法都添加事务</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;&#125;</span><br></pre></td></tr></table></figure>



<h4 id="参数配置"><a href="#参数配置" class="headerlink" title="参数配置"></a>参数配置</h4><p><strong>propagation</strong>：事务传播行为：</p>
<p>PROPAGATION_REQUIRED（Spring默认）：指定方法必须在事务内执行，若存在事务就加入到当前事务，若不																				存在事务则创建新事务</p>
<p>PROPAGATION_REQUIRES_NEW：指定方法支持当前事务，若没有事务也可以执行</p>
<p>PROPAGATION_SUPPORTS：执行方法新建一个事务，若存在当前事务则挂起该事务，直到新建的事务执行完毕</p>
<p>PROPAGATION_MANDATORY</p>
<p>PROPAGATION_NESTED</p>
<p>PROPAGATION_NEVER</p>
<p>PROPAGATION_NOT_SUPPORTED</p>
<p><strong>isolation</strong>：事务隔离级别：</p>
<table>
<thead>
<tr>
<th>DEFAULT默认的隔离级别，mySql默认的是REPEATABLE_READ</th>
<th>脏读</th>
<th>不可重复读</th>
<th>虚读</th>
</tr>
</thead>
<tbody><tr>
<td>READ UNCOMMITED（读未提交）</td>
<td>有</td>
<td>有</td>
<td>有</td>
</tr>
<tr>
<td>READ COMMITED（读已提交）</td>
<td>无</td>
<td>有</td>
<td>有</td>
</tr>
<tr>
<td>REPEATABLE READ（可重复读）</td>
<td>无</td>
<td>无</td>
<td>有</td>
</tr>
<tr>
<td>SERIALIZABLE（串行化）</td>
<td>无</td>
<td>无</td>
<td>无</td>
</tr>
</tbody></table>
<p><strong>timeout</strong>：超时时间</p>
<ul>
<li>事务需要在一定时间内进行提交，超过时间后回滚</li>
<li>默认值是-1，设置时间以秒为单位</li>
</ul>
<p><strong>readOnly</strong>：是否只读</p>
<ul>
<li>默认值为false，表示可以查询，也可以增删改</li>
<li>设置为true，只能查询</li>
</ul>
<p><strong>rollbackFor</strong>：回滚，设置出现哪些异常进行事务回滚</p>
<p><strong>noRollbackFor</strong>：不回滚，设置出现哪些异常不进行事务回滚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	在public上添加，默认只有ERROR和运行时异常才会回滚</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">    propagation：指定传播行为</span></span><br><span class="line"><span class="comment">    isolation：指定隔离级别</span></span><br><span class="line"><span class="comment">    readOnly：指定超时时间</span></span><br><span class="line"><span class="comment">    rollbackFor：表示指定的异常一定回滚，不是不是运行时异常（先扫描rollbackFor中的，在判断是不是运				   行时异常）</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Transactional(</span></span><br><span class="line"><span class="meta">        propagation = Propagation.REQUIRED,</span></span><br><span class="line"><span class="meta">        isolation = Isolation.DEFAULT,</span></span><br><span class="line"><span class="meta">        readOnly = false,</span></span><br><span class="line"><span class="meta">        rollbackFor = &#123;</span></span><br><span class="line"><span class="meta">                NullPointerException.class</span></span><br><span class="line"><span class="meta">        &#125;</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountService</span> &#123;&#125;</span><br></pre></td></tr></table></figure>



<p><strong>完全注解实现声明式事务管理</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>  <span class="comment">//配置类</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span>  <span class="comment">//开启事务</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Config</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建数据库连接池</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DruidDataSource <span class="title function_">getDruidDataSource</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">druidDataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        druidDataSource.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        druidDataSource.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/book&quot;</span>);</span><br><span class="line">        druidDataSource.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        druidDataSource.setPassword(<span class="string">&quot;000000&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> druidDataSource;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//创建JdbcTemplate对象</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> JdbcTemplate <span class="title function_">getJdbcTemplate</span><span class="params">(DataSource dataSource)</span>&#123;</span><br><span class="line">        <span class="type">JdbcTemplate</span> <span class="variable">jdbcTemplate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JdbcTemplate</span>();</span><br><span class="line">        jdbcTemplate.setDataSource(dataSource);</span><br><span class="line">        <span class="keyword">return</span> jdbcTemplate;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//创建事务管理器</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSourceTransactionManager <span class="title function_">getDataSourceTransactionManager</span><span class="params">(DataSource dataSource)</span>&#123;</span><br><span class="line">        <span class="type">DataSourceTransactionManager</span> <span class="variable">transactionManager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataSourceTransactionManager</span>();</span><br><span class="line">        transactionManager.setDataSource(dataSource);</span><br><span class="line">        <span class="keyword">return</span> transactionManager;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AccountDao accountDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">accountMoney</span><span class="params">()</span>&#123;</span><br><span class="line">        accountDao.add();</span><br><span class="line">        <span class="comment">//int i=1/0;   //用来模拟转账失败</span></span><br><span class="line">        accountDao.reduce();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="xml实现声明式事务管理"><a href="#xml实现声明式事务管理" class="headerlink" title="xml实现声明式事务管理"></a>xml实现声明式事务管理</h3><p>使用aspectj框架功能，在spring配置文件中声明类，方法需要的事务。这种方式业务方法和事务配置完全分离<br><strong>加入aspectj依赖</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--aspects依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aspects<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.15<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>声明事务管理器对象</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--声明事务管理器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--指定数据源，连接的数据库--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;myDataSource&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>声明方法需要的事务类型（配置方法的事务属性【隔离级别，传播行为，超时】）</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    声明业务方法（隔离级别，传播行为，超时时间）</span></span><br><span class="line"><span class="comment">    transaction-manager：指定事务管理器对象</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;myAdvice&quot;</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--tx:attributes：配置事务属性--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            tx:method：给具体方法配置事务属性（可以有多个）</span></span><br><span class="line"><span class="comment">            name：方法名称（完整的方法名，不带包名和类名；可以使用通配符*）</span></span><br><span class="line"><span class="comment">            propagation：传播行为</span></span><br><span class="line"><span class="comment">            isolation：隔离级别</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;insertStudent&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRES_NEW&quot;</span> <span class="attr">isolation</span>=<span class="string">&quot;DEFAULT&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--添加--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;add&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRES_NEW&quot;</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--修改--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;modify&quot;</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--删除--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;remove&quot;</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--查询--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;*&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;SUPPORTS&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>指定哪些类要创建代理使用事务</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        配置切入点表达式，指定哪些包中的类要使用事务</span></span><br><span class="line"><span class="comment">        id：切入点表达式名称</span></span><br><span class="line"><span class="comment">        expression：切入点表达式，指定哪些类要使用事务</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;servicePt&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* *..service..*.*(..))&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        配置增强器：关联类（切入点）和方法</span></span><br><span class="line"><span class="comment">        advice-ref：通知tx:advice中的配置</span></span><br><span class="line"><span class="comment">        pointcut-ref：切入点表达式</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;myAdvice&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;servicePt&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="Spring5新特性"><a href="#Spring5新特性" class="headerlink" title="Spring5新特性"></a>Spring5新特性</h2><h4 id="自带了日志封装"><a href="#自带了日志封装" class="headerlink" title="自带了日志封装"></a>自带了日志封装</h4><p>Spring5移除了Log4jConfigListener，官方建议使用Log4j2</p>
<p>Spring5整合Log4j2：</p>
<p>引入jar包</p>
<p><img src="/Spring5/20210807143733.png"></p>
<p>创建log4j2.xml配置文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="comment">&lt;!--日志级别以及优先级排序: OFF &gt; FATAL &gt; ERROR &gt; WARN &gt; INFO &gt; DEBUG &gt; TRACE &gt; ALL --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Configuration后面的status用于设置log4j2自身内部的信息输出，可以不设置，当设置成trace时，可以看到log4j2内部各种详细输出--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">status</span>=<span class="string">&quot;INFO&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--先定义所有的appender--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appenders</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--输出日志信息到控制台--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">console</span> <span class="attr">name</span>=<span class="string">&quot;Console&quot;</span> <span class="attr">target</span>=<span class="string">&quot;SYSTEM_OUT&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--控制日志输出的格式--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%t] %-5level %logger&#123;36&#125; - %msg%n&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">console</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appenders</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--然后定义logger，只有定义了logger并引入的appender，appender才会生效--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--root：用于指定项目的根日志，如果没有单独指定Logger，则会使用root作为默认的日志输出--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">loggers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;info&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;Console&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">loggers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="Nullable注解"><a href="#Nullable注解" class="headerlink" title="@Nullable注解"></a>@Nullable注解</h4><p>@Nullable注解可以用在方法上，属性上，参数上，表示方法返回值可以为空，属性可以为空，参数可以为空</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Nullable</span>     <span class="comment">//表示方法返回值可以为空</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getId</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Nullable</span>     <span class="comment">//表示参数可以为空</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(<span class="meta">@Nullable</span> <span class="type">int</span> Id)</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Nullable</span>     <span class="comment">//表示属性可以为空</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> id;</span><br></pre></td></tr></table></figure>

<h4 id="支持函数式风格编程"><a href="#支持函数式风格编程" class="headerlink" title="支持函数式风格编程"></a>支持函数式风格编程</h4><p>这是因为java8新增了lamda表达式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//1 创建 GenericApplicationContext 对象</span></span><br><span class="line">    <span class="type">GenericApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GenericApplicationContext</span>();</span><br><span class="line">    <span class="comment">//2 调用 context 的方法对象注册</span></span><br><span class="line">    context.refresh();</span><br><span class="line">    context.registerBean(<span class="string">&quot;user1&quot;</span>,User.class,() -&gt; <span class="keyword">new</span> <span class="title class_">User</span>());</span><br><span class="line">    <span class="comment">//3 获取在 spring 注册的对象</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User)context.getBean(<span class="string">&quot;user1&quot;</span>);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="支持整合JUnit5"><a href="#支持整合JUnit5" class="headerlink" title="支持整合JUnit5"></a>支持整合JUnit5</h4><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><p><strong>添加servlet和jsp依赖</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--加入servlet依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--添加jsp依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.1-b03<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--为了使用spring的监听器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.15<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>监听器</strong></p>
<p>使用监听器当全局作用域对象被创建时创建容器存入ServletContext，把spring配置文件中的所有对象创建好</p>
<p>监听器作用：</p>
<p>​		创建容器对象ApplicationContext ctx &#x3D; new ClassPathXmlApplicationContext(“applicationContext.xml”);</p>
<p>​		把容器对象放入到ServletContext， ServletContext.setAttribute(key,ctx)</p>
<p>  <strong>使用spring创建监听器（在web.xml文件中添加）</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--修改spring文件的位置并加载--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置spring配置文件的路径--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--注册监听器ContextCleanupListener--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span></span><br><span class="line">		org.springframework.web.context.ContextLoaderListener</span><br><span class="line">	<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p> <strong>在doPost()或doGet()方法中获取存入的容器对象</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">WebApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="comment">//使用框架中的方法获取容器对象</span></span><br><span class="line"><span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> getServletContext();</span><br><span class="line">ctx = WebApplicationContextUtils.getRequiredWebApplicationContext(servletContext);</span><br></pre></td></tr></table></figure>

<h2 id="SSM"><a href="#SSM" class="headerlink" title="SSM"></a>SSM</h2><h3 id="导入依赖"><a href="#导入依赖" class="headerlink" title="导入依赖"></a><strong>导入依赖</strong></h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.zhq<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ssm<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--servlet依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--添加jsp依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.1-b03<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--SpringMVC依赖（会将Spring用到的依赖导入）--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.15<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--spring事务--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-tx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.15<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.15<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--mybatis依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--mybatis-spring依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--mysql驱动依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.25<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--druid依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--加入jackson依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.13.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.13.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--引入lombok依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="写web-xml"><a href="#写web-xml" class="headerlink" title="写web.xml"></a><strong>写web.xml</strong></h3><ol>
<li>注册DispatcherServlet：创建SpringMVC容器对象，才能创建Controller对象；创建Servlet对象</li>
<li>注册Spring的ContextLoaderListener监听器：创建Spring容器，才能创建service、dao等对象</li>
<li>注册字符集过滤器，解决post乱码问题</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--DispatcherServlet中央调度器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:dispatcherServlet.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--ContextLoaderListener监听器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--CharacterEncodingFilter字符过滤器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceRequestEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceResponseEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>创建包，controller包、service包、dao包、domain包（不用写set和get方法，使用Lombok编译生成）</strong></p>
<h3 id="写SpringMVC、Spring、Mybatis配置文件"><a href="#写SpringMVC、Spring、Mybatis配置文件" class="headerlink" title="写SpringMVC、Spring、Mybatis配置文件"></a><strong>写SpringMVC、Spring、Mybatis配置文件</strong></h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--Spring容器--&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:contex</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--导入jdbc配置文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">contex:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:jdbc.properties&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明数据源dataSource--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span> <span class="attr">init-method</span>=<span class="string">&quot;init&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;close&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明sqlSessionFactory对象，将数据源和mybatis配置文件关联--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:mybatis.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明dao类，使用sqlSessionFactory对象创建代理类--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sqlSessionFactoryBeanName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;sqlSessionFactory&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;basePackage&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.zhq.dao&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明service注解的位置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.zhq.service&quot;</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--声明事务管理器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--SpringMVC容器--&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="attr">xmlns:mvc</span>=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/mvc https://www.springframework.org/schema/mvc/spring-mvc.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明组件扫描器（@Controller注解的位置）--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.zhq.controller&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明视图解析器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/jsp/&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.jsp&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明注解驱动--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--解决中央调度器使用/地址产生的静态资源访问问题--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明组件扫描器（@ControllerAdvice注解的位置）--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.zhq.handler&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明拦截器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">&quot;/**&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.zhq.handler.MyInterceptor&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--mybatis配置--&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--settings：控制mybatis全局行为--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--设置mybatis输出日志--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;logImpl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;STDOUT_LOGGING&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--设置别名--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--name:实体类所在的包名--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.zhq.domain&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- sql mapper(sql映射文件)的位置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">          name：是包名， 这个包中的所有mapper.xml一次都能加载</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.zhq.dao&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="写dao接口和mapper文件、service和实现类、controller、实体类、jsp页面"><a href="#写dao接口和mapper文件、service和实现类、controller、实体类、jsp页面" class="headerlink" title="写dao接口和mapper文件、service和实现类、controller、实体类、jsp页面"></a><strong>写dao接口和mapper文件、service和实现类、controller、实体类、jsp页面</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//dao接口</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">insertUser</span><span class="params">(User user)</span>;</span><br><span class="line">    User <span class="title function_">queryUser</span><span class="params">(String username)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--dao接口的mapper配置文件--&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.zhq.dao.UserDao&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">        insert into user(username, password) values(#&#123;username&#125;,#&#123;password&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryUser&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">        select username,password from user where username=#&#123;name&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//service类</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">addUser</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> userDao.insertUser(user);</span><br><span class="line">        <span class="keyword">return</span> num;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">findUser</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userDao.queryUser(name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//controller类</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional(propagation = Propagation.REQUIRES_NEW)</span></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/addUser&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ModelAndView <span class="title function_">addUser</span><span class="params">(User user)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ModelAndView</span> <span class="variable">modelAndView</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">        <span class="type">String</span> <span class="variable">tips</span> <span class="operator">=</span> <span class="string">&quot;添加失败！&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> userService.addUser(user);</span><br><span class="line">        <span class="keyword">if</span> (num&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            tips = <span class="string">&quot;用户【&quot;</span>+user.getUsername()+<span class="string">&quot;】添加成功！&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        modelAndView.addObject(<span class="string">&quot;tips&quot;</span>, tips);</span><br><span class="line">        modelAndView.setViewName(<span class="string">&quot;addSuccess&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> modelAndView;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@Transactional(propagation = Propagation.SUPPORTS, readOnly = true)</span></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/queryUser&quot;, method = RequestMethod.GET)</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">queryUser</span><span class="params">(String name)</span>&#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.findUser(name);</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//异常处理类</span></span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobaIExceptionHandler</span> &#123;</span><br><span class="line">    <span class="meta">@ExceptionHandler</span></span><br><span class="line">    <span class="keyword">public</span> ModelAndView <span class="title function_">exception</span><span class="params">(Exception e)</span>&#123;</span><br><span class="line">        <span class="type">ModelAndView</span> <span class="variable">modelAndView</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">        modelAndView.addObject(<span class="string">&quot;e&quot;</span>, e);</span><br><span class="line">        modelAndView.setViewName(<span class="string">&quot;redirect:/exception.jsp&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> modelAndView;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//拦截器</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;拦截器进行工作！&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--ajax查询页面--&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="comment">//动态获取在base标签中声明的地址</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">basePath</span> <span class="operator">=</span> request.getScheme() + <span class="string">&quot;://&quot;</span> +</span><br><span class="line">            request.getServerName() + <span class="string">&quot;:&quot;</span> + request.getServerPort() +</span><br><span class="line">            request.getContextPath() + <span class="string">&quot;/&quot;</span>;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;查询用户&lt;/title&gt;</span><br><span class="line">    &lt;base href=<span class="string">&quot;&lt;%=basePath%&gt;&quot;</span>&gt;</span><br><span class="line">    &lt;script type=<span class="string">&quot;text/javascript&quot;</span> src=<span class="string">&quot;js/jquery-3.4.1.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">        $(function () &#123;</span><br><span class="line">            $(<span class="string">&quot;#btn&quot;</span>).click(function () &#123;</span><br><span class="line">                loadUserData()</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">        function <span class="title function_">loadUserData</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="comment">//键值对不能存在空格</span></span><br><span class="line">            $.ajax(&#123;</span><br><span class="line">                url:<span class="string">&quot;user/queryUser&quot;</span>,</span><br><span class="line">                type:<span class="string">&quot;get&quot;</span>,</span><br><span class="line">                dataType:<span class="string">&quot;json&quot;</span>,</span><br><span class="line">                data:&#123;</span><br><span class="line">                    <span class="string">&quot;name&quot;</span>:$(<span class="string">&quot;#name&quot;</span>).val()</span><br><span class="line">                &#125;,</span><br><span class="line">                success:function (resp) &#123;</span><br><span class="line">                    $(<span class="string">&quot;#info&quot;</span>).html(<span class="string">&quot;&quot;</span>)</span><br><span class="line">                    $(<span class="string">&quot;#info&quot;</span>).append(<span class="string">&quot;&lt;tr&gt;&quot;</span>)</span><br><span class="line">                        .append(<span class="string">&quot;&lt;td&gt;&quot;</span> + resp.username + <span class="string">&quot;&lt;/td&gt;&quot;</span>)</span><br><span class="line">                        .append(<span class="string">&quot;&lt;td&gt;&quot;</span> + resp.password + <span class="string">&quot;&lt;/td&gt;&quot;</span>)</span><br><span class="line">                        .append(<span class="string">&quot;&lt;/tr&gt;&quot;</span>)</span><br><span class="line">                &#125;,</span><br><span class="line">                error:function (e) &#123;</span><br><span class="line">                    $(<span class="string">&quot;#info&quot;</span>).append(<span class="string">&quot;&lt;tr&gt;&quot;</span>)</span><br><span class="line">                        .append(<span class="string">&quot;&lt;td&gt;查询的用户不存在！&lt;/td&gt;&quot;</span>)</span><br><span class="line">                        .append(<span class="string">&quot;&lt;/tr&gt;&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div align=<span class="string">&quot;center&quot;</span>&gt;</span><br><span class="line">        &lt;table&gt;</span><br><span class="line">            &lt;thead&gt;</span><br><span class="line">                &lt;tr&gt;</span><br><span class="line">                    &lt;td&gt;请输入查询的姓名：&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;name&quot;</span> id=<span class="string">&quot;name&quot;</span>&gt;&lt;button id=<span class="string">&quot;btn&quot;</span>&gt;查询用户&lt;/button&gt;&lt;/td&gt;</span><br><span class="line">                &lt;/tr&gt;</span><br><span class="line">                &lt;tr&gt;</span><br><span class="line">                    &lt;td&gt;姓名&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;密码&lt;/td&gt;</span><br><span class="line">                &lt;/tr&gt;</span><br><span class="line">            &lt;/thead&gt;</span><br><span class="line">            &lt;tbody id=<span class="string">&quot;info&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">            &lt;/tbody&gt;</span><br><span class="line">        &lt;/table&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/01/30/Spring5/" data-id="cl3u71bk8000l380l1rd381m8" data-title="Spring5" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-设计模式" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/01/30/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" class="article-date">
  <time class="dt-published" datetime="2022-01-30T05:47:47.000Z" itemprop="datePublished">2022-01-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/01/30/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="设计模式"><a href="#设计模式" class="headerlink" title="设计模式"></a>设计模式</h1><h2 id="代理模式"><a href="#代理模式" class="headerlink" title="代理模式"></a>代理模式</h2><p>代理模式是指为其他对象提供的一种代理以控制这个对象的访问。代理对象可以在客户类和目标对象之间起到中介的作用</p>
<h3 id="静态代理"><a href="#静态代理" class="headerlink" title="静态代理"></a>静态代理</h3><p>代理类时自己寿佛那个实现的，自己创建的一个java类表示代理类</p>
<p>当接口中的功能增加或减少时会影响众多的实现类</p>
<p>代理类：目标类中的方法的调用，功能的增强</p>
<h3 id="动态代理"><a href="#动态代理" class="headerlink" title="动态代理"></a>动态代理</h3><p>在程序执行过程中，使用JDK反射机制创建代理类对象，并动态的指定要代理的目标类</p>
<h3 id="JDK动态代理"><a href="#JDK动态代理" class="headerlink" title="JDK动态代理"></a>JDK动态代理</h3><p>使用java反射包中的类和接口实现的动态代理的功能</p>
<h4 id="InvocationHandler接口"><a href="#InvocationHandler接口" class="headerlink" title="InvocationHandler接口"></a>InvocationHandler接口</h4><p>接口中存在方法invoke()，表示代理对象要执行的功能代码，代理类要完成的功能就写在该方法中</p>
<h4 id="Method类"><a href="#Method类" class="headerlink" title="Method类"></a>Method类</h4><p>通过Method类可以执行某个目标类中的方法，Method.invoke(目标对象， 要调用方法的参数)</p>
<h4 id="Proxy类"><a href="#Proxy类" class="headerlink" title="Proxy类"></a>Proxy类</h4><p>创建代理对象，等同于静态代理中的new</p>
<p>newProxyInstance(ClassLoader, Class[], InvocationHandler)</p>
<p>ClassLoader：目标对象的类的类加载器</p>
<p>Class[]：接口，目标对象实现的接口</p>
<p>InvocationHandler：自己完成的代理类要实现的功能</p>
<h4 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h4><p>创建接口，定义目标类要完成的功能</p>
<p>创建目标类并且实现接口</p>
<p>创建InvocationHandler接口的实现类，在invoke()方法中完成代理类的功能（调用目标方法，功能增强）</p>
<p>使用Proxy类的静态方法创建代理对象，并把返回值转换为接口类型</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//InvocationHandler实现类中的invoke()方法</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">invoke</span><span class="params">(目标对象, Method method, Object args[])</span>&#123;</span><br><span class="line">	<span class="comment">//调用目标方法</span></span><br><span class="line">    method.invoke(目标对象, args);</span><br><span class="line">    <span class="comment">//功能增强</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> 返回目标方法的执行结果;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用的代理类</span></span><br><span class="line"><span class="comment">//创建动态代理对象</span></span><br><span class="line">接口 proxy = (接口)Proxy.newProxyInstance(目标类.getClass().getClassLoader(),</span><br><span class="line">                                        目标类.getClass().getInterfaces(),</span><br><span class="line">                                        InvocationHandler);</span><br><span class="line">proxy.sell();</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="cglib动态代理"><a href="#cglib动态代理" class="headerlink" title="cglib动态代理"></a>cglib动态代理</h3><p>通过继承目标类创建它的子类，在子类中重写父类中同名的方法实现功能的修改</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/01/30/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" data-id="cl3u71bkb000p380l9jq09y0x" data-title="设计模式" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-SpringMVC" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/01/30/SpringMVC/" class="article-date">
  <time class="dt-published" datetime="2022-01-30T05:47:46.000Z" itemprop="datePublished">2022-01-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/01/30/SpringMVC/">SpringMVC</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="SpringMVC"><a href="#SpringMVC" class="headerlink" title="SpringMVC"></a>SpringMVC</h1><h2 id="SpringMVC简介"><a href="#SpringMVC简介" class="headerlink" title="SpringMVC简介"></a>SpringMVC简介</h2><h3 id="什么是MVC"><a href="#什么是MVC" class="headerlink" title="什么是MVC"></a>什么是MVC</h3><p>MVC是一种软件架构的思想，将软件按照模型、视图、控制器来划分</p>
<p>M：Model，模型层，指工程中的JavaBean，作用是处理数据</p>
<p>JavaBean分为两类：</p>
<ul>
<li>一类称为实体类Bean：专门存储业务数据的，如 Student、User 等</li>
<li>一类称为业务处理 Bean：指 Service 或 Dao 对象，专门用于处理业务逻辑和数据访问</li>
</ul>
<p>V：View，视图层，指工程中的html或jsp等页面，作用是与用户进行交互，展示数据</p>
<p>C：Controller，控制层，指工程中的servlet，作用是接收请求和响应浏览器</p>
<p>MVC的工作流程：<br>用户通过视图层发送请求到服务器，在服务器中请求被Controller接收，Controller调用相应的Model层处理请求，处理完毕将结果返回到Controller，Controller再根据请求处理的结果找到相应的View视图，渲染数据后最终响应给浏览器</p>
<h3 id="SpringMVC的特点"><a href="#SpringMVC的特点" class="headerlink" title="SpringMVC的特点"></a>SpringMVC的特点</h3><ul>
<li><strong>Spring 家族原生产品</strong>，与 IOC 容器等基础设施无缝对接</li>
<li><strong>基于原生的Servlet</strong>，通过了功能强大的<strong>前端控制器DispatcherServlet</strong>，对请求和响应进行统一处理</li>
<li>表述层各细分领域需要解决的问题<strong>全方位覆盖</strong>，提供<strong>全面解决方案</strong></li>
<li><strong>代码清新简洁</strong>，大幅度提升开发效率</li>
<li>内部组件化程度高，可插拔式组件<strong>即插即用</strong>，想要什么功能配置相应组件即可</li>
<li><strong>性能卓著</strong>，尤其适合现代大型、超大型互联网项目要求</li>
</ul>
<h2 id="HelloWorld"><a href="#HelloWorld" class="headerlink" title="HelloWorld"></a>HelloWorld</h2><h3 id="创建maven工程"><a href="#创建maven工程" class="headerlink" title="创建maven工程"></a>创建maven工程</h3><h5 id="a-gt-添加web模块"><a href="#a-gt-添加web模块" class="headerlink" title="a&gt;添加web模块"></a>a&gt;添加web模块</h5><h5 id="b-gt-打包方式：war"><a href="#b-gt-打包方式：war" class="headerlink" title="b&gt;打包方式：war"></a>b&gt;打包方式：war</h5><h5 id="c-gt-引入依赖"><a href="#c-gt-引入依赖" class="headerlink" title="c&gt;引入依赖"></a>c&gt;引入依赖</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- SpringMVC --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- ServletAPI --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Spring5和Thymeleaf整合包 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.thymeleaf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-spring5<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.12.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="配置web-xml"><a href="#配置web-xml" class="headerlink" title="配置web.xml"></a>配置web.xml</h3><p>DispatcherServlet（中央调度器）：是一个servlet，负责接收用户请求，调用其他控制器对象，并进行响应</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置SpringMVC的前端控制器，对浏览器发送的请求统一进行处理 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 通过初始化参数指定SpringMVC配置文件的位置和名称 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- contextConfigLocation为固定值 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 使用classpath:表示从类路径查找配置文件 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springMVC.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--load-on-startup：将启动控制DispatcherServlet的初始化时间提前到服务器启动时--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        设置springMVC的核心控制器所能处理的请求的请求路径</span></span><br><span class="line"><span class="comment">		使用扩展名：*.xxxx   (*.do   *.mvc等等)，表示.do结尾的请求会调用中央调度器</span></span><br><span class="line"><span class="comment">        使用斜杠&quot;/&quot;：它会代替tomcat中的default导致静态资源都给DispatcherServlet处理（需要解决静		态资源访问的问题）</span></span><br><span class="line"><span class="comment">		/不能匹配.jsp请求路径的请求，/*可以</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">	使用/解决静态资源访问的问题</span></span><br><span class="line"><span class="comment">    1. 在SpringMVC配置文件中加入&lt;mvc:default-servlet-handler/&gt;（要使用注解驱动解决冲突）</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    2. mapping：访问的静态资源的URL地址，**表示子目录或文件</span></span><br><span class="line"><span class="comment">       location：静态资源在项目中的目录位置</span></span><br><span class="line"><span class="comment">       &lt;mvc:resources mapping=&quot;/static/**&quot; location=&quot;/static/&quot;/&gt;（要使用注解驱动解决冲突）</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="创建请求控制器"><a href="#创建请求控制器" class="headerlink" title="创建请求控制器"></a>创建请求控制器</h3><p>由于前端控制器对浏览器发送的请求进行了统一的处理，但是具体的请求有不同的处理过程，因此需要创建处理具体请求的类，即请求控制器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="创建springMVC的配置文件"><a href="#创建springMVC的配置文件" class="headerlink" title="创建springMVC的配置文件"></a>创建springMVC的配置文件</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 自动扫描包 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.zhq.controller&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 配置Thymeleaf视图解析器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;viewResolver&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring5.view.ThymeleafViewResolver&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;order&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateEngine&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring5.SpringTemplateEngine&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateResolver&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring5.templateresolver.SpringResourceTemplateResolver&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">                    <span class="comment">&lt;!-- 视图前缀 --&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/templates/&quot;</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line">                    <span class="comment">&lt;!-- 视图后缀 --&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.html&quot;</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateMode&quot;</span> <span class="attr">value</span>=<span class="string">&quot;HTML5&quot;</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--或者声明转发视图解析器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--前缀：视图文件的路径（前后都要有/）--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/view/&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--后缀：视图文件的扩展名--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.jsp&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--在SpringMVC配置文件中加入&lt;mvc:default-servlet-handler/&gt;（要使用注解驱动解决冲突）</span></span><br><span class="line"><span class="comment">创建控制器对象DefaultServletHttpRequestHandler把接收的请求转发给tomcat的default处理--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--在SpringMVC配置文件中加入&lt;mvc:default-servlet-handler/&gt;（要使用注解驱动解决冲突）</span></span><br><span class="line"><span class="comment">	创建ResourceHttpRequestHandler对象，处理静态资源</span></span><br><span class="line"><span class="comment">	mapping：访问的静态资源的URL地址，**表示子目录或文件</span></span><br><span class="line"><span class="comment">	location：静态资源在项目中的目录位置</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/static/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/static/&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 开启mvc注解驱动 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--解决响应乱码问题--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:message-converters</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.http.converter.StringHttpMessageConverter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;supportedMediaTypes&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">value</span>&gt;</span>application/json;charset=UTF-8<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">value</span>&gt;</span>text/plain;charset=UTF-8<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">value</span>&gt;</span>text/html;charset=UTF-8<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">value</span>&gt;</span>text/json;charset=UTF-8<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">mvc:message-converters</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="RequestMapping注解"><a href="#RequestMapping注解" class="headerlink" title="@RequestMapping注解"></a>@RequestMapping注解</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@Controller:创建处理器对象，对象放在SpringMVC容器中，定义类的上面</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="comment">//@RequestMapping放在类上可以指定所有请求地址的公共部分</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/test&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyController</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        @RequestMapping:请求映射，把一个请求地址和一个方法绑定在一起</span></span><br><span class="line"><span class="comment">                        属性：value：指定请求得url地址（以/开头），数组类型可以使用&#123;a,b....&#125;</span></span><br><span class="line"><span class="comment">                             method：指定请求方法（不指定时所有请求方式均可） </span></span><br><span class="line"><span class="comment">                             			数组类型可以使用&#123;a,b....&#125;</span></span><br><span class="line"><span class="comment">                             			常用的方式：RequestMethod.GET和RequestMethod.POST</span></span><br><span class="line"><span class="comment">                        位置：在方法上，指定请求路径</span></span><br><span class="line"><span class="comment">                             在类上，指定所有请求路径的公共部分</span></span><br><span class="line"><span class="comment">        @RequestMapping修饰的方法可以处理请求，类似servlet中的doGet和doPost方法</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="meta">@RequestMapping(</span></span><br><span class="line"><span class="meta">        value = &#123;&quot;/testRequestMapping&quot;, &quot;/test&quot;&#125;,</span></span><br><span class="line"><span class="meta">        method = &#123;RequestMethod.GET, RequestMethod.POST&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">test</span><span class="params">()</span>&#123;&#125;</span><br></pre></td></tr></table></figure>



<p><strong>params属性</strong></p>
<p>@RequestMapping注解的params属性通过请求的请求参数匹配请求映射</p>
<p>“param”：要求请求映射所匹配的请求必须携带param请求参数</p>
<p>“!param”：要求请求映射所匹配的请求必须不能携带param请求参数</p>
<p>“param&#x3D;value”：要求请求映射所匹配的请求必须携带param请求参数且param&#x3D;value</p>
<p>“param!&#x3D;value”：要求请求映射所匹配的请求必须携带param请求参数但是param!&#x3D;value</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(</span></span><br><span class="line"><span class="meta">        value = &#123;&quot;/testRequestMapping&quot;, &quot;/test&quot;&#125;</span></span><br><span class="line"><span class="meta">        ,method = &#123;RequestMethod.GET, RequestMethod.POST&#125;</span></span><br><span class="line"><span class="meta">        ,params = &#123;&quot;username&quot;,&quot;password!=123456&quot;&#125;</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testRequestMapping</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注：</p>
<p>若当前请求满足@RequestMapping注解的value和method属性，但是不满足params属性，此时页面回报错400：Parameter conditions “username, password!&#x3D;123456” not met for actual request parameters: username&#x3D;{admin}, password&#x3D;{123456}</p>
</blockquote>
<p><strong>headers属性</strong></p>
<p>@RequestMapping注解的headers属性通过请求的请求头信息匹配请求映射</p>
<p>“header”：要求请求映射所匹配的请求必须携带header请求头信息</p>
<p>“!header”：要求请求映射所匹配的请求必须不能携带header请求头信息</p>
<p>“header&#x3D;value”：要求请求映射所匹配的请求必须携带header请求头信息且header&#x3D;value</p>
<p>“header!&#x3D;value”：要求请求映射所匹配的请求必须携带header请求头信息且header!&#x3D;value</p>
<p>若当前请求满足@RequestMapping注解的value和method属性，但是不满足headers属性，此时页面显示404错误，即资源未找到</p>
<h3 id="SpringMVC支持ant风格的路径"><a href="#SpringMVC支持ant风格的路径" class="headerlink" title="SpringMVC支持ant风格的路径"></a>SpringMVC支持ant风格的路径</h3><p>？：表示任意的单个字符</p>
<p>*：表示任意的0个或多个字符</p>
<p>**：表示任意的一层或多层目录</p>
<p>注意：在使用时，只能使用&#x2F;&#x2F;xxx的方式</p>
<h3 id="支持路径中的占位符"><a href="#支持路径中的占位符" class="headerlink" title="支持路径中的占位符"></a>支持路径中的占位符</h3><p>SpringMVC路径中的占位符常用于RESTful风格中，当请求路径中将某些数据通过路径的方式传输到服务器中，就可以在相应的@RequestMapping注解的value属性中通过占位符{xxx}表示传输的数据，在通过@PathVariable注解，将占位符所表示的数据赋值给控制器方法的形参</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;a th:href=<span class="string">&quot;@&#123;/testRest/1/admin&#125;&quot;</span>&gt;&lt;/a&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/testRest/&#123;id&#125;/&#123;username&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testRest</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> String id, </span></span><br><span class="line"><span class="params">                       <span class="meta">@PathVariable(&quot;username&quot;)</span> String username)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="方法返回值"><a href="#方法返回值" class="headerlink" title="方法返回值"></a>方法返回值</h2><h3 id="ModelAndView"><a href="#ModelAndView" class="headerlink" title="ModelAndView"></a>ModelAndView</h3><p>需要创建ModelAndView对象，Model表示数据，View表示视图，表示请求的处理结果返回数据(存储到作用域)和视图（进行转发操作）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;doSome&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ModelAndView <span class="title function_">doSome</span><span class="params">(<span class="meta">@RequestParam(&quot;rname&quot;)</span>String name)</span>&#123;</span><br><span class="line">    <span class="type">ModelAndView</span> <span class="variable">mv</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">    <span class="comment">//添加数据，框架在请求最后把数据放入到request作用域中</span></span><br><span class="line">    mv.addObject(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;springmvc开发&quot;</span>);</span><br><span class="line">    <span class="comment">//指定视图，框架对视图指定forword操作</span></span><br><span class="line">    mv.setViewName(<span class="string">&quot;/show.jsp&quot;</span>);</span><br><span class="line">    <span class="comment">//使用视图解析器后可以直接使用逻辑名称（文件名），指定视图</span></span><br><span class="line">    <span class="comment">//mv.setViewName(&quot;show&quot;);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> mv;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="String"><a href="#String" class="headerlink" title="String"></a>String</h3><p>直接返回一个字符串，表示视图，可以使用逻辑名称（需要使用视图解析器）或完整视图路径进程转发操作</p>
<p>对数据进行操作可以在形参中定义HttpServletRequest、HttpServletResponse、HttpSession对象</p>
<p>方法上增加@ResponseBody注解，表示数据，设置@RequestMapping属性produces &#x3D;”text&#x2F;plain;charset&#x3D;UTF-8”（返回text格式和UTF-8编码）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//String，表示视图</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;doSome&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">doSome</span><span class="params">(HttpServletRequest request, </span></span><br><span class="line"><span class="params">                     <span class="meta">@RequestParam(&quot;rname&quot;)</span>String name)</span>&#123;</span><br><span class="line">    <span class="comment">//返回数据</span></span><br><span class="line">    request.setAttribute(<span class="string">&quot;name&quot;</span>, name);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;show&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//String，表示数据</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;doSome&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">doSome</span><span class="params">(HttpServletRequest request, </span></span><br><span class="line"><span class="params">                     <span class="meta">@RequestParam(&quot;rname&quot;)</span>String name)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;这是数据&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="void"><a href="#void" class="headerlink" title="void"></a>void</h3><p>不能表示数据和视图，可以做AJAX操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//void返回值时</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;doAjax&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doAjax</span><span class="params">(HttpServletResponse response, String name)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line">    student.setName(name);</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (student!=<span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="comment">//调用jackson中的方法将java对象转为json格式数据</span></span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        json = objectMapper.writeValueAsString(student);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    response.setContentType(<span class="string">&quot;application/json;charset=utf-8&quot;</span>);</span><br><span class="line">    <span class="comment">//将json数据响应给ajax</span></span><br><span class="line">    <span class="type">PrintWriter</span> <span class="variable">writer</span> <span class="operator">=</span> response.getWriter();</span><br><span class="line">    writer.print(json);</span><br><span class="line">    writer.flush();</span><br><span class="line">    writer.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Object"><a href="#Object" class="headerlink" title="Object"></a>Object</h3><p>表示数据和视图无关</p>
<pre><code>                   1. 加入jackson依赖
                   2. 加入注解驱动&lt;mvc:annotation-driven/&gt;
                   3. 在方法上加入@ResponseBody注解
</code></pre>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//object返回值时</span></span><br><span class="line">&lt;!--注解驱动 完成java对象到json，xml，test...数据格式的转换（mvc那个）--&gt;</span><br><span class="line">&lt;mvc:annotation-driven/&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//@ResponseBody注解：把控制器方法返回对象转为json后，通过HttpServletResponse输出给ajax</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;doAjax&quot;)</span></span><br><span class="line"><span class="comment">//返回值时对象时，直接将对象转化为json，返回值时list集合时，将list转换为json数组</span></span><br><span class="line"><span class="keyword">public</span> Student <span class="title function_">doAjax</span><span class="params">(String name)</span>&#123;</span><br><span class="line">    <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line">    student.setName(name);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> student;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="获取请求参数"><a href="#获取请求参数" class="headerlink" title="获取请求参数"></a>获取请求参数</h2><h3 id="ServletAPI获取"><a href="#ServletAPI获取" class="headerlink" title="ServletAPI获取"></a>ServletAPI获取</h3><p>将HttpServletRequest作为控制器方法的形参</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testParam&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testParam</span><span class="params">(HttpServletRequest request)</span>&#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;username:&quot;</span>+username+<span class="string">&quot;,password:&quot;</span>+password);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="控制器方法的形参"><a href="#控制器方法的形参" class="headerlink" title="控制器方法的形参"></a>控制器方法的形参</h3><p>在控制器方法的形参位置，设置和请求参数同名的形参，当浏览器发送请求，匹配到请求映射时，在DispatcherServlet中就会将请求参数赋值给相应的形参</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testParam(username=&#x27;admin&#x27;,password=123456)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">@RequestMapping(&quot;/testParam&quot;)</span><br><span class="line">public String testParam(String username, String password)&#123;</span><br><span class="line">    System.out.println(&quot;username:&quot;+username+&quot;,password:&quot;+password);</span><br><span class="line">    return &quot;success&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注：</p>
<p>若请求所传输的请求参数中有多个同名的请求参数，此时可以在控制器方法的形参中设置字符串数组或者字符串类型的形参接收此请求参数</p>
<p>若使用字符串数组类型的形参，此参数的数组中包含了每一个数据</p>
<p>若使用字符串类型的形参，此参数的值为每个数据中间使用逗号拼接的结果</p>
</blockquote>
<h3 id="RequestParam"><a href="#RequestParam" class="headerlink" title="@RequestParam"></a>@RequestParam</h3><p>@RequestParam是将请求参数和控制器方法的形参创建映射关系</p>
<p>属性：</p>
<p>​	value：指定为形参赋值的请求参数的参数名</p>
<p>​	required：设置是否必须传输此请求参数，默认值为true</p>
<p>​	defaultValue：当value所指定的请求参数没有传输或传输的值为””时，则使用默认值为形参赋值</p>
<h3 id="RequestHeader"><a href="#RequestHeader" class="headerlink" title="@RequestHeader"></a>@RequestHeader</h3><p>@RequestHeader是将请求头信息和控制器方法的形参创建映射关系</p>
<p>属性：value、required、defaultValue用法同@RequestParam</p>
<h3 id="CookieValue"><a href="#CookieValue" class="headerlink" title="@CookieValue"></a>@CookieValue</h3><p>@CookieValue是将cookie数据和控制器方法的形参创建映射关系</p>
<p>属性：value、required、defaultValue，用法同@RequestParam</p>
<h3 id="通过POJO"><a href="#通过POJO" class="headerlink" title="通过POJO"></a>通过POJO</h3><p>可以在控制器方法的形参位置设置一个实体类类型的形参，此时若浏览器传输的请求参数的参数名和实体类中的属性名一致，对象中要存在set和get方法，那么请求参数就会为此属性赋值</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/testpojo&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    性别：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;男&quot;</span>&gt;</span>男</span><br><span class="line">    	 <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;女&quot;</span>&gt;</span>女<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    年龄：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    邮箱：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">@RequestMapping(&quot;/testpojo&quot;)</span><br><span class="line">public String testPOJO(User user)&#123;</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    return &quot;success&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="解决获取请求参数的乱码问题"><a href="#解决获取请求参数的乱码问题" class="headerlink" title="解决获取请求参数的乱码问题"></a>解决获取请求参数的乱码问题</h3><p>在web.xml中进行注册CharacterEncodingFilter</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--过滤器，进行字符编码的设定--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--设置项目中使用的字符编码--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--强制请求对象使用encoding编码的值--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceRequestEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--强制响应对象使用encoding编码的值--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceResponseEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--/*表示所有请求路径都过滤--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注：</p>
<p>SpringMVC中处理编码的过滤器一定要配置到其他过滤器之前，否则无效</p>
</blockquote>
<h2 id="域对象共享数据"><a href="#域对象共享数据" class="headerlink" title="域对象共享数据"></a>域对象共享数据</h2><h3 id="向request域对象共享数据"><a href="#向request域对象共享数据" class="headerlink" title="向request域对象共享数据"></a>向request域对象共享数据</h3><h4 id="使用ServletAPI"><a href="#使用ServletAPI" class="headerlink" title="使用ServletAPI"></a>使用ServletAPI</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testServletAPI&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testServletAPI</span><span class="params">(HttpServletRequest request)</span>&#123;</span><br><span class="line">    request.setAttribute(<span class="string">&quot;testScope&quot;</span>, <span class="string">&quot;hello,servletAPI&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="使用ModelAndView"><a href="#使用ModelAndView" class="headerlink" title="使用ModelAndView"></a>使用ModelAndView</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testModelAndView&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ModelAndView <span class="title function_">testModelAndView</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ModelAndView有Model和View的功能</span></span><br><span class="line"><span class="comment">     * Model主要用于向请求域共享数据</span></span><br><span class="line"><span class="comment">     * View主要用于设置视图，实现页面跳转</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">ModelAndView</span> <span class="variable">mav</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">    <span class="comment">//向请求域共享数据</span></span><br><span class="line">    mav.addObject(<span class="string">&quot;testScope&quot;</span>, <span class="string">&quot;hello,ModelAndView&quot;</span>);</span><br><span class="line">    <span class="comment">//设置视图，实现页面跳转</span></span><br><span class="line">    mav.setViewName(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> mav;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="使用Model"><a href="#使用Model" class="headerlink" title="使用Model"></a>使用Model</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testModel&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testModel</span><span class="params">(Model model)</span>&#123;</span><br><span class="line">    model.addAttribute(<span class="string">&quot;testScope&quot;</span>, <span class="string">&quot;hello,Model&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="使用map"><a href="#使用map" class="headerlink" title="使用map"></a>使用map</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testMap&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testMap</span><span class="params">(Map&lt;String, Object&gt; map)</span>&#123;</span><br><span class="line">    map.put(<span class="string">&quot;testScope&quot;</span>, <span class="string">&quot;hello,Map&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="使用ModelMap"><a href="#使用ModelMap" class="headerlink" title="使用ModelMap"></a>使用ModelMap</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testModelMap&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testModelMap</span><span class="params">(ModelMap modelMap)</span>&#123;</span><br><span class="line">    modelMap.addAttribute(<span class="string">&quot;testScope&quot;</span>, <span class="string">&quot;hello,ModelMap&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="Model、ModelMap、Map的关系"><a href="#Model、ModelMap、Map的关系" class="headerlink" title="Model、ModelMap、Map的关系"></a>Model、ModelMap、Map的关系</h4><p>Model、ModelMap、Map类型的参数其实本质上都是 BindingAwareModelMap 类型的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Model</span>&#123;&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ModelMap</span> <span class="keyword">extends</span> <span class="title class_">LinkedHashMap</span>&lt;String, Object&gt; &#123;&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExtendedModelMap</span> <span class="keyword">extends</span> <span class="title class_">ModelMap</span> <span class="keyword">implements</span> <span class="title class_">Model</span> &#123;&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BindingAwareModelMap</span> <span class="keyword">extends</span> <span class="title class_">ExtendedModelMap</span> &#123;&#125;</span><br></pre></td></tr></table></figure>



<h3 id="向session域共享数据"><a href="#向session域共享数据" class="headerlink" title="向session域共享数据"></a>向session域共享数据</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testSession&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testSession</span><span class="params">(HttpSession session)</span>&#123;</span><br><span class="line">    session.setAttribute(<span class="string">&quot;testSessionScope&quot;</span>, <span class="string">&quot;hello,session&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="向application域共享数据"><a href="#向application域共享数据" class="headerlink" title="向application域共享数据"></a>向application域共享数据</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testApplication&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testApplication</span><span class="params">(HttpSession session)</span>&#123;</span><br><span class="line">	<span class="type">ServletContext</span> <span class="variable">application</span> <span class="operator">=</span> session.getServletContext();</span><br><span class="line">    application.setAttribute(<span class="string">&quot;testApplicationScope&quot;</span>, <span class="string">&quot;hello,application&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="SpringMVC的视图"><a href="#SpringMVC的视图" class="headerlink" title="SpringMVC的视图"></a>SpringMVC的视图</h2><p>SpringMVC中的视图是View接口，视图的作用渲染数据，将模型Model中的数据展示给用户</p>
<p>当工程引入jstl的依赖，转发视图会自动转换为JstlView，若使用的视图技术为Thymeleaf，在SpringMVC的配置文件中配置了Thymeleaf的视图解析器，由此视图解析器解析之后所得到的是ThymeleafView</p>
<h3 id="ThymeleafView"><a href="#ThymeleafView" class="headerlink" title="ThymeleafView"></a>ThymeleafView</h3><p>当控制器方法中所设置的视图名称没有任何前缀时，此时的视图名称会被SpringMVC配置文件中所配置的视图解析器解析，视图名称拼接视图前缀和视图后缀所得到的最终路径，会通过转发的方式实现跳转</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testHello&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testHello</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="转发视图"><a href="#转发视图" class="headerlink" title="转发视图"></a>转发视图</h3><p>SpringMVC中默认的转发视图是InternalResourceView</p>
<p>当控制器方法中所设置的视图名称以”forward:”为前缀时，创建InternalResourceView视图</p>
<p>此时的视图名称不会被SpringMVC配置文件中所配置的视图解析器解析，而是会将前缀”forward:”去掉，剩余部分作为最终路径通过转发的方式实现跳转</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testForward&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testForward</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;forward:/testHello&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="重定向视图"><a href="#重定向视图" class="headerlink" title="重定向视图"></a>重定向视图</h3><p>SpringMVC中默认的重定向视图是RedirectView</p>
<p>当控制器方法中所设置的视图名称以”redirect:”为前缀时，创建RedirectView视图</p>
<p>此时的视图名称不会被SpringMVC配置文件中所配置的视图解析器解析，而是会将前缀”redirect:”去掉，剩余部分作为最终路径通过重定向的方式实现跳转</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testRedirect&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testRedirect</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/testHello&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>重定向视图在解析时，会先将redirect:前缀去掉，然后会判断剩余部分是否以&#x2F;开头，若是则会自动拼接上下文路径</p>
</blockquote>
<h3 id="视图控制器view-controller"><a href="#视图控制器view-controller" class="headerlink" title="视图控制器view-controller"></a>视图控制器view-controller</h3><p>当控制器方法中，仅仅用来实现页面跳转，即只需要设置视图名称时，可以将处理器方法使用view-controller标签进行表示</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">	path：设置处理的请求地址</span></span><br><span class="line"><span class="comment">	view-name：设置请求地址所对应的视图名称</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:view-controller</span> <span class="attr">path</span>=<span class="string">&quot;/testView&quot;</span> <span class="attr">view-name</span>=<span class="string">&quot;success&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:view-controller</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>当SpringMVC中设置任何一个view-controller时，其他控制器中的请求映射将全部失效，此时需要在SpringMVC的核心配置文件中设置开启mvc注解驱动的标签：&lt;mvc:annotation-driven &#x2F;&gt;</p>
</blockquote>
<h2 id="RESTful"><a href="#RESTful" class="headerlink" title="RESTful"></a>RESTful</h2><p>REST：表现层资源状态转移</p>
<h3 id="RESTful的实现"><a href="#RESTful的实现" class="headerlink" title="RESTful的实现"></a>RESTful的实现</h3><p>具体说，就是 HTTP 协议里面，四个表示操作方式的动词，分别对应四种基本操作：GET 用来获取资源，POST 用来新建资源，PUT 用来更新资源，DELETE 用来删除资源</p>
<table>
<thead>
<tr>
<th>操作</th>
<th>传统方式</th>
<th>REST风格</th>
</tr>
</thead>
<tbody><tr>
<td>查询操作</td>
<td>getUserById?id&#x3D;1</td>
<td>user&#x2F;1————get请求方式</td>
</tr>
<tr>
<td>保存操作</td>
<td>saveUser</td>
<td>user————post请求方式</td>
</tr>
<tr>
<td>删除操作</td>
<td>deleteUser?id&#x3D;1</td>
<td>user&#x2F;1————delete请求方式</td>
</tr>
<tr>
<td>更新操作</td>
<td>updateUser</td>
<td>user————put请求方式</td>
</tr>
</tbody></table>
<h3 id="HiddenHttpMethodFilter"><a href="#HiddenHttpMethodFilter" class="headerlink" title="HiddenHttpMethodFilter"></a>HiddenHttpMethodFilter</h3><p>由于浏览器只支持发送get和post方式的请求，SpringMVC 提供了 <strong>HiddenHttpMethodFilter</strong> 帮助我们<strong>将 POST 请求转换为 DELETE 或 PUT 请求</strong></p>
<p><strong>HiddenHttpMethodFilter</strong> 处理put和delete请求的条件：</p>
<p>​	a&gt;当前请求的请求方式必须为post</p>
<p>​	b&gt;当前请求必须传输请求参数_method（可修改该名称）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 作用：通过超链接控制表单的提交，将post请求转换为delete请求 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;delete_form&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- HiddenHttpMethodFilter要求：必须传输_method请求参数，并且值为最终的请求方式 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;_method&quot;</span> <span class="attr">value</span>=<span class="string">&quot;delete&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@DeleteMapping(&quot;/employee/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">deleteEmployee</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span>&#123;</span><br><span class="line">    employeeDao.delete(id);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;employee&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在web.xml中注册<strong>HiddenHttpMethodFilter</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>目前为止，SpringMVC中提供了两个过滤器：CharacterEncodingFilter和HiddenHttpMethodFilter</p>
<p>在web.xml中注册时，必须先注册CharacterEncodingFilter，再注册HiddenHttpMethodFilter</p>
<p>原因：request.setCharacterEncoding(encoding) 方法要求前面不能有任何获取请求参数的操作</p>
</blockquote>
<h2 id="HttpMessageConverter"><a href="#HttpMessageConverter" class="headerlink" title="HttpMessageConverter"></a>HttpMessageConverter</h2><p>HttpMessageConverter，报文信息转换器，将请求报文转换为Java对象，或将Java对象转换为响应报文</p>
<h3 id="RequestBody"><a href="#RequestBody" class="headerlink" title="@RequestBody"></a>@RequestBody</h3><p>获取post请求的请求体，使用方法的形参接收</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testRequestBody&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testRequestBody</span><span class="params">(<span class="meta">@RequestBody</span> String requestBody)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;requestBody:&quot;</span>+requestBody);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="RequestEntity"><a href="#RequestEntity" class="headerlink" title="RequestEntity"></a>RequestEntity</h3><p>封装请求报文的一种类型，需要在控制器方法的形参中设置该类型的形参</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testRequestEntity&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testRequestEntity</span><span class="params">(RequestEntity&lt;String&gt; requestEntity)</span>&#123;</span><br><span class="line">    <span class="comment">//getHeaders()获取请求头信息</span></span><br><span class="line">    System.out.println(<span class="string">&quot;requestHeader:&quot;</span>+requestEntity.getHeaders());</span><br><span class="line">    <span class="comment">//getBody()获取请求体信息</span></span><br><span class="line">    System.out.println(<span class="string">&quot;requestBody:&quot;</span>+requestEntity.getBody());</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="ResponseEntity"><a href="#ResponseEntity" class="headerlink" title="ResponseEntity"></a>ResponseEntity</h3><p>用于控制器方法的返回值类型，该控制器方法的返回值就是响应到浏览器的响应报文</p>
<h3 id="RestController"><a href="#RestController" class="headerlink" title="@RestController"></a>@RestController</h3><p>springMVC提供的一个复合注解，标识在控制器的类上，就相当于为类添加了@Controller注解，并且为其中的每个方法添加了@ResponseBody注解</p>
<h3 id="ResponseBody"><a href="#ResponseBody" class="headerlink" title="@ResponseBody"></a>@ResponseBody</h3><p>用于标识一个控制器方法，可以将该方法的返回值直接作为响应报文的响应体响应到浏览器（响应的text数据）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testResponseBody&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testResponseBody</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="SpringMVC处理json"><a href="#SpringMVC处理json" class="headerlink" title="SpringMVC处理json"></a>SpringMVC处理json</h3><p>在SpringMVC的核心配置文件中开启mvc的注解驱动，此时在HandlerAdaptor中会自动装配一个消息转换器：MappingJackson2HttpMessageConverter，可以将响应到浏览器的Java对象转换为Json格式的字符串</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testResponseUser&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> User <span class="title function_">testResponseUser</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="number">1001</span>,<span class="string">&quot;admin&quot;</span>,<span class="string">&quot;123456&quot;</span>,<span class="number">23</span>,<span class="string">&quot;男&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="SpringMVC处理ajax"><a href="#SpringMVC处理ajax" class="headerlink" title="SpringMVC处理ajax"></a>SpringMVC处理ajax</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testAjax&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testAjax</span><span class="params">(String username, String password)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;username:&quot;</span>+username+<span class="string">&quot;,password:&quot;</span>+password);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello,ajax&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="文件上传和下载"><a href="#文件上传和下载" class="headerlink" title="文件上传和下载"></a>文件上传和下载</h2><h3 id="文件下载"><a href="#文件下载" class="headerlink" title="文件下载"></a>文件下载</h3><p>使用ResponseEntity实现下载文件的功能</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testDown&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResponseEntity&lt;<span class="type">byte</span>[]&gt; testResponseEntity(HttpSession session) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="comment">//获取ServletContext对象</span></span><br><span class="line">    <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> session.getServletContext();</span><br><span class="line">    <span class="comment">//获取服务器中文件的真实路径</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">realPath</span> <span class="operator">=</span> servletContext.getRealPath(<span class="string">&quot;/static/img/1.jpg&quot;</span>);</span><br><span class="line">    <span class="comment">//创建输入流</span></span><br><span class="line">    <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(realPath);</span><br><span class="line">    <span class="comment">//创建字节数组</span></span><br><span class="line">    <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[is.available()];</span><br><span class="line">    <span class="comment">//将流读到字节数组中</span></span><br><span class="line">    is.read(bytes);</span><br><span class="line">    <span class="comment">//创建HttpHeaders对象设置响应头信息</span></span><br><span class="line">    MultiValueMap&lt;String, String&gt; headers = <span class="keyword">new</span> <span class="title class_">HttpHeaders</span>();</span><br><span class="line">    <span class="comment">//设置要下载方式以及下载文件的名字</span></span><br><span class="line">    headers.add(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachment;filename=1.jpg&quot;</span>);</span><br><span class="line">    <span class="comment">//设置响应状态码</span></span><br><span class="line">    <span class="type">HttpStatus</span> <span class="variable">statusCode</span> <span class="operator">=</span> HttpStatus.OK;</span><br><span class="line">    <span class="comment">//创建ResponseEntity对象</span></span><br><span class="line">    ResponseEntity&lt;<span class="type">byte</span>[]&gt; responseEntity = <span class="keyword">new</span> <span class="title class_">ResponseEntity</span>&lt;&gt;(bytes, headers, statusCode);</span><br><span class="line">    <span class="comment">//关闭输入流</span></span><br><span class="line">    is.close();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> responseEntity;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h3><p>文件上传要求form表单的请求方式必须为post，并且添加属性enctype&#x3D;“multipart&#x2F;form-data”</p>
<p>SpringMVC中将上传的文件封装到MultipartFile对象中，通过此对象可以获取文件相关信息</p>
<p>添加依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/commons-fileupload/commons-fileupload --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在SpringMVC的配置文件中添加配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--必须通过文件解析器的解析才能将文件转换为MultipartFile对象--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;multipartResolver&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>控制器方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testUp&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testUp</span><span class="params">(MultipartFile photo, HttpSession session)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="comment">//获取上传的文件的文件名</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> photo.getOriginalFilename();</span><br><span class="line">    <span class="comment">//处理文件重名问题</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">hzName</span> <span class="operator">=</span> fileName.substring(fileName.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">    fileName = UUID.randomUUID().toString() + hzName;</span><br><span class="line">    <span class="comment">//获取服务器中photo目录的路径</span></span><br><span class="line">    <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> session.getServletContext();</span><br><span class="line">    <span class="type">String</span> <span class="variable">photoPath</span> <span class="operator">=</span> servletContext.getRealPath(<span class="string">&quot;photo&quot;</span>);</span><br><span class="line">    <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(photoPath);</span><br><span class="line">    <span class="keyword">if</span>(!file.exists())&#123;</span><br><span class="line">        file.mkdir();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">String</span> <span class="variable">finalPath</span> <span class="operator">=</span> photoPath + File.separator + fileName;</span><br><span class="line">    <span class="comment">//实现上传功能</span></span><br><span class="line">    photo.transferTo(<span class="keyword">new</span> <span class="title class_">File</span>(finalPath));</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="拦截器"><a href="#拦截器" class="headerlink" title="拦截器"></a>拦截器</h2><h3 id="拦截器的配置"><a href="#拦截器的配置" class="headerlink" title="拦截器的配置"></a>拦截器的配置</h3><p>SpringMVC中的拦截器用于拦截控制器方法的执行，需要实现HandlerInterceptor</p>
<p>SpringMVC的拦截器必须在SpringMVC的配置文件中进行配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--声明拦截器，可以有多个--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--拦截器的执行顺序是相当于在方法上画同心圆，执行是穿过同心圆--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--拦截器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--指定拦截的请求地址URL（**表示任意字符，文件或者多级目录和目录中的文件）--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--/**表示根目录下的所有文件，表示拦截所有路径--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">&quot;/**&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--放行请求--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:exclude-mapping</span> <span class="attr">path</span>=<span class="string">&quot;/css/**&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:exclude-mapping</span> <span class="attr">path</span>=<span class="string">&quot;/js/**&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:exclude-mapping</span> <span class="attr">path</span>=<span class="string">&quot;/img/**&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--指定拦截器对象所在的类--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;handler.MyInterceptor&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="拦截器的三个抽象方法"><a href="#拦截器的三个抽象方法" class="headerlink" title="拦截器的三个抽象方法"></a>拦截器的三个抽象方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//拦截器类，需要实现HandlerInterceptor接口</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        preHandle：预处理方法，在控制器方法执行之前先执行进行拦截，可以进行身份验证</span></span><br><span class="line"><span class="comment">            handler：表示被拦截的控制器对象</span></span><br><span class="line"><span class="comment">            返回值boolean：</span></span><br><span class="line"><span class="comment">                true：拦截放行</span></span><br><span class="line"><span class="comment">                false：进行拦截</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request,</span></span><br><span class="line"><span class="params">                             HttpServletResponse response,</span></span><br><span class="line"><span class="params">                             Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">return</span> HandlerInterceptor.<span class="built_in">super</span>.preHandle(request, response, handler);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        postHandle：后处理方法，在控制器方法执行之后再执行拦截，可以修改modelAndView中数据和视图</span></span><br><span class="line"><span class="comment">            handler：表示被拦截的控制器对象</span></span><br><span class="line"><span class="comment">            modelAndView：表示控制器方法的返回值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request,</span></span><br><span class="line"><span class="params">                           HttpServletResponse response,</span></span><br><span class="line"><span class="params">                           Object handler,</span></span><br><span class="line"><span class="params">                           ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        HandlerInterceptor.<span class="built_in">super</span>.postHandle(request, response, handler, modelAndView);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        afterCompletion：在请求处理完成后再执行进行拦截，一般做资源回收工作</span></span><br><span class="line"><span class="comment">            handler：表示被拦截的控制器对象</span></span><br><span class="line"><span class="comment">            ex：程序中发生的异常</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request,</span></span><br><span class="line"><span class="params">                                HttpServletResponse response,</span></span><br><span class="line"><span class="params">                                Object handler,</span></span><br><span class="line"><span class="params">                                Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        HandlerInterceptor.<span class="built_in">super</span>.afterCompletion(request, response, handler, ex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="多个拦截器的执行顺序"><a href="#多个拦截器的执行顺序" class="headerlink" title="多个拦截器的执行顺序"></a>多个拦截器的执行顺序</h3><p><strong>若每个拦截器的preHandle()都返回true</strong></p>
<p>此时多个拦截器的执行顺序和拦截器在SpringMVC的配置文件的配置顺序有关</p>
<p>preHandle()会按照配置的顺序执行，而postHandle()和afterComplation()会按照配置的反序执行（相当于一个拦截器就是一个圆，多个拦截器就是多个同心圆）</p>
<p><strong>若某个拦截器的preHandle()返回了false</strong></p>
<p>preHandle()返回false和它之前的拦截器的preHandle()都会执行，postHandle()都不执行，返回false的拦截器之前的afterComplation()拦截器会执行</p>
<h2 id="异常处理器"><a href="#异常处理器" class="headerlink" title="异常处理器"></a>异常处理器</h2><h3 id="基于配置的异常处理"><a href="#基于配置的异常处理" class="headerlink" title="基于配置的异常处理"></a>基于配置的异常处理</h3><p>SpringMVC提供了一个处理控制器方法执行过程中所出现的异常的接口：HandlerExceptionResolver</p>
<p>HandlerExceptionResolver接口的实现类有：</p>
<p>​	DefaultHandlerExceptionResolver和SimpleMappingExceptionResolver</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.handler.SimpleMappingExceptionResolver&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;exceptionMappings&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">        	<span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        		properties的键表示处理器方法执行过程中出现的异常</span></span><br><span class="line"><span class="comment">        		properties的值表示若出现指定异常时，设置一个新的视图名称，跳转到指定页面</span></span><br><span class="line"><span class="comment">        	--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;java.lang.ArithmeticException&quot;</span>&gt;</span>error<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    	exceptionAttribute属性设置一个属性名，将出现的异常信息在请求域中进行共享</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;exceptionAttribute&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ex&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="基于注解的异常处理"><a href="#基于注解的异常处理" class="headerlink" title="基于注解的异常处理"></a>基于注解的异常处理</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@ControllerAdvice：将当前类标识为异常处理的组件</span></span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExceptionController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//@ExceptionHandler：用于设置所标识方法处理的异常</span></span><br><span class="line">    <span class="comment">//value的值可以使自定义的异常类，若不写表示处理没定义处理异常方法的异常类（其他异常类）</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(ArithmeticException.class)</span></span><br><span class="line">    <span class="comment">//ex表示当前请求处理中出现的异常对象</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">handleArithmeticException</span><span class="params">(Exception ex, Model model)</span>&#123;</span><br><span class="line">        model.addAttribute(<span class="string">&quot;ex&quot;</span>, ex);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;error&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="注解配置SpringMVC"><a href="#注解配置SpringMVC" class="headerlink" title="注解配置SpringMVC"></a>注解配置SpringMVC</h2><p>使用配置类和注解代替web.xml和SpringMVC配置文件的功能</p>
<h3 id="创建初始化类，代替web-xml"><a href="#创建初始化类，代替web-xml" class="headerlink" title="创建初始化类，代替web.xml"></a>创建初始化类，代替web.xml</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebInit</span> <span class="keyword">extends</span> <span class="title class_">AbstractAnnotationConfigDispatcherServletInitializer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 指定spring的配置类</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt;[] getRootConfigClasses() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;SpringConfig.class&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 指定SpringMVC的配置类</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt;[] getServletConfigClasses() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;WebConfig.class&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 指定DispatcherServlet的映射规则，即url-pattern</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> String[] getServletMappings() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/&quot;</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加字符过滤器</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Filter[] getServletFilters() &#123;</span><br><span class="line">        <span class="type">CharacterEncodingFilter</span> <span class="variable">encodingFilter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CharacterEncodingFilter</span>();</span><br><span class="line">        encodingFilter.setEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        encodingFilter.setForceRequestEncoding(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">HiddenHttpMethodFilter</span> <span class="variable">hiddenHttpMethodFilter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HiddenHttpMethodFilter</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Filter</span>[]&#123;encodingFilter, hiddenHttpMethodFilter&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="创建SpringConfig配置类，代替spring的配置文件"><a href="#创建SpringConfig配置类，代替spring的配置文件" class="headerlink" title="创建SpringConfig配置类，代替spring的配置文件"></a>创建SpringConfig配置类，代替spring的配置文件</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">	<span class="comment">//ssm整合之后，spring的配置信息写在此类中</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="创建WebConfig配置类，代替SpringMVC的配置文件"><a href="#创建WebConfig配置类，代替SpringMVC的配置文件" class="headerlink" title="创建WebConfig配置类，代替SpringMVC的配置文件"></a>创建WebConfig配置类，代替SpringMVC的配置文件</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">//扫描组件</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.zhq.mvc.controller&quot;)</span></span><br><span class="line"><span class="comment">//开启MVC注解驱动</span></span><br><span class="line"><span class="meta">@EnableWebMvc</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//使用默认的servlet处理静态资源</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configureDefaultServletHandling</span><span class="params">(DefaultServletHandlerConfigurer configurer)</span> &#123;</span><br><span class="line">        configurer.enable();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//配置文件上传解析器</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> CommonsMultipartResolver <span class="title function_">multipartResolver</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">CommonsMultipartResolver</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//配置拦截器</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">        <span class="type">FirstInterceptor</span> <span class="variable">firstInterceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FirstInterceptor</span>();</span><br><span class="line">        registry.addInterceptor(firstInterceptor).addPathPatterns(<span class="string">&quot;/**&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//配置视图控制</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> &#123;</span><br><span class="line">        registry.addViewController(<span class="string">&quot;/&quot;</span>).setViewName(<span class="string">&quot;index&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//配置异常映射</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configureHandlerExceptionResolvers</span><span class="params">(List&lt;HandlerExceptionResolver&gt; resolvers)</span> &#123;</span><br><span class="line">        <span class="type">SimpleMappingExceptionResolver</span> <span class="variable">exceptionResolver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleMappingExceptionResolver</span>();</span><br><span class="line">        <span class="type">Properties</span> <span class="variable">prop</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        prop.setProperty(<span class="string">&quot;java.lang.ArithmeticException&quot;</span>, <span class="string">&quot;error&quot;</span>);</span><br><span class="line">        <span class="comment">//设置异常映射</span></span><br><span class="line">        exceptionResolver.setExceptionMappings(prop);</span><br><span class="line">        <span class="comment">//设置共享异常信息的键</span></span><br><span class="line">        exceptionResolver.setExceptionAttribute(<span class="string">&quot;ex&quot;</span>);</span><br><span class="line">        resolvers.add(exceptionResolver);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//配置生成模板解析器</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ITemplateResolver <span class="title function_">templateResolver</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">WebApplicationContext</span> <span class="variable">webApplicationContext</span> <span class="operator">=</span> ContextLoader.getCurrentWebApplicationContext();</span><br><span class="line">        <span class="comment">// ServletContextTemplateResolver需要一个ServletContext作为构造参数，可通过WebApplicationContext 的方法获得</span></span><br><span class="line">        <span class="type">ServletContextTemplateResolver</span> <span class="variable">templateResolver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServletContextTemplateResolver</span>(</span><br><span class="line">            webApplicationContext.getServletContext());</span><br><span class="line">        templateResolver.setPrefix(<span class="string">&quot;/WEB-INF/templates/&quot;</span>);</span><br><span class="line">        templateResolver.setSuffix(<span class="string">&quot;.html&quot;</span>);</span><br><span class="line">        templateResolver.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        templateResolver.setTemplateMode(TemplateMode.HTML);</span><br><span class="line">        <span class="keyword">return</span> templateResolver;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//生成模板引擎并为模板引擎注入模板解析器</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> SpringTemplateEngine <span class="title function_">templateEngine</span><span class="params">(ITemplateResolver templateResolver)</span> &#123;</span><br><span class="line">        <span class="type">SpringTemplateEngine</span> <span class="variable">templateEngine</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringTemplateEngine</span>();</span><br><span class="line">        templateEngine.setTemplateResolver(templateResolver);</span><br><span class="line">        <span class="keyword">return</span> templateEngine;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//生成视图解析器并为解析器注入模板引擎</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ViewResolver <span class="title function_">viewResolver</span><span class="params">(SpringTemplateEngine templateEngine)</span> &#123;</span><br><span class="line">        <span class="type">ThymeleafViewResolver</span> <span class="variable">viewResolver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThymeleafViewResolver</span>();</span><br><span class="line">        viewResolver.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        viewResolver.setTemplateEngine(templateEngine);</span><br><span class="line">        <span class="keyword">return</span> viewResolver;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="SpringMVC执行流程"><a href="#SpringMVC执行流程" class="headerlink" title="SpringMVC执行流程"></a>SpringMVC执行流程</h2><h3 id="SpringMVC常用组件"><a href="#SpringMVC常用组件" class="headerlink" title="SpringMVC常用组件"></a>SpringMVC常用组件</h3><ul>
<li>DispatcherServlet：<strong>前端控制器</strong>，由框架提供</li>
</ul>
<p>作用：统一处理请求和响应，整个流程控制的中心，由它调用其它组件处理用户的请求</p>
<ul>
<li>HandlerMapping：<strong>处理器映射器</strong>，由框架提供</li>
</ul>
<p>作用：根据请求的url、method等信息查找Handler，即控制器方法</p>
<ul>
<li>Handler：<strong>处理器</strong>，需要工程师开发</li>
</ul>
<p>作用：在DispatcherServlet的控制下Handler对具体的用户请求进行处理</p>
<ul>
<li>HandlerAdapter：<strong>处理器适配器</strong>，由框架提供</li>
</ul>
<p>作用：通过HandlerAdapter对处理器（控制器方法）进行执行</p>
<ul>
<li>ViewResolver：<strong>视图解析器</strong>，由框架提供</li>
</ul>
<p>作用：进行视图解析，得到相应的视图，例如：ThymeleafView、InternalResourceView、RedirectView</p>
<ul>
<li>View：<strong>视图</strong>，由框架提供</li>
</ul>
<p>作用：将模型数据通过页面展示给用户</p>
<h3 id="DispatcherServlet初始化过程"><a href="#DispatcherServlet初始化过程" class="headerlink" title="DispatcherServlet初始化过程"></a>DispatcherServlet初始化过程</h3><p>DispatcherServlet 本质上是一个 Servlet，所以天然的遵循 Servlet 的生命周期。所以宏观上是 Servlet 生命周期来进行调度。</p>
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-kphToPhs-1627992919015)(img&#x2F;img005.png)]</p>
<h5 id="a-gt-初始化WebApplicationContext"><a href="#a-gt-初始化WebApplicationContext" class="headerlink" title="a&gt;初始化WebApplicationContext"></a>a&gt;初始化WebApplicationContext</h5><p>所在类：org.springframework.web.servlet.FrameworkServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> WebApplicationContext <span class="title function_">initWebApplicationContext</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">WebApplicationContext</span> <span class="variable">rootContext</span> <span class="operator">=</span></span><br><span class="line">        WebApplicationContextUtils.getWebApplicationContext(getServletContext());</span><br><span class="line">    <span class="type">WebApplicationContext</span> <span class="variable">wac</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.webApplicationContext != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// A context instance was injected at construction time -&gt; use it</span></span><br><span class="line">        wac = <span class="built_in">this</span>.webApplicationContext;</span><br><span class="line">        <span class="keyword">if</span> (wac <span class="keyword">instanceof</span> ConfigurableWebApplicationContext) &#123;</span><br><span class="line">            <span class="type">ConfigurableWebApplicationContext</span> <span class="variable">cwac</span> <span class="operator">=</span> (ConfigurableWebApplicationContext) wac;</span><br><span class="line">            <span class="keyword">if</span> (!cwac.isActive()) &#123;</span><br><span class="line">                <span class="comment">// The context has not yet been refreshed -&gt; provide services such as</span></span><br><span class="line">                <span class="comment">// setting the parent context, setting the application context id, etc</span></span><br><span class="line">                <span class="keyword">if</span> (cwac.getParent() == <span class="literal">null</span>) &#123;</span><br><span class="line">                    <span class="comment">// The context instance was injected without an explicit parent -&gt; set</span></span><br><span class="line">                    <span class="comment">// the root application context (if any; may be null) as the parent</span></span><br><span class="line">                    cwac.setParent(rootContext);</span><br><span class="line">                &#125;</span><br><span class="line">                configureAndRefreshWebApplicationContext(cwac);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (wac == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// No context instance was injected at construction time -&gt; see if one</span></span><br><span class="line">        <span class="comment">// has been registered in the servlet context. If one exists, it is assumed</span></span><br><span class="line">        <span class="comment">// that the parent context (if any) has already been set and that the</span></span><br><span class="line">        <span class="comment">// user has performed any initialization such as setting the context id</span></span><br><span class="line">        wac = findWebApplicationContext();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (wac == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// No context instance is defined for this servlet -&gt; create a local one</span></span><br><span class="line">        <span class="comment">// 创建WebApplicationContext</span></span><br><span class="line">        wac = createWebApplicationContext(rootContext);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">this</span>.refreshEventReceived) &#123;</span><br><span class="line">        <span class="comment">// Either the context is not a ConfigurableApplicationContext with refresh</span></span><br><span class="line">        <span class="comment">// support or the context injected at construction time had already been</span></span><br><span class="line">        <span class="comment">// refreshed -&gt; trigger initial onRefresh manually here.</span></span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="built_in">this</span>.onRefreshMonitor) &#123;</span><br><span class="line">            <span class="comment">// 刷新WebApplicationContext</span></span><br><span class="line">            onRefresh(wac);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.publishContext) &#123;</span><br><span class="line">        <span class="comment">// Publish the context as a servlet context attribute.</span></span><br><span class="line">        <span class="comment">// 将IOC容器在应用域共享</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">attrName</span> <span class="operator">=</span> getServletContextAttributeName();</span><br><span class="line">        getServletContext().setAttribute(attrName, wac);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wac;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="b-gt-创建WebApplicationContext"><a href="#b-gt-创建WebApplicationContext" class="headerlink" title="b&gt;创建WebApplicationContext"></a>b&gt;创建WebApplicationContext</h5><p>所在类：org.springframework.web.servlet.FrameworkServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> WebApplicationContext <span class="title function_">createWebApplicationContext</span><span class="params">(<span class="meta">@Nullable</span> ApplicationContext parent)</span> &#123;</span><br><span class="line">    Class&lt;?&gt; contextClass = getContextClass();</span><br><span class="line">    <span class="keyword">if</span> (!ConfigurableWebApplicationContext.class.isAssignableFrom(contextClass)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ApplicationContextException</span>(</span><br><span class="line">            <span class="string">&quot;Fatal initialization error in servlet with name &#x27;&quot;</span> + getServletName() +</span><br><span class="line">            <span class="string">&quot;&#x27;: custom WebApplicationContext class [&quot;</span> + contextClass.getName() +</span><br><span class="line">            <span class="string">&quot;] is not of type ConfigurableWebApplicationContext&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 通过反射创建 IOC 容器对象</span></span><br><span class="line">    <span class="type">ConfigurableWebApplicationContext</span> <span class="variable">wac</span> <span class="operator">=</span></span><br><span class="line">        (ConfigurableWebApplicationContext) BeanUtils.instantiateClass(contextClass);</span><br><span class="line"></span><br><span class="line">    wac.setEnvironment(getEnvironment());</span><br><span class="line">    <span class="comment">// 设置父容器</span></span><br><span class="line">    wac.setParent(parent);</span><br><span class="line">    <span class="type">String</span> <span class="variable">configLocation</span> <span class="operator">=</span> getContextConfigLocation();</span><br><span class="line">    <span class="keyword">if</span> (configLocation != <span class="literal">null</span>) &#123;</span><br><span class="line">        wac.setConfigLocation(configLocation);</span><br><span class="line">    &#125;</span><br><span class="line">    configureAndRefreshWebApplicationContext(wac);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wac;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="c-gt-DispatcherServlet初始化策略"><a href="#c-gt-DispatcherServlet初始化策略" class="headerlink" title="c&gt;DispatcherServlet初始化策略"></a>c&gt;DispatcherServlet初始化策略</h5><p>FrameworkServlet创建WebApplicationContext后，刷新容器，调用onRefresh(wac)，此方法在DispatcherServlet中进行了重写，调用了initStrategies(context)方法，初始化策略，即初始化DispatcherServlet的各个组件</p>
<p>所在类：org.springframework.web.servlet.DispatcherServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initStrategies</span><span class="params">(ApplicationContext context)</span> &#123;</span><br><span class="line">   initMultipartResolver(context);</span><br><span class="line">   initLocaleResolver(context);</span><br><span class="line">   initThemeResolver(context);</span><br><span class="line">   initHandlerMappings(context);</span><br><span class="line">   initHandlerAdapters(context);</span><br><span class="line">   initHandlerExceptionResolvers(context);</span><br><span class="line">   initRequestToViewNameTranslator(context);</span><br><span class="line">   initViewResolvers(context);</span><br><span class="line">   initFlashMapManager(context);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="DispatcherServlet调用组件处理请求"><a href="#DispatcherServlet调用组件处理请求" class="headerlink" title="DispatcherServlet调用组件处理请求"></a>DispatcherServlet调用组件处理请求</h3><h5 id="a-gt-processRequest"><a href="#a-gt-processRequest" class="headerlink" title="a&gt;processRequest()"></a>a&gt;processRequest()</h5><p>FrameworkServlet重写HttpServlet中的service()和doXxx()，这些方法中调用了processRequest(request, response)</p>
<p>所在类：org.springframework.web.servlet.FrameworkServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">processRequest</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">    <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">long</span> <span class="variable">startTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">    <span class="type">Throwable</span> <span class="variable">failureCause</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">LocaleContext</span> <span class="variable">previousLocaleContext</span> <span class="operator">=</span> LocaleContextHolder.getLocaleContext();</span><br><span class="line">    <span class="type">LocaleContext</span> <span class="variable">localeContext</span> <span class="operator">=</span> buildLocaleContext(request);</span><br><span class="line"></span><br><span class="line">    <span class="type">RequestAttributes</span> <span class="variable">previousAttributes</span> <span class="operator">=</span> RequestContextHolder.getRequestAttributes();</span><br><span class="line">    <span class="type">ServletRequestAttributes</span> <span class="variable">requestAttributes</span> <span class="operator">=</span> buildRequestAttributes(request, response, previousAttributes);</span><br><span class="line"></span><br><span class="line">    <span class="type">WebAsyncManager</span> <span class="variable">asyncManager</span> <span class="operator">=</span> WebAsyncUtils.getAsyncManager(request);</span><br><span class="line">    asyncManager.registerCallableInterceptor(FrameworkServlet.class.getName(), <span class="keyword">new</span> <span class="title class_">RequestBindingInterceptor</span>());</span><br><span class="line"></span><br><span class="line">    initContextHolders(request, localeContext, requestAttributes);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">		<span class="comment">// 执行服务，doService()是一个抽象方法，在DispatcherServlet中进行了重写</span></span><br><span class="line">        doService(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (ServletException | IOException ex) &#123;</span><br><span class="line">        failureCause = ex;</span><br><span class="line">        <span class="keyword">throw</span> ex;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Throwable ex) &#123;</span><br><span class="line">        failureCause = ex;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NestedServletException</span>(<span class="string">&quot;Request processing failed&quot;</span>, ex);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">finally</span> &#123;</span><br><span class="line">        resetContextHolders(request, previousLocaleContext, previousAttributes);</span><br><span class="line">        <span class="keyword">if</span> (requestAttributes != <span class="literal">null</span>) &#123;</span><br><span class="line">            requestAttributes.requestCompleted();</span><br><span class="line">        &#125;</span><br><span class="line">        logResult(request, response, failureCause, asyncManager);</span><br><span class="line">        publishRequestHandledEvent(request, response, startTime, failureCause);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="b-gt-doService"><a href="#b-gt-doService" class="headerlink" title="b&gt;doService()"></a>b&gt;doService()</h5><p>所在类：org.springframework.web.servlet.DispatcherServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doService</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    logRequest(request);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Keep a snapshot of the request attributes in case of an include,</span></span><br><span class="line">    <span class="comment">// to be able to restore the original attributes after the include.</span></span><br><span class="line">    Map&lt;String, Object&gt; attributesSnapshot = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (WebUtils.isIncludeRequest(request)) &#123;</span><br><span class="line">        attributesSnapshot = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        Enumeration&lt;?&gt; attrNames = request.getAttributeNames();</span><br><span class="line">        <span class="keyword">while</span> (attrNames.hasMoreElements()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">attrName</span> <span class="operator">=</span> (String) attrNames.nextElement();</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">this</span>.cleanupAfterInclude || attrName.startsWith(DEFAULT_STRATEGIES_PREFIX)) &#123;</span><br><span class="line">                attributesSnapshot.put(attrName, request.getAttribute(attrName));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Make framework objects available to handlers and view objects.</span></span><br><span class="line">    request.setAttribute(WEB_APPLICATION_CONTEXT_ATTRIBUTE, getWebApplicationContext());</span><br><span class="line">    request.setAttribute(LOCALE_RESOLVER_ATTRIBUTE, <span class="built_in">this</span>.localeResolver);</span><br><span class="line">    request.setAttribute(THEME_RESOLVER_ATTRIBUTE, <span class="built_in">this</span>.themeResolver);</span><br><span class="line">    request.setAttribute(THEME_SOURCE_ATTRIBUTE, getThemeSource());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.flashMapManager != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="type">FlashMap</span> <span class="variable">inputFlashMap</span> <span class="operator">=</span> <span class="built_in">this</span>.flashMapManager.retrieveAndUpdate(request, response);</span><br><span class="line">        <span class="keyword">if</span> (inputFlashMap != <span class="literal">null</span>) &#123;</span><br><span class="line">            request.setAttribute(INPUT_FLASH_MAP_ATTRIBUTE, Collections.unmodifiableMap(inputFlashMap));</span><br><span class="line">        &#125;</span><br><span class="line">        request.setAttribute(OUTPUT_FLASH_MAP_ATTRIBUTE, <span class="keyword">new</span> <span class="title class_">FlashMap</span>());</span><br><span class="line">        request.setAttribute(FLASH_MAP_MANAGER_ATTRIBUTE, <span class="built_in">this</span>.flashMapManager);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">RequestPath</span> <span class="variable">requestPath</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.parseRequestPath &amp;&amp; !ServletRequestPathUtils.hasParsedRequestPath(request)) &#123;</span><br><span class="line">        requestPath = ServletRequestPathUtils.parseAndCache(request);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 处理请求和响应</span></span><br><span class="line">        doDispatch(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!WebAsyncUtils.getAsyncManager(request).isConcurrentHandlingStarted()) &#123;</span><br><span class="line">            <span class="comment">// Restore the original attribute snapshot, in case of an include.</span></span><br><span class="line">            <span class="keyword">if</span> (attributesSnapshot != <span class="literal">null</span>) &#123;</span><br><span class="line">                restoreAttributesAfterInclude(request, attributesSnapshot);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (requestPath != <span class="literal">null</span>) &#123;</span><br><span class="line">            ServletRequestPathUtils.clearParsedRequestPath(request);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="c-gt-doDispatch"><a href="#c-gt-doDispatch" class="headerlink" title="c&gt;doDispatch()"></a>c&gt;doDispatch()</h5><p>所在类：org.springframework.web.servlet.DispatcherServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doDispatch</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">HttpServletRequest</span> <span class="variable">processedRequest</span> <span class="operator">=</span> request;</span><br><span class="line">    <span class="type">HandlerExecutionChain</span> <span class="variable">mappedHandler</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">multipartRequestParsed</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">WebAsyncManager</span> <span class="variable">asyncManager</span> <span class="operator">=</span> WebAsyncUtils.getAsyncManager(request);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">ModelAndView</span> <span class="variable">mv</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Exception</span> <span class="variable">dispatchException</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            processedRequest = checkMultipart(request);</span><br><span class="line">            multipartRequestParsed = (processedRequest != request);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Determine handler for the current request.</span></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            	mappedHandler：调用链</span></span><br><span class="line"><span class="comment">                包含handler、interceptorList、interceptorIndex</span></span><br><span class="line"><span class="comment">            	handler：浏览器发送的请求所匹配的控制器方法</span></span><br><span class="line"><span class="comment">            	interceptorList：处理控制器方法的所有拦截器集合</span></span><br><span class="line"><span class="comment">            	interceptorIndex：拦截器索引，控制拦截器afterCompletion()的执行</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            mappedHandler = getHandler(processedRequest);</span><br><span class="line">            <span class="keyword">if</span> (mappedHandler == <span class="literal">null</span>) &#123;</span><br><span class="line">                noHandlerFound(processedRequest, response);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Determine handler adapter for the current request.</span></span><br><span class="line">           	<span class="comment">// 通过控制器方法创建相应的处理器适配器，调用所对应的控制器方法</span></span><br><span class="line">            <span class="type">HandlerAdapter</span> <span class="variable">ha</span> <span class="operator">=</span> getHandlerAdapter(mappedHandler.getHandler());</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Process last-modified header, if supported by the handler.</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">method</span> <span class="operator">=</span> request.getMethod();</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">isGet</span> <span class="operator">=</span> <span class="string">&quot;GET&quot;</span>.equals(method);</span><br><span class="line">            <span class="keyword">if</span> (isGet || <span class="string">&quot;HEAD&quot;</span>.equals(method)) &#123;</span><br><span class="line">                <span class="type">long</span> <span class="variable">lastModified</span> <span class="operator">=</span> ha.getLastModified(request, mappedHandler.getHandler());</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">ServletWebRequest</span>(request, response).checkNotModified(lastModified) &amp;&amp; isGet) &#123;</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">			</span><br><span class="line">            <span class="comment">// 调用拦截器的preHandle()</span></span><br><span class="line">            <span class="keyword">if</span> (!mappedHandler.applyPreHandle(processedRequest, response)) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Actually invoke the handler.</span></span><br><span class="line">            <span class="comment">// 由处理器适配器调用具体的控制器方法，最终获得ModelAndView对象</span></span><br><span class="line">            mv = ha.handle(processedRequest, response, mappedHandler.getHandler());</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (asyncManager.isConcurrentHandlingStarted()) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            applyDefaultViewName(processedRequest, mv);</span><br><span class="line">            <span class="comment">// 调用拦截器的postHandle()</span></span><br><span class="line">            mappedHandler.applyPostHandle(processedRequest, response, mv);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">            dispatchException = ex;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Throwable err) &#123;</span><br><span class="line">            <span class="comment">// As of 4.3, we&#x27;re processing Errors thrown from handler methods as well,</span></span><br><span class="line">            <span class="comment">// making them available for @ExceptionHandler methods and other scenarios.</span></span><br><span class="line">            dispatchException = <span class="keyword">new</span> <span class="title class_">NestedServletException</span>(<span class="string">&quot;Handler dispatch failed&quot;</span>, err);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 后续处理：处理模型数据和渲染视图</span></span><br><span class="line">        processDispatchResult(processedRequest, response, mappedHandler, mv, dispatchException);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">        triggerAfterCompletion(processedRequest, response, mappedHandler, ex);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Throwable err) &#123;</span><br><span class="line">        triggerAfterCompletion(processedRequest, response, mappedHandler,</span><br><span class="line">                               <span class="keyword">new</span> <span class="title class_">NestedServletException</span>(<span class="string">&quot;Handler processing failed&quot;</span>, err));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (asyncManager.isConcurrentHandlingStarted()) &#123;</span><br><span class="line">            <span class="comment">// Instead of postHandle and afterCompletion</span></span><br><span class="line">            <span class="keyword">if</span> (mappedHandler != <span class="literal">null</span>) &#123;</span><br><span class="line">                mappedHandler.applyAfterConcurrentHandlingStarted(processedRequest, response);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// Clean up any resources used by a multipart request.</span></span><br><span class="line">            <span class="keyword">if</span> (multipartRequestParsed) &#123;</span><br><span class="line">                cleanupMultipart(processedRequest);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="d-gt-processDispatchResult"><a href="#d-gt-processDispatchResult" class="headerlink" title="d&gt;processDispatchResult()"></a>d&gt;processDispatchResult()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">processDispatchResult</span><span class="params">(HttpServletRequest request, HttpServletResponse response,</span></span><br><span class="line"><span class="params">                                   <span class="meta">@Nullable</span> HandlerExecutionChain mappedHandler, <span class="meta">@Nullable</span> ModelAndView mv,</span></span><br><span class="line"><span class="params">                                   <span class="meta">@Nullable</span> Exception exception)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">errorView</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (exception != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (exception <span class="keyword">instanceof</span> ModelAndViewDefiningException) &#123;</span><br><span class="line">            logger.debug(<span class="string">&quot;ModelAndViewDefiningException encountered&quot;</span>, exception);</span><br><span class="line">            mv = ((ModelAndViewDefiningException) exception).getModelAndView();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Object</span> <span class="variable">handler</span> <span class="operator">=</span> (mappedHandler != <span class="literal">null</span> ? mappedHandler.getHandler() : <span class="literal">null</span>);</span><br><span class="line">            mv = processHandlerException(request, response, handler, exception);</span><br><span class="line">            errorView = (mv != <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Did the handler return a view to render?</span></span><br><span class="line">    <span class="keyword">if</span> (mv != <span class="literal">null</span> &amp;&amp; !mv.wasCleared()) &#123;</span><br><span class="line">        <span class="comment">// 处理模型数据和渲染视图</span></span><br><span class="line">        render(mv, request, response);</span><br><span class="line">        <span class="keyword">if</span> (errorView) &#123;</span><br><span class="line">            WebUtils.clearErrorRequestAttributes(request);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (logger.isTraceEnabled()) &#123;</span><br><span class="line">            logger.trace(<span class="string">&quot;No view rendering, null ModelAndView returned.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (WebAsyncUtils.getAsyncManager(request).isConcurrentHandlingStarted()) &#123;</span><br><span class="line">        <span class="comment">// Concurrent handling started during a forward</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (mappedHandler != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// Exception (if any) is already handled..</span></span><br><span class="line">        <span class="comment">// 调用拦截器的afterCompletion()</span></span><br><span class="line">        mappedHandler.triggerAfterCompletion(request, response, <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="SpringMVC的执行流程"><a href="#SpringMVC的执行流程" class="headerlink" title="SpringMVC的执行流程"></a>SpringMVC的执行流程</h3><ol>
<li>用户向服务器发送请求，请求被SpringMVC 前端控制器 DispatcherServlet捕获。</li>
<li>DispatcherServlet对请求URL进行解析，得到请求资源标识符（URI），判断请求URI对应的映射：</li>
</ol>
<p>a) 不存在</p>
<p>i. 再判断是否配置了mvc:default-servlet-handler</p>
<p>ii. 如果没配置，则控制台报映射查找不到，客户端展示404错误</p>
<p><img src="/SpringMVC/8df6a30e77184eb0bc1547dae5838f65.png" alt="在这里插入图片描述"></p>
<p>iii. 如果有配置，则访问目标资源（一般为静态资源，如：JS,CSS,HTML），找不到客户端也会展示404错误</p>
<p><img src="/SpringMVC/67d25736b3b74dfe9145acedb0e8656d.png" alt="在这里插入图片描述"></p>
<p>b) 存在则执行下面的流程</p>
<ol>
<li>根据该URI，调用HandlerMapping获得该Handler配置的所有相关的对象（包括Handler对象以及Handler对象对应的拦截器），最后以HandlerExecutionChain执行链对象的形式返回。</li>
<li>DispatcherServlet 根据获得的Handler，选择一个合适的HandlerAdapter。</li>
<li>如果成功获得HandlerAdapter，此时将开始执行拦截器的preHandler(…)方法【正向】</li>
<li>提取Request中的模型数据，填充Handler入参，开始执行Handler（Controller)方法，处理请求。在填充Handler的入参过程中，根据你的配置，Spring将帮你做一些额外的工作：</li>
</ol>
<p>a) HttpMessageConveter： 将请求消息（如Json、xml等数据）转换成一个对象，将对象转换为指定的响应信息</p>
<p>b) 数据转换：对请求消息进行数据转换。如String转换成Integer、Double等</p>
<p>c) 数据格式化：对请求消息进行数据格式化。 如将字符串转换成格式化数字或格式化日期等</p>
<p>d) 数据验证： 验证数据的有效性（长度、格式等），验证结果存储到BindingResult或Error中</p>
<ol>
<li>Handler执行完成后，向DispatcherServlet 返回一个ModelAndView对象。</li>
<li>此时将开始执行拦截器的postHandle(…)方法【逆向】。</li>
<li>根据返回的ModelAndView（此时会判断是否存在异常：如果存在异常，则执行HandlerExceptionResolver进行异常处理）选择一个适合的ViewResolver进行视图解析，根据Model和View，来渲染视图。</li>
<li>渲染视图完毕执行拦截器的afterCompletion(…)方法【逆向】。</li>
<li>将渲染结果返回给客户端。</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/01/30/SpringMVC/" data-id="cl3u71bk9000m380l9z6bcn6p" data-title="SpringMVC" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-JavaWeb" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/11/16/JavaWeb/" class="article-date">
  <time class="dt-published" datetime="2021-11-16T11:03:57.000Z" itemprop="datePublished">2021-11-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/11/16/JavaWeb/">JavaWeb</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="JavaWeb"><a href="#JavaWeb" class="headerlink" title="JavaWeb"></a>JavaWeb</h1><h2 id="Tomcat服务器"><a href="#Tomcat服务器" class="headerlink" title="Tomcat服务器"></a>Tomcat服务器</h2><p><strong>tomcat是实现了Servlet和JSP规范的容器</strong></p>
<h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><p>bin：存放命令</p>
<p>conf：配置文件</p>
<p>lib：字节码库</p>
<p>logs：启动日志信息</p>
<p>temp：临时文件</p>
<p>webapps：项目存放目录</p>
<p>work：jsp相关目录，存放jsp文件翻译生成的文件</p>
<h3 id="项目目录"><a href="#项目目录" class="headerlink" title="项目目录"></a>项目目录</h3><p>webapps项目存放在该目录下，项目目录中文件结构如下</p>
<p>​	css</p>
<p>​	html</p>
<p>​	js</p>
<p>​	WEB-INF(规范，必须写) —–&gt; classes(字节码)    lib(jar包)     web.xml(配置文件)</p>
<h2 id="Servlet"><a href="#Servlet" class="headerlink" title="Servlet"></a>Servlet</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>Servlet是JavaEE规范之一，规范就是接口。</p>
<p>Servlet是运行在服务器上的Java小程序，它可以接收客户端发送过来的请求，并响应数据给客户端。</p>
<p>创建Servlet程序步骤：</p>
<ol>
<li>编写一个类实现Servlet接口</li>
<li>实现service()方法，处理请求，并响应数据</li>
<li>到web.xml中配置servlet程序的访问地址 或者 用@WebServlet(“虚拟路径”)</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 给Tomcat配置servlet程序--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 给servlet程序起一个别名--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- servlet程序的全类名--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.test.HelloServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 给servlet程序配置访问地址--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 告诉服务器，当前给HelloServlet程序配置地址--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置访问地址</span></span><br><span class="line"><span class="comment">		/代表：http://ip:端口/工程路径</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hello<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h3><ol>
<li>web容器会在容器上下文中寻找请求路径对应的Servlet对象<ol>
<li>若在请求路径中没找到对应的Servlet对象，会通过web.xml文件中的相关配置信息，得到请求路径对应的Servlet完整类名，再通过反射机制调用Servlet类的无参构造函数完成Servlet对象的实例化</li>
<li>若找到了就直接直接调用servlet对象</li>
</ol>
</li>
<li>执行init()初始化方法（init()方法在调用前已经创建好了）<strong>1,2步是在第一次访问创建Servlet程序时调用</strong></li>
<li>执行service()方法（每次访问都调用service()）</li>
<li>执行destroy()方法（在web工程停止时调用，对象没销毁之前调用destroy()方法进行对象销毁前最后的工作）</li>
</ol>
<p>注意：Servlet是单利模式，但构造方法不是私有的，多线程时存在安全问题，尽量不在Servlet中使用实例变量</p>
<h3 id="Servlet体系结构"><a href="#Servlet体系结构" class="headerlink" title="Servlet体系结构"></a>Servlet体系结构</h3><p>Servlet   ————–   接口</p>
<p>​	|    实现</p>
<p>GenericServlet    ————-   抽象类（将Servlet接口的其他方法进行了空实现，只将service()方法作为抽象方法）</p>
<p>​	|    继承</p>
<p>HttpServlet   ————–   抽象类（对http协议的一种封装，复写doGet和doPost方法就可，什么请求复写什么方法）</p>
<p>httpServlet是一个典型的模板方法设计模式</p>
<h3 id="HttpServletRequest"><a href="#HttpServletRequest" class="headerlink" title="HttpServletRequest"></a>HttpServletRequest</h3><p>每次只要有请求进入服务器，服务器都会创建一个Request对象，服务器就会把请求过来的Http协议信息解析封装到Request对象中，然后传递到service()方法中进行使用</p>
<h4 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h4><ol>
<li><p>getContextPath()          获取虚拟目录，webapp的根路径</p>
</li>
<li><p>getRequestURI() 		 	   获得请求的资源路径</p>
</li>
<li><p>getRequestURL()	            获得请求的统一资源定位符（绝对路径）</p>
</li>
<li><p>getRemoteAdder()              获得客户端的ip地址</p>
</li>
<li><p>getServletPath()              获取servlet路径</p>
</li>
<li><p>getMethod()                      获得请求的方式（GET或POST）</p>
</li>
<li><p>getHeader(“User-Agent”)     获得消息报头</p>
</li>
<li><p>getParameter()                 获得请求参数值（在POST请求中有中文时要设置字符集 </p>
</li>
<li><p>getParameterValues()     获得请求参数值（多个值时使用）</p>
</li>
<li><p>getParameterNames()     获取所有请求参数名称，返回的是Enumeration类型</p>
</li>
<li><p>getParameterMap()          获取参数名称和值得Map集合</p>
</li>
<li><p>setAttribute(key, value)   设置域数据(request域:代表一次请求的范围,一般用于多个请求转发的资源共享)</p>
</li>
<li><p>getAttribute(key)               获取域数据</p>
</li>
<li><p>removeAttribute(key)        删除键值对</p>
</li>
<li><p>getReader()                       获取字符输入流，只能操作字符数据</p>
</li>
<li><p>getInputStream()              获取字节输入流，可以操作所有类型数据</p>
</li>
<li><p>getRequestDispatcher()获取请求转发对象           forward(req, rsep)进行转发</p>
<p>语法：</p>
<p>​		HttpServletRequest对象.getRequestDispatcher(“&#x2F;工程路径”).forward(HttpServletRequest对象1, 		HttpServletRequest对象2);</p>
<p>请求转发：服务器收到请求后，服务器内部从一个资源跳转到另一个资源的操作，一般服务器存在给另一个页面共享数据时使用</p>
<p>特点：浏览器地址栏不发生改变； 只能转发到当前服务器内部的资源； 转发是一次请求（可以使用request对象共享数据）</p>
</li>
</ol>
<h3 id="HttpServletResponse类"><a href="#HttpServletResponse类" class="headerlink" title="HttpServletResponse类"></a>HttpServletResponse类</h3><p>每次只要有请求进入Tomcat服务器，Tomcat服务器都会创建一个Response对象，表示请求过来的信息（所有相应的信息）</p>
<h4 id="常用方法-1"><a href="#常用方法-1" class="headerlink" title="常用方法"></a>常用方法</h4><p>setHeader()：修改响应头信息</p>
<p>content-type：修改mime类型（mime类型就像这样的类型text&#x2F;html）</p>
<p>content-disposition：设置打开响应头的方式</p>
<p>输出流往客户端回传数据，两个流不能同时使用</p>
<p>getOutputStream()字节输出流——–常用于下载，传递二进制数据</p>
<p>getWriter()字符输出流————常用于回传字符串          </p>
<p>sendRedirect(“新地址”)：请求重定向</p>
<p>客户端给服务器发起请求，服务器给客户端一个新的地址，一般对数据库进行操作没有进行页面之间的数据共享时使用</p>
<p>特点：浏览器地址栏发生改变； 可以访问其他服务器的资源； 重定向是两次请求；可以解决页面刷新问题</p>
<h3 id="ServletContext类"><a href="#ServletContext类" class="headerlink" title="ServletContext类"></a>ServletContext类</h3><ol>
<li>ServletContext是一个接口，它代表整个web应用，可以和程序的服务器来通信</li>
<li>一个web工程，只有一个ServletContext对象实例，ServletContext对象是一个域对象</li>
<li>ServletContext是所有Servlet对象的四周环境代表，所有用户要想共享同一个数据时，可以把数据存放在ServletConfig的对象中，可以跨用户传递数据</li>
<li>获取方式：<ol>
<li>通过request对象获取：request.getServletContext()</li>
<li>通过HttpServlet获取：this.getServletContext()</li>
<li>通过ServletConfig获取：servletConfig.getServletContext()</li>
</ol>
</li>
<li>获取web.xml中配置的上下文参数context-param</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 上下文参数（属于整个web工程）--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 上下文参数名--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>namespace<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 上下文参数值--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="5">
<li><p>功能</p>
<ol>
<li><p>获取MIME类型：在互联网通信过程中定义的一种文件数据类型（大类型&#x2F;小类型）     例如：text&#x2F;html</p>
<p>String getMimeType(String file)</p>
</li>
<li><p>域对象：共享数据，整个web用户共享</p>
<p>setAttribute(key, value)   设置域数据          （域范围：整个web工程，所有用户的所有请求）</p>
<p>getAttribute(key)               获取域数据</p>
<p>removeAttribute(key)        删除键值对</p>
<p>getInitParamete(name)     获取上下文初始化参数</p>
</li>
<li><p>获取文件的真实（服务器）路径：</p>
<p>String getRealPath(String path)   path例如&#x2F;dao&#x2F;b.txt，其中&#x2F;表示webapp的根目录</p>
</li>
</ol>
</li>
</ol>
<h3 id="ServletConfig类"><a href="#ServletConfig类" class="headerlink" title="ServletConfig类"></a>ServletConfig类</h3><ol>
<li><p>ServletConfig是Servlet对象的配置信息类，Servlet配置信息在web.xml文件中，一个Servlet对象对应一个ServletConfig对象，Servlet程序创建时就创建对应的ServletConfig对象</p>
</li>
<li><p>常用方法</p>
<p>servletConfig.getServletName()：可以获取servlet程序的别名servlet-name的值</p>
<p>servletConfig.getInitParamete(name)：获取初始化参数init-param的值</p>
<p>servletConfig.getServletContext()：获取Servlet上下文对象</p>
</li>
<li><p>将init方法的ServletConfig参数在service方法中使用时，创建一个私有实例变量ServletConfig，在init的方法中将局部变量赋值给实例变量，将getServletConfig方法中返回实例变量ServletConfig供子类使用</p>
</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!-- 创建在servlet标签中--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 初始化参数--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- 初始化参数名--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>namespace<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- 初始化参数值--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="Http协议"><a href="#Http协议" class="headerlink" title="Http协议"></a>Http协议</h3><ol>
<li><p>Http协议就是指客户端和服务器之间通信时发送的数据，需要遵守的规则</p>
</li>
<li><p>Http协议中的数据又叫报文</p>
</li>
<li><p>客户端给服务器发送数据叫请求，服务器给客户端回传数据叫响应</p>
</li>
<li><p>请求分为GET请求和POST请求           </p>
<p>get请求会被浏览器缓存，要想不缓存可以再请求路径中加时间，改变每次请求的请求路径</p>
<p><strong>GET请求</strong>  不太安全 请求体在URL地址栏</p>
<ol>
<li><p>请求行（包含了POST请求请求体中的参数）</p>
<p>请求的方式， 请求的资源路径， 请求的协议版本号</p>
</li>
<li><p>消息报头</p>
<p>key:value 组成（不同的键值对，表示不同的含义）</p>
<p>Accept：告诉服务器客户端可以接收的数据类型</p>
<p>Accept-Language：告诉服务器客户端可以接收的语言</p>
<p>User-Agent：浏览器的信息</p>
<p>Accept-Encoding：告诉服务器客户端可以接收的数据编码格式</p>
<p>Host：表示请求的服务器ip和端口号</p>
<p>Connection：告诉服务器请求的链接如何处理（Keep-Alive 回传数据不要马上关闭连接一段时间， Closed 马上关闭）</p>
</li>
</ol>
<p><strong>POST请求</strong>  相对安全  只有表单form标签中设置为post请求时才是post请求</p>
<ol>
<li><p>请求行</p>
<p>请求的方式， 请求的资源路径， 请求的协议版本号</p>
</li>
<li><p>消息报头</p>
<p>key:value 组成（不同的键值对，表示不同的含义）</p>
<p>Accept：告诉服务器客户端可以接收的数据类型</p>
<p>Accept-Language：告诉服务器客户端可以接收的语言</p>
<p>Referer：发起请求时，浏览器地址栏中的地址</p>
<p>User-Agent：浏览器的信息</p>
<p>Content-Type：发送的数据的类型</p>
<p>Accept-Encoding：告诉服务器客户端可以接收的数据编码格式</p>
<p>Host：表示请求的服务器ip和端口号</p>
<p>Connect-Length：发送的数据的长度</p>
<p>Connection：告诉服务器请求的链接如何处理（Keep-Alive 回传数据不要马上关闭连接一段时间， Closed 马上关闭）</p>
<p>Cache-Control：控制缓存</p>
</li>
<li><p>空白行</p>
</li>
<li><p>请求体（发送给服务器的数据参数）</p>
</li>
</ol>
<p>响应</p>
<ol>
<li>状态行（协议版本号 状态码 状态描述信息）</li>
<li>响应报头</li>
<li>空白行</li>
<li>响应体</li>
</ol>
<p>响应码：</p>
<ol>
<li>1xx：服务器接收客户端消息，但没有接收完成</li>
<li>2xx：成功</li>
<li>3xx：重定向</li>
<li>4xx：客户端错误</li>
<li>5xx：服务器错误</li>
</ol>
</li>
</ol>
<h3 id="中文乱码问题"><a href="#中文乱码问题" class="headerlink" title="中文乱码问题"></a>中文乱码问题</h3><h4 id="浏览器乱码"><a href="#浏览器乱码" class="headerlink" title="浏览器乱码"></a>浏览器乱码</h4><ol>
<li>html中：&lt;meta content&#x3D;”text&#x2F;html;charset&#x3D;UTF-8””&gt;</li>
<li>经过Servlet之后：response.setContentType(“text&#x2F;html;charset&#x3D;UTF-8”);</li>
</ol>
<h4 id="服务器乱码"><a href="#服务器乱码" class="headerlink" title="服务器乱码"></a>服务器乱码</h4><p>resquest.setCharacterEncoding(“UTF-8”)：只适合POST请求，只对请求体进行编码</p>
<h3 id="路径问题"><a href="#路径问题" class="headerlink" title="路径问题"></a>路径问题</h3><p>给服务器使用的路径不需要加虚拟目录（项目的访问路径）</p>
<p>给浏览器使用的需要加虚拟目录【请求从哪来路径就是给谁使用】</p>
<p>base标签：设置页面相对路径工作时参照的地址</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">常用的路径：</span><br><span class="line">1. <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/项目名/资源路径&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">2. <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/项目名/资源路径&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">3. cookie.setPath(&quot;/项目名/资源路径&quot;)</span><br><span class="line">4. 重定向：response.getRequestDispatcher(&quot;/资源路径&quot;).forward(request, reponse)</span><br><span class="line">5. 欢迎页面：资源路径</span><br><span class="line">6. servlet路径：/自定义资源路径</span><br></pre></td></tr></table></figure>



<h3 id="欢迎页面"><a href="#欢迎页面" class="headerlink" title="欢迎页面"></a>欢迎页面</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>页面名称<span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注意：</p>
<ol>
<li><p>欢迎页面可以设置多个，按照编写顺序从上到下访问，如果上边的页面资源不存在时，才会访问下边的资源</p>
</li>
<li><p>页面名称：以webapp根目录的文件开始，但不用以&#x2F;开始</p>
</li>
<li><p>欢迎页面有全局配置和局部配置</p>
<p>​	全局配置：conf&#x2F;web.xml</p>
<p>​	局部配置：webapp&#x2F;WEB-INF&#x2F;web.xml</p>
</li>
</ol>
<h3 id="会话"><a href="#会话" class="headerlink" title="会话"></a>会话</h3><ol>
<li><p>会话：一次会话中包含多次请求和多次响应（浏览器第一次给服务器发送请求会话建立，直到一方断开为止）</p>
<p>本质上是session对象销毁时会话才会结束，session销毁之前可以通过复写URL的JSESSIONID的方式可以访问之前的会话，但要直到session对应的cookie中的JSESSIONID的值</p>
</li>
<li><p>功能：在一次会话的范围内的多次请求间共享数据，对个request之间共享数据</p>
</li>
</ol>
<h4 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h4><p>cookie是http协议的，只是Tomcat中将cookie封装成了类</p>
<ol>
<li><p>功能：将数据保存在客户端</p>
</li>
<li><p>使用步骤：</p>
<ol>
<li>创建Cookie对象，绑定数据   	new Cookie(String name, String value)</li>
</ol>
</li>
<li><p>发送Cookie对象，服务器将Cookie数据放到响应头中，响应给浏览器（例如：set-cookie:name&#x3D;value）         response.addCookie(Cookie cookie)</p>
<ol start="3">
<li>获取Cookie对象，浏览器将Cookie数据放到请求头中，发送给服务器（例如：cookie:name&#x3D;value）拿到数据          Cookie[]   requst.getCookies()</li>
</ol>
<p>就相当于输入输出流，获取文件（输入流&#x2F;获取cookie对象），修改文件（修改cookie对象的name或value），响应文件（输出流&#x2F;添加cookie对象）</p>
</li>
<li><p>一次可以发送多个cookie，创建多个cookie对象</p>
</li>
<li><p>默认情况下，Cookie存储在浏览器缓存中，当浏览器关闭后，Cookie数据被销毁</p>
<p>持久化储存： setMaxAge(int seconds)    </p>
<p>​	seconds为整数时表示将Cookie数据写入到磁盘文件中seconds秒的时间</p>
<p>​	seconds为负数时表示默认值，关闭浏览器，Cookie数据销毁</p>
<p>​	seconds为0时表示删除Cookie数据信息</p>
</li>
<li><p>默认情况下Cookie数据不能在Tomcat中的web项目共享</p>
<ol>
<li><p>setPath(String path)设置cookie数据的获取范围，cookie数据绑定路径，默认为当前的虚拟目录，“&#x2F;”表示cookie可以共享到整个Tomcat服务器中</p>
</li>
<li><p>setDomain(String path)设置一级域名相同，多个服务器之间cookie共享</p>
<p>比如：setDomain(“.baidu.com”)，tieba.baidu.com和news.baidu.com之间的cookie数据共享</p>
</li>
</ol>
</li>
<li><p>作用：cookie数据存储在客户端浏览器，并且对于单个cookie的大小有限制(4kb)对于同一域名下的总cookie数量也有限制(20个)</p>
<p>cookie一般用于存储少量的不太敏感的数据，在不登录的情况下，完成服务器对客户端的身份识别</p>
</li>
</ol>
<h4 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h4><ol>
<li><p>服务器端会话技术，在一次会话的多次请求间共享数据，将数据保存在服务器端HttpSession对象中。</p>
</li>
<li><p>使用步骤：</p>
<ol>
<li><p>获取HttpSession对象，没有则创建新的session对象   HttpSession session &#x3D; request.getSession();    </p>
<p> 获取session对象，没有获取到则返回空    request.getSession(false);</p>
</li>
<li><p>常用方法</p>
<p>Object getAttribute(String name)      设置域数据        <strong>整个会话共享</strong></p>
<p>void setAttribute(String name, Object value)      获取域数据</p>
<p>void removeAttribute(String name)       删除域数据</p>
<p>void invalidate()    销毁session对象</p>
</li>
</ol>
</li>
<li><p>客户端和浏览器都不关闭时（会话不结束时），每次请求获取的session对象是同一个session对象</p>
</li>
<li><p>原理：</p>
<p>Session的实现依赖于Cookie，浏览器首次请求时会话建立，创建一个HttpSession对象，同时生成session对象对应的cookie对象，cookie对象的key是JSESSIONID，value是32位的字符串，将cookie对象的value字符串值和session对象绑定到session的map列表中，每次请求浏览器向服务器发送cookie，服务器查找session列表找到cookie对象中key值对应的session对象，响应给session</p>
</li>
<li><p>服务器中的session对象销毁是遵循超时销毁规则的，默认是会话结束30分钟内没有会话建立时，session销毁，可以在web.xml文件中设置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">session-config</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">session-timeout</span>&gt;</span>时间<span class="tag">&lt;/<span class="name">session-timeout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">session-config</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>默认情况下，客户端关闭，服务器不关闭，两次获取的session不是同一个</p>
<p>可以创建Cookie，键为<strong>JSESSIONID</strong>，设置存活时间，让cookie持久化保存</p>
<p>Cookie c &#x3D; new Cookie(“JSESSIONID”, session.getId());</p>
<p>c.setMaxAge(seconds);</p>
<p>reponse.addCookie(c);</p>
</li>
<li><p>客户端不关闭，服务器关闭，两次获取的session不是同一个</p>
<p>虽然不是同一个但是要确保数据不会丢失</p>
<p>​	session的钝化：在服务器正常关闭前，将session对象序列化到硬盘上</p>
<p>​	session的活化：在服务器启动后，将session文件转换为内存中的session对象</p>
</li>
<li><p>特点：</p>
<ol>
<li>session用于存储一次会话的多次请求的数据，存储在服务器</li>
<li>session可以存储任意类型，任意大小的数据</li>
</ol>
</li>
</ol>
<h2 id="Filter过滤器"><a href="#Filter过滤器" class="headerlink" title="Filter过滤器"></a>Filter过滤器</h2><p>作用：当访问服务器的资源时，过滤器可以将请求和响应拦截下来，完成一些特殊功能；比如登录验证，统一编码处理，敏感字符过滤</p>
<h3 id="FilterConfig"><a href="#FilterConfig" class="headerlink" title="FilterConfig"></a>FilterConfig</h3><p>Filter的配置信息类，相当于ServletConfig</p>
<p>常用方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">filterConfig.getFilterName()：获取Filter的Name</span><br><span class="line">filterConfig.getInitParameterNames()：获取所有的初始化参数名称</span><br><span class="line">filterConfig.getInitParameter(name)：获取name对应的value值</span><br><span class="line">filterConfig.getServletContext()：获取全局域对象</span><br></pre></td></tr></table></figure>

<h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><ol>
<li><p>定义一个类，实现接口Filter</p>
</li>
<li><p>复写方法doFilte()方法拦截：在方法中调用filterChain.doFilter()将拦截的资源放行</p>
</li>
<li><p>配置拦截路径</p>
<ol>
<li>web.xml</li>
<li>注解：注解中写的是要拦截的路径  @WebFilter()</li>
</ol>
</li>
</ol>
<h3 id="执行流程"><a href="#执行流程" class="headerlink" title="执行流程"></a>执行流程</h3><ol>
<li>执行过滤器</li>
<li>执行放行后的资源</li>
<li>回来执行过滤器放行后的代码</li>
</ol>
<h3 id="生命周期-1"><a href="#生命周期-1" class="headerlink" title="生命周期"></a>生命周期</h3><ol>
<li>服务器启动创建Filter对象</li>
<li>init：执行init方法，只执行一次</li>
<li>doFilter：每次请求被拦截资源时被执行</li>
<li>destroy：在服务器关闭时，Filter对象被销毁，正常关闭服务器会执行destroy方法</li>
</ol>
<h3 id="拦截路径"><a href="#拦截路径" class="headerlink" title="拦截路径"></a>拦截路径</h3><p>注解的value属性或web.xml中&lt; usl-pattern&gt;拦截路径&lt; &#x2F;usl-pattern&gt;</p>
<ol>
<li>具体资源路径：&#x2F;index.jsp</li>
<li>拦截目录：&#x2F;user&#x2F;*</li>
<li>后缀名拦截：*.jsp</li>
<li>拦截所有的资源：&#x2F;*</li>
</ol>
<h3 id="拦截方式"><a href="#拦截方式" class="headerlink" title="拦截方式"></a>拦截方式</h3><p>资源被访问的方式</p>
<ol>
<li><p>注解：@WebFilter()</p>
<p>设置dispatcherTypes属性</p>
<ol>
<li>REQUEST：默认值，浏览器直接访问资源</li>
<li>FORWARD：转发访问资源</li>
<li>INCLUDE：包含访问资源</li>
<li>ERROR：错误跳转资源</li>
<li>ASYNC：异步访问资源</li>
</ol>
</li>
<li><p>web.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>name<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>全限定类名<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>name<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">usl-pattern</span>&gt;</span>拦截路径<span class="tag">&lt;/<span class="name">usl-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dispatcher</span>&gt;</span>拦截方式<span class="tag">&lt;/<span class="name">dispatcher</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="过滤器链"><a href="#过滤器链" class="headerlink" title="过滤器链"></a>过滤器链</h3><p>配置多个过滤器</p>
<p>执行顺序：过滤器1， 过滤器2， 资源， 过滤器2， 过滤器1</p>
<p>过滤器先后顺序配置：</p>
<p>​	注解配置：按照类名的字符串比较规则比较，值小的先执行</p>
<p>​	web.xml配置：谁定义在上边，谁先执行</p>
<h2 id="Listener监听器"><a href="#Listener监听器" class="headerlink" title="Listener监听器"></a>Listener监听器</h2><p>事件监听机制</p>
<p>​	事件		：一个事情</p>
<p>​	事件源	：事件发生的地方</p>
<p>​	监听器	：一个对象</p>
<p>​	注册监听：将事件、事件源、监听器绑定在一起。当事件源发生在某个事件后，执行监听器代码</p>
<h3 id="步骤-1"><a href="#步骤-1" class="headerlink" title="步骤"></a>步骤</h3><ol>
<li><p>定义一个类，实现ServletContextListener接口</p>
</li>
<li><p>复写方法</p>
<p>void contextInitialized(ServletContextEvent sce)：监听对象创建前调用</p>
<p>void contextDestroyed(ServletContextEvent sce)：监听对象销毁前调用</p>
</li>
<li><p>配置：web.xml    或     注解@WebListener</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">lstener-class</span>&gt;</span>全限定类名<span class="tag">&lt;/<span class="name">lstener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="JSP"><a href="#JSP" class="headerlink" title="JSP"></a>JSP</h2><p>jsp是javaEE规范之一，jsp底层其实就是java程序，会服务器会将jsp文件翻译成java类，在将java类进行编译</p>
<p>jsp主要是做页面展示的，修改之后Tomcat会自动部署，根据jsp文件的最后修改时间判断是否重新部署</p>
<p><strong>JSP脚本</strong>：JSP定义java代码的方式</p>
<ol>
<li>&lt;% 代码 %&gt;：在service方法中可以定义的代码，在该脚本中都可以定义</li>
<li>&lt;%! 代码 %&gt;：在类成员位置可以定义的代码，在该脚本中都可以定义</li>
<li>&lt;%&#x3D; 代码 %&gt;：在输出语句中可以定义的数据，在该脚本中都可以定义，相当于out.print(“”);</li>
</ol>
<p><strong>注释</strong>：</p>
<!--  -->：HTML注释，JSP会翻译成字符串发送到浏览器，用户可以在浏览器中查看到

<p>&lt;%–  –%&gt;：Tomcat服务器在编译时忽略JSP注释</p>
<p><strong>指令</strong>：指导JSP的翻译引擎如何翻译JSP代码</p>
<p>语法：&lt;%@ 指令名称 属性名&#x3D;属性值 属性名&#x3D;属性值….  %&gt;</p>
<p><strong>page</strong>：配置JSP页面</p>
<p>常用属性：</p>
<ol>
<li>contentType：设置JSP响应时的mime类型以及字符集          等同于respons.setContentType() </li>
<li>pageEncoding：设置JSP响应时的字符编码</li>
<li>session：true表示当前JSP可以直接使用内置对象session，程序执行获取当前session对象，没有获取到则新建session对象；false表示不能直接使用内置对象，要想使用要使用getSession()获取session对象</li>
<li>import：导包</li>
<li>errorPage：当前页面发生异常后，会自动跳转到指定的错误页面</li>
<li>isErrorPage：标识当前页面是否为错误页面（是就可以使用内置对象exception）</li>
<li>isELIgnored：是否忽略EL表达式</li>
</ol>
<p><strong>include</strong>：页面包含的，导入页面的资源          编译期包含，翻译成一个java源文件，静态联编</p>
<ol>
<li>file：跳转的资源路径                    可以将网页头网页脚等固定不变的单独写到剪JSP文件中</li>
</ol>
<p><strong>taglib</strong>：导入资源，引入标记库</p>
<p><strong>动作</strong>：&lt;jsp:动作名 属性名&#x3D;属性值 属性名&#x3D;属性值&gt;&lt;&#x2F;jsp:动作名 &gt;</p>
<p><strong>forward</strong>：转发，跳转页面</p>
<p><strong>include</strong>：页面包含，生成了两个java源文件，动态联编</p>
<p><strong>内置对象</strong>：在jsp页面不用创建直接使用，只能在service方法中直接使用，在&lt;%%&gt;中直接使用</p>
<ol>
<li>pageContext		PageContext 	                	当前页面共享数据，还可以获取其他八个内置对象</li>
<li>request                 HttpServletRequest             同一个请求中共享数据</li>
<li>session                 HttpSession                          同一个会话中共享数据</li>
<li>application           ServletContext                     所有用户间共享数据</li>
<li>response               HttpServletResponse         响应对象</li>
<li>page                      Object                                    当前Servlet对象，相当于this</li>
<li>out                         JSPWriter                               输出对象，数据输出到页面上</li>
<li>config                    ServletConfig                        Servlet的配置对象</li>
<li>exception              Throwable                            异常对象</li>
</ol>
<h3 id="EL表达式"><a href="#EL表达式" class="headerlink" title="EL表达式"></a>EL表达式</h3><p>作用：替换和简化页面中的java的代码</p>
<p>语法：${表达式}</p>
<p>使用：</p>
<ol>
<li><p>运算符：将获取值进行运算</p>
<p>算术运算符，比较运算符，逻辑运算符，三目运算符，空运算符（empty用来判断字符串、集合、数组对象是否为null并且长度是否为0）</p>
</li>
<li><p>获取值：EL表达式只能从域对象中获取值</p>
<ol>
<li><p>${域名称.键名}：从指定域中获取指定键的值</p>
</li>
<li><p>${键名}：依次从小到大的域中查找是否含有该键对应的值</p>
</li>
<li><p>${域名称.键名.属性名}：获取对象的属性值，本质上会调用对象的getter方法，没有getter方法获取不到</p>
<p>${域名称.键名[索引]}：根据索引获取List集合中的值</p>
<p>${域名称.键名.key名称}或${域名称.键名[“key名称”]}：通过key获取Map集合中的value</p>
</li>
</ol>
</li>
</ol>
<p>隐式对象</p>
<table>
<thead>
<tr>
<th align="left"><strong>隐含对象</strong></th>
<th align="left"><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left">pageScope</td>
<td align="left">page 作用域</td>
</tr>
<tr>
<td align="left">requestScope</td>
<td align="left">request 作用域</td>
</tr>
<tr>
<td align="left">sessionScope</td>
<td align="left">session 作用域</td>
</tr>
<tr>
<td align="left">applicationScope</td>
<td align="left">application 作用域</td>
</tr>
<tr>
<td align="left">param</td>
<td align="left">Request 对象的参数，字符串</td>
</tr>
<tr>
<td align="left">paramValues</td>
<td align="left">Request对象的参数，字符串集合</td>
</tr>
<tr>
<td align="left">header</td>
<td align="left">HTTP 信息头，字符串</td>
</tr>
<tr>
<td align="left">headerValues</td>
<td align="left">HTTP 信息头，字符串集合</td>
</tr>
<tr>
<td align="left">initParam</td>
<td align="left">上下文初始化参数</td>
</tr>
<tr>
<td align="left">cookie</td>
<td align="left">Cookie值</td>
</tr>
<tr>
<td align="left">pageContext</td>
<td align="left">当前页面的pageContext</td>
</tr>
</tbody></table>
<p>${pageContext.request.contextPath}：通过pageContext获取当前页面的request内置对象，动态获取虚拟目录</p>
<h3 id="JSTL标签"><a href="#JSTL标签" class="headerlink" title="JSTL标签"></a>JSTL标签</h3><p>使用之前要导入JSTL相关jar包</p>
<p>引入标签库：taglib指令：&lt;%@ taglib perfix&#x3D;”c” uri&#x3D;”<a target="_blank" rel="noopener" href="http://java.sun.com/jsp/jstl/core&quot;">http://java.sun.com/jsp/jstl/core&quot;</a> %&gt;</p>
<p>&lt;c:**if** test&#x3D;”EL表达式条件”&gt;内容</c:if ></p>
<p>&lt;c:if test&#x3D;”EL表达式条件”&gt;：相当于java代码的if语句</p>
<p>​	test属性：接收boolean表达式，如果表达式为true，则显示标签内的内容</p>
<p>&lt;c:**choose** &gt;</p>
<p>&lt;c:when test&#x3D;”EL表达式条件”&gt;内容</c:when ></p>
<p>&lt;c:otherwise &gt;内容</c:otherwise ></p>
<p></c:choose ></p>
<p>&lt;c:choose &gt;：相当于java代码的switch语句</p>
<p>&lt;c:when test&#x3D;”EL表达式条件”&gt;：相当于case语句</p>
<p>test属性：接收表达式</p>
<p>&lt;c:otherwise &gt;相当于default语句</p>
<p>for(int i &#x3D; 0; i &lt; 10; i++)对应JSTL标签</p>
<p>&lt;c:**foreach** var&#x3D;”i” begin&#x3D;”0” end&#x3D;”9” serp&#x3D;”1”&gt;</c:foreach ></p>
<p>属性：</p>
<p>​	var：声明循环变量i———-相当于i</p>
<p>​	begin：初始化循环变量i———-相当于i&#x3D;0</p>
<p>​	end：循环变量i的最大值———-相当于i&lt;10</p>
<p>​	step：步长———-相当于i++</p>
<p>​	varStatus：循环状态对象</p>
<p>​		index：容器中元素的索引，从0开始</p>
<p>​		count：循环次数，从1开始</p>
<p>for (User user : list)对应的jstl标签。    <strong>遍历的必须是集合类型的，否则遍历出错</strong></p>
<p>&lt;c:**foreach** items&#x3D;”EL表达式获取集合容器” var&#x3D;”自定义名称key”&gt;${key.属性名}</c:foreach ></p>
<p>属性：</p>
<p>items：容器对象，相当于list</p>
<p>var：容器中元素的临时变量，相当于user</p>
<p>varStatus：循环状态对象</p>
<p>​		index：容器中元素的索引，从0开始</p>
<p>​		count：循环次数，从1开始</p>
<h2 id="jQuery"><a href="#jQuery" class="headerlink" title="jQuery"></a>jQuery</h2><h3 id="概念-1"><a href="#概念-1" class="headerlink" title="概念"></a>概念</h3><p>一个JavaScript框架，是js库，简化JS的开发</p>
<h3 id="步骤-2"><a href="#步骤-2" class="headerlink" title="步骤"></a>步骤</h3><p>导入jQuery的min.js文件（min.js生产版本，js开发版本）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script typr=<span class="string">&quot;text/javascript&quot;</span> src=<span class="string">&quot;JQuery文件路径&quot;</span>&gt; &lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>jQuery对象和JS对象的转换</p>
<p>​	jQuery —&gt;JS：jQuery对象[索引]   或  jQuery对象.get(索引)</p>
<p>​	JS—&gt;jQuery：$(JS对象)</p>
<h3 id="选择器"><a href="#选择器" class="headerlink" title="选择器"></a>选择器</h3><p>就是一个字符串，用来定位dom对象，筛选具有相似特征的元素（标签）</p>
<h4 id="标签选择器（元素选择器）"><a href="#标签选择器（元素选择器）" class="headerlink" title="标签选择器（元素选择器）"></a>标签选择器（元素选择器）</h4><p>$(“html标签名”)：获得所有匹配标签名称的元素</p>
<h4 id="id选择器"><a href="#id选择器" class="headerlink" title="id选择器"></a>id选择器</h4><p>$(“#id的属性值”)：获得与指定id属性值匹配的元素</p>
<h4 id="类选择器"><a href="#类选择器" class="headerlink" title="类选择器"></a>类选择器</h4><p>$(“.class的属性值”)：获得与指定class属性值匹配的元素</p>
<h4 id="并集选择器"><a href="#并集选择器" class="headerlink" title="并集选择器"></a>并集选择器</h4><p>$(“选择器1, 选择器2, …..”)</p>
<h4 id="表单选择器"><a href="#表单选择器" class="headerlink" title="表单选择器"></a>表单选择器</h4><p>$(“:type属性值”)：获取该属性的所有值（input标签的type属性值：text，password，radio，checkbox）</p>
<h4 id="子选择器"><a href="#子选择器" class="headerlink" title="子选择器"></a>子选择器</h4><p>$(“父选择器 &gt; 子选择器”)</p>
<h3 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h3><p>定位dom对象后，根据一些条件筛选dom对象，过滤器不能单独使用，必须和选择器一起使用</p>
<h4 id="“选择器-first”"><a href="#“选择器-first”" class="headerlink" title="$(“选择器:first”)"></a>$(“选择器:first”)</h4><p>选出第一个dom对象</p>
<h4 id="“选择器-last”"><a href="#“选择器-last”" class="headerlink" title="$(“选择器:last”)"></a>$(“选择器:last”)</h4><p>选出最后一个dom对象</p>
<h4 id="“选择器-eq-数组下标-”"><a href="#“选择器-eq-数组下标-”" class="headerlink" title="$(“选择器:eq(数组下标)”)"></a>$(“选择器:eq(数组下标)”)</h4><p>获取指定下标的dom对象</p>
<h4 id="“选择器-lt-下标-”"><a href="#“选择器-lt-下标-”" class="headerlink" title="$(“选择器:lt(下标)”)"></a>$(“选择器:lt(下标)”)</h4><p>获取小于下标的所有dom对象</p>
<h4 id="“选择器-gt-下标-”"><a href="#“选择器-gt-下标-”" class="headerlink" title="$(“选择器:gt(下标)”)"></a>$(“选择器:gt(下标)”)</h4><p>获取大于下标的所有dom对象</p>
<h4 id="“-text-enabled”"><a href="#“-text-enabled”" class="headerlink" title="$(“:text:enabled”)"></a>$(“:text:enabled”)</h4><p>获取表单中启用的文本框的dom对象</p>
<h4 id="“-text-disabled”"><a href="#“-text-disabled”" class="headerlink" title="$(“:text:disabled”)"></a>$(“:text:disabled”)</h4><p>获取表单中停用的文本框的dom对象</p>
<h4 id="“-checkbox-checked”"><a href="#“-checkbox-checked”" class="headerlink" title="$(“:checkbox:checked”)"></a>$(“:checkbox:checked”)</h4><p>获取表单中选中的复选框</p>
<h4 id="“选择器-gt-option-selected”"><a href="#“选择器-gt-option-selected”" class="headerlink" title="$(“选择器&gt;option:selected”)"></a>$(“选择器&gt;option:selected”)</h4><p>获取表单中选中的下拉列表框</p>
<h3 id="绑定事件"><a href="#绑定事件" class="headerlink" title="绑定事件"></a>绑定事件</h3><h4 id="选择器-事件名称-事件的处理函数"><a href="#选择器-事件名称-事件的处理函数" class="headerlink" title="$(选择器).事件名称(事件的处理函数)"></a>$(选择器).事件名称(事件的处理函数)</h4><p>在进行时间绑定时必须保证页面已经下载完毕，所以需要$(function(){……..});在这里进行函数时间绑定  </p>
<p>$(选择器)：定位dom对象。dom对象可以有多个</p>
<p>事件名称：就是js中时间去掉on的部分（js中的单击事件onclick()，jQuery中的时间名称就是click()）</p>
<p>事件的处理函数：就是一个function(){函数体;}，当事件发生时执行该函数</p>
<h4 id="选择器-on-“事件名称”-事件的处理函数"><a href="#选择器-on-“事件名称”-事件的处理函数" class="headerlink" title="$(选择器).on(“事件名称”, 事件的处理函数)"></a>$(选择器).on(“事件名称”, 事件的处理函数)</h4><p>事件名称：就是js中时间去掉on的部分（js中的单击事件onclick()，jQuery中的时间名称就是click()）</p>
<p>事件的处理函数：就是一个function(){函数体;}，当事件发生时执行该函数</p>
<h4 id="选择器-off-“事件名称”"><a href="#选择器-off-“事件名称”" class="headerlink" title="$(选择器).off(“事件名称”)"></a>$(选择器).off(“事件名称”)</h4><p>解除事件的绑定</p>
<p>事件名称：就是js中时间去掉on的部分（js中的单击事件onclick()，jQuery中的时间名称就是click()）</p>
<h4 id="选择器-css-“属性”-“值”"><a href="#选择器-css-“属性”-“值”" class="headerlink" title="$(选择器).css(“属性”, “值”)"></a>$(选择器).css(“属性”, “值”)</h4><p>样式控制</p>
<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><h4 id="val"><a href="#val" class="headerlink" title="val()"></a>val()</h4><p>操作数组中dom对象的value属性</p>
<p>$(选择器).val()：无参数调用形式，获取数组中第一个dom对象的value值</p>
<p>$(选择器).val(“参数”)：有参数形式调用，统一对数组中所有dom对象的value属性值进行赋值</p>
<h4 id="text"><a href="#text" class="headerlink" title="text()"></a>text()</h4><p>操作数组中所有dom对象的文字显示内容形式</p>
<p>$(选择器).text()：无参数调用形式，读取数组中所有dom对象的文字显示内容，并将所有内容拼接成一个字符串</p>
<p>$(选择器).text(参数)：有参数调用形式，对数组中的所有dom对象的文字显示内容进行统一赋值</p>
<h4 id="attr"><a href="#attr" class="headerlink" title="attr()"></a>attr()</h4><p>对val，text之外的其他属性进行操作</p>
<p>$(选择器).attr(“属性名”)：获取数组中第一个dom对象的属性值</p>
<p>$(选择器).attr(“属性名”,”属性值”)：对数组中所有dom对象的属性赋值</p>
<h4 id="remove"><a href="#remove" class="headerlink" title="remove()"></a>remove()</h4><p>$(选择器).remove()：删除数组中所有dom对象及其子对象</p>
<h4 id="empty"><a href="#empty" class="headerlink" title="empty()"></a>empty()</h4><p>$(选择器).empty()：删除数组中所有dom对象的子对象，该dom对象并不删除</p>
<h4 id="append"><a href="#append" class="headerlink" title="append()"></a>append()</h4><p>为数组中所有dom对象添加子对象</p>
<p>$(选择器).append(“<div>div内容</div>“)：添加了子对象div</p>
<h4 id="html"><a href="#html" class="headerlink" title="html()"></a>html()</h4><p>设置或返回被选元素的内容   （html能识别html标签，text不能识别html标签）</p>
<p>$(选择器).html()：无参数形式调用，获取数组中第一个dom对象的内容</p>
<p>$(选择器).html(参数)：有参数形式调用，用于设置数组中所有dom对象的内容</p>
<h4 id="each"><a href="#each" class="headerlink" title="each()"></a>each()</h4><p>对数组，json和dom数组进行遍历，对每个元素调用一次函数</p>
<p>$.each(遍历的对象，function(index, element){程序;})：index是遍历的次数，element是遍历的元素内容</p>
<p>jQuery对象.each(function(index, element){程序;})：index是遍历的次数，element是遍历的元素内容</p>
<h2 id="AJAX"><a href="#AJAX" class="headerlink" title="AJAX"></a>AJAX</h2><h3 id="概念-2"><a href="#概念-2" class="headerlink" title="概念"></a>概念</h3><p>异步的javascript和XML</p>
<p>异步和同步：客户端和服务器端相互通信的基础上</p>
<p>异步：客户端不需要保持等待服务器端的响应。在服务器处理请求的过程中，客户端可以进行其他的操作</p>
<h3 id="JS实现方式"><a href="#JS实现方式" class="headerlink" title="JS实现方式"></a>JS实现方式</h3><p>步骤：</p>
<ol>
<li><p>创建AJAX异步对象XMLHttpRequest，XMLHttpRequest对象可以在浏览器当中单独开启一个线程，接收和响应数据都在异步对象XMLHttprequest中，使用异步对象的responseText属性以字符串的形式获取响应的数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">XMLHttpRequest</span>)&#123;</span><br><span class="line">	xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="comment">//IE5和IE6使用AvtiveXObject</span></span><br><span class="line">	xhr = <span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(<span class="string">&quot;Microsoft.XMLHTTP&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>注册回调函数，给异步对象绑定事件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序指定到这里，程序不会执行，只是将回调函数注册给异步对象，等异步对象的readyState属性改变时，回调函数才会执行（readyState属性属性值改变就会调用一次回调函数）</span></span><br><span class="line">xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">if</span> (xhr.<span class="property">readyStart</span> == <span class="number">4</span>)&#123;<span class="comment">//服务器响应结束</span></span><br><span class="line">        <span class="keyword">if</span> (xhr.<span class="property">status</span> == <span class="number">200</span>)&#123;<span class="comment">//200表示服务器正常响应结束</span></span><br><span class="line">            <span class="comment">//在浏览器端接收服务器端响应的文本</span></span><br><span class="line">            <span class="keyword">var</span> s = xhr.<span class="property">responseText</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="title function_">alert</span>(xhr.<span class="property">status</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>开启浏览器和服务器之间的通道</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//method：指定请求方式为get还是put</span></span><br><span class="line"><span class="comment">//url：请求路径,get请求在url后加?提交</span></span><br><span class="line"><span class="comment">//asyn：true/false（true：支持异步，false：支持同步）</span></span><br><span class="line">xhr.<span class="title function_">open</span>(method, url, asyn);</span><br></pre></td></tr></table></figure>
</li>
<li><p>发送AJAX请求js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//此时才会发送请求,get请求</span></span><br><span class="line">xhr.<span class="title function_">send</span>();</span><br><span class="line">   </span><br><span class="line"><span class="comment">//此时才会发送请求,post请求在这提交数据</span></span><br><span class="line"><span class="comment">//post请求时要写，模拟form表单提交数据</span></span><br><span class="line">xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/x-www-form-urlencoded;charset=UTF-8&quot;</span>);</span><br><span class="line">xhr.<span class="title function_">send</span>(<span class="string">&quot;数据&quot;</span>);</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="JQeury实现方式"><a href="#JQeury实现方式" class="headerlink" title="JQeury实现方式"></a>JQeury实现方式</h3><h4 id="ajax-名称-值-名称1-值1……-名称-值之间不能存在空格"><a href="#ajax-名称-值-名称1-值1……-名称-值之间不能存在空格" class="headerlink" title="$.ajax({名称:值, 名称1:值1…….})     名称:值之间不能存在空格"></a>$.ajax({名称:值, 名称1:值1…….})     名称:值之间不能存在空格</h4><p>url:”路径”：请求路径</p>
<p>type:get&#x2F;post：请求方式</p>
<p>async:true&#x2F;false：设置是否是异步请求</p>
<p>data:{“username”:”zhq”,  ….. }：请求参数（json或数组）</p>
<p>dataType:””：设置接收到的响应数据的格式，将接收的数据进行相应的格式转化（xml，HTML，text，json）</p>
<p>success:function(a){alert(a)}：响应成功后回调函数</p>
<p>error:function(a){alert(a)}：响应错误后回调函数</p>
<h4 id="get-“url”-data-function-“dataType”"><a href="#get-“url”-data-function-“dataType”" class="headerlink" title="$.get(“url”, data, function(){}, “dataType”)"></a>$.get(“url”, data, function(){}, “dataType”)</h4><p>url：请求路径</p>
<p>data:{“username”:”zhq”,  ….. }：请求参数（json或数组）</p>
<p> function(resp){}：回调函数</p>
<p>dataType:””：设置接收到的响应数据的格式，将接收的数据进行相应的格式转化（xml，HTML，text，json）</p>
<h4 id="post-“url”-data-function-“dataType”"><a href="#post-“url”-data-function-“dataType”" class="headerlink" title="$.post(“url”, data, function(){}, “dataType”)"></a>$.post(“url”, data, function(){}, “dataType”)</h4><p>url：请求路径</p>
<p>data：{“username”:”zhq”,  ….. }请求参数（json或数组）</p>
<p> function(resp){}：回调函数</p>
<p>dataType：设置接收到的响应数据的格式，将接收的数据进行相应的格式转化（xml，HTML，text，json）</p>
<h2 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h2><h3 id="概念-3"><a href="#概念-3" class="headerlink" title="概念"></a>概念</h3><p>JavaScript的标记对象，多用于存储和交换文本信息的语法。轻量级的交换数据格式</p>
<p>JSON在线工具验证</p>
<h3 id="基本规则"><a href="#基本规则" class="headerlink" title="基本规则"></a>基本规则</h3><h4 id="存储方式"><a href="#存储方式" class="headerlink" title="存储方式"></a>存储方式</h4><p>在javascript数据存储在 名称&#x2F;值 对中：json数据由键值对构成</p>
<p>键：可以用引号引起来，单双都可</p>
<p>值：</p>
<p>​	数字（整数或浮点数）； </p>
<p>​	字符串（在双引号中）；</p>
<p>​	逻辑值（true或false）；</p>
<p>​	数组（在方括号中）   {“name”:[{}, {}, {}]}；</p>
<p>​	对象（在花括号中）   {“name”:{“name”:” “}}；</p>
<p>​	null</p>
<p>数据由逗号分隔：多个键值对由对号分隔</p>
<p>花括号保存对象：使用{}定义json格式</p>
<p>方括号保存数组：[]</p>
<h4 id="获取数据"><a href="#获取数据" class="headerlink" title="获取数据"></a>获取数据</h4><p>在javascript中使用**window.eval(JSON字符串)**解释执行java生成的JSON格式的字符串</p>
<ol>
<li><p>json对象.键名</p>
</li>
<li><p>json对象[“键名”]</p>
</li>
<li><p>数组对象[索引]：数组对象相当于键名</p>
</li>
<li><p>遍历p对象的键和值</p>
<p>for (var key in p){</p>
<p>​	alert(key+”:”+p[key])</p>
<p>}</p>
</li>
</ol>
<h4 id="数据转换"><a href="#数据转换" class="headerlink" title="数据转换"></a>数据转换</h4><p>JSON格式的字符串和java对象的相互转换        JSON解析器：jackson（Spring框架内部解析器）</p>
<ol>
<li><p>JSON格式的字符串转为Java对象</p>
<ol>
<li>导入jackson的相关jar包</li>
<li>创建jackson核心对象ObjectMapper</li>
<li>调用ObjectMapper的**readValue(json字符串数据，Class类型)**进行转化</li>
</ol>
</li>
</ol>
<p>Java对象转为JSON格式的字符串</p>
<ol>
<li><p>导入jackson的相关jar包</p>
</li>
<li><p>创建jackson核心对象ObjectMapper</p>
</li>
<li><p>调用ObjectMapper的相关方法进行转换</p>
<ol>
<li><p>writeValue(参数，obj)：</p>
<p>​	参数：</p>
<p>​		File：将obj对象转化为json字符串，并保存到指定的文件中</p>
<p>​		Writer：将obj对象转化为json字符串，并将json数据填充到字符输出流中</p>
<p>​		OutputStream：将obj对象转化为json字符串，并将json数据填充到字节输出流中</p>
</li>
<li><p>writeValueAsString(obj)：将对象转化为json字符串       （List转成的是数组，Map转成的就是对象格式）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">objectMapper.writeValueAsString(java对象);</span><br></pre></td></tr></table></figure>
</li>
<li><p>注解</p>
<ol>
<li>@JsonIgnore：排除属性，对应的对象属性不会转化为JSON字符串属性</li>
<li>@JsonFormat(pattern&#x3D;”格式”)：将对应的对象属性转化为JSON字符串时进行格式化</li>
</ol>
</li>
</ol>
</li>
</ol>
<h2 id="xml"><a href="#xml" class="headerlink" title="xml"></a>xml</h2><h3 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h3><ol>
<li>xml文档后缀名为.xml</li>
<li>xml的第一行必须定义为文档声明</li>
<li>xml文档中有且仅有一个根标签</li>
<li>属性值必须使用引号引起来</li>
<li>标签必须正确关闭</li>
<li>xml标签名称区分大小写</li>
</ol>
<h3 id="组成部分"><a href="#组成部分" class="headerlink" title="组成部分"></a>组成部分</h3><ol>
<li><p>文档声明</p>
<ol>
<li><p>格式：<?xml 属性列表 ?></p>
</li>
<li><p>属性列表</p>
<p>​	version：版本号</p>
<p>​	encoding：编码方式，告知解析引擎当前文档使用的字符集，默认为ISO-8859-1</p>
<p>​	standalone：是否独立（yes&#x2F;no）</p>
</li>
</ol>
</li>
<li><p>指令：结合CSS的</p>
</li>
<li><p>标签：标签名称自定义</p>
<p>​	规则：</p>
<p>​		名称可以包含字母数字和其他字符</p>
<p>​		名称不能一数字或标点符号开头，不能以xml开头</p>
<p>​		名称不能包含空格</p>
</li>
<li><p>属性：id属性值唯一</p>
</li>
<li><p>文本：CDATA区：在该区域内数据被原样展示（<![CDATA[数据]]>）</p>
</li>
</ol>
<h3 id="约束"><a href="#约束" class="headerlink" title="约束"></a>约束</h3><p>规定xml文档的抒写规则</p>
<ol>
<li><p>分类：</p>
<ol>
<li>DTD：简单的约束技术<ol>
<li>内部dtd：将约束规则定义在xml文档中</li>
<li>外部dtd：将约束的规则定义在外部dtd文件中<ol>
<li>本地：<!DOCTYPE 根标签 SYSTEM "dtd文件的位置"></li>
<li>网络：<!DOCTYPE 根标签 PUBLIC "dtd文件名" "dtd文件的位置URL"></li>
</ol>
</li>
</ol>
</li>
<li>Schema：复杂的约束技术<ol>
<li>填写xml文档的根标签</li>
<li>引入xsi前缀 xmlns:xsi&#x3D;”网络地址”;</li>
<li>引入学生的文件的命名空间 xsi:schemaLocation&#x3D;”网络地址  .xsd文件”</li>
<li>为学生的约束声明一个前缀，作为标识符  xmlns:标识 &#x3D; “网络地址”</li>
</ol>
</li>
</ol>
</li>
</ol>
<h3 id="Jsoup解析器"><a href="#Jsoup解析器" class="headerlink" title="Jsoup解析器"></a>Jsoup解析器</h3><p>（dom方式   不用sax方式）</p>
<h4 id="步骤-3"><a href="#步骤-3" class="headerlink" title="步骤"></a>步骤</h4><ol>
<li>导入jar包</li>
<li>获取Document对象</li>
<li>获取对应标签的Element对象 </li>
<li>获取数据</li>
</ol>
<h4 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h4><h5 id="Jsoup"><a href="#Jsoup" class="headerlink" title="Jsoup"></a>Jsoup</h5><p>工具类，解析HTML或xml文档返回Document</p>
<h5 id="parse"><a href="#parse" class="headerlink" title="parse()"></a>parse()</h5><p>解析HTML或xml文档，返回Document</p>
<p>​	parse(String html)：解析xml或HTML字符串</p>
<p>​	parse(File in, String charsetName)：解析xml或HTML文件</p>
<p>​	parse(URL url, int timeoutMillis)：通过网络获取指定的xml或HTML文件</p>
<h5 id="Document"><a href="#Document" class="headerlink" title="Document"></a>Document</h5><p>文档对象，代表内存中的dom树，获取Element对象</p>
<p>getElementById(String id)：根据id属性获取唯一的element对象</p>
<p>getElementByTag(String tagName)：根据标签名获取元素的对象集合</p>
<p>getElementByAttribute(String key)：根据属性名获取元素的对象集合</p>
<p>getElementByAttributevalue(String key, String value)：根据属性名和属性值获取元素的对象集合</p>
<p>Elements：元素Element对象的集合，可以当做ArrayList来使用</p>
<h5 id="Element"><a href="#Element" class="headerlink" title="Element"></a>Element</h5><p>元素对象</p>
<ol>
<li><p>获取子元素对象</p>
<p>getElementById(String id)：根据id属性获取唯一的element对象</p>
<p>getElementByTag(String tagName)：根据标签名获取元素的对象集合</p>
<p>getElementByAttribute(String key)：根据属性名获取元素的对象集合</p>
<p>getElementByAttributevalue(String key, String value)：根据属性名和属性值获取元素的对象集合</p>
</li>
<li><p>获取属性值</p>
<p>String attr(String key)：根据属性名获取属性值</p>
</li>
<li><p>获取文本内容</p>
<p>String text()：获取文本内容</p>
<p>String hrml()：获取标签体的所有内容</p>
</li>
</ol>
<h5 id="Node"><a href="#Node" class="headerlink" title="Node"></a>Node</h5><p>结点对象是Document和Element的父类</p>
<h3 id="快捷查询"><a href="#快捷查询" class="headerlink" title="快捷查询"></a>快捷查询</h3><ol>
<li><p>selector：选择器</p>
<p>Elements select(String cssQuery)</p>
</li>
<li><p>XPath：XPath即为xml路径语言，用来确定xml文档中的某部分的位置</p>
</li>
</ol>
<h2 id="javaweb零碎知识总结"><a href="#javaweb零碎知识总结" class="headerlink" title="javaweb零碎知识总结"></a>javaweb零碎知识总结</h2><h3 id="Junit单元测试"><a href="#Junit单元测试" class="headerlink" title="Junit单元测试"></a>Junit单元测试</h3><p><strong>步骤：</strong></p>
<ol>
<li><p>定义一个测试类（一般定义测试类名：被测试的类名+Test， 包名：xxx.xxx.test）</p>
</li>
<li><p>定义测试方法：</p>
<p>​	该方法可以独立运行（方法名：test+测试的方法名， 返回值：void， 参数列表：空参，权限为public）</p>
</li>
<li><p>给方法加@Test注解，加Test注解才能独立运行</p>
<p>@Before注解：修饰的方法会在测试之前自动执行</p>
<p>@After注解：修饰方法会在测试方法执行后自动执行</p>
</li>
<li><p>导入Junit依赖环境，导入junit的jar包</p>
</li>
</ol>
<p><strong>结果</strong>：</p>
<p>红色表示失败， 绿色表示成功</p>
<p>用断言来处理结果而不是看输出的结果是否正确：Assert.assertEquals(期望的结果， 运算的结果)</p>
<h3 id="BeanUtils工具类"><a href="#BeanUtils工具类" class="headerlink" title="BeanUtils工具类"></a>BeanUtils工具类</h3><p>简化数据封装，用于封装javaBean的</p>
<p>BeanUtils的方法：</p>
<p>​	setProperty()：设置bean的属性值      </p>
<p>​	getProperty()：获取bean的属性值        </p>
<p>​	populate(Object obj, Map map)：将map集合的键值对信息封装到JavaBean对象中</p>
<p>javaBean是标准java类满足以下条件</p>
<ol>
<li>类必须被public修饰</li>
<li>必须提供空参public修饰的构造函数</li>
<li>成员变量必须使用private修饰</li>
<li>提供公共public修饰的setter和getter方法</li>
</ol>
<p><strong>属性</strong>就是ssetter和getter方法截取后的产物，例如getUsername() —-username就是属性</p>
<p>注意：通过Beanutils自动将提交的数据封装到对象中时，需要用到的jar包：commons-beanutils-1.8.3.jar该包需要，两个jar包的支持：commons-collections-3.2.1.jar，commons-logging-1.1.1.jar这三个包需要一起倒入，否则报错！！！</p>
<h3 id="MVC开发模式"><a href="#MVC开发模式" class="headerlink" title="MVC开发模式"></a>MVC开发模式</h3><p>M：Model，模型，JavaBean              完成集体业务操作</p>
<p>V：View，视图，JSP                             展示数据</p>
<p>C：Controller，控制器，Servlet         获取用户的输入，调用模型，将数据交给视图进行展示</p>
<h3 id="三层架构：软件设计架构"><a href="#三层架构：软件设计架构" class="headerlink" title="三层架构：软件设计架构"></a>三层架构：软件设计架构</h3><ol>
<li>界面层（表示层）：用户通过界面上的组件和服务器进行交互</li>
<li>业务逻辑层：处理业务逻辑</li>
<li>数据访问层：操作数据存储文件</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/11/16/JavaWeb/" data-id="cl3u71bjv0009380l26ovexni" data-title="JavaWeb" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Redis" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/11/16/Redis/" class="article-date">
  <time class="dt-published" datetime="2021-11-16T11:03:57.000Z" itemprop="datePublished">2021-11-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/11/16/Redis/">Redis</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h1><p><em><strong>Redis</strong></em> 是典型的 <em><strong>NoSQL</strong></em> 数据库。</p>
<p><em><strong>redis官网</strong></em>：<a target="_blank" rel="noopener" href="https://redis.io/download">https://redis.io/download</a></p>
<blockquote>
<p>Redis 是一个开源的 key-value 存储系统。</p>
<p>和 Memcached 类似，它支持存储的 value 类型相对更多，包括 string、list、set、zset、sorted set、hash。</p>
<p>这些数据类型都支持 push&#x2F;pop、add&#x2F;remove 及取交集并集和差集及更丰富的操作，而且这些操作都是原子性的。</p>
<p>在此基础上，Redis 支持各种不同方式的排序。</p>
<p>与 memcached一样，为了保证效率，数据都是缓存在内存中。</p>
<p>区别的是 Redis 会周期性的把更新的数据写入磁盘或者把修改操作写入追加的记录文件。</p>
<p>并且在此基础上实现了master-slave （主从）同步。</p>
<p>单线程 + IO 多路复用。</p>
</blockquote>
<h2 id="安装和启动"><a href="#安装和启动" class="headerlink" title="安装和启动"></a>安装和启动</h2><p><strong>运行在linux系统上，默认端口号：6379</strong></p>
<p>安装 C 语言的编译环境和redis，解压redis并在给目录下执行 make</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>

<p>默认安装在 <code>/usr/local/bin</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">redis-benchmark：性能测试工具，可以在自己本子运行，看看自己本子性能如何</span><br><span class="line">redis-check-aof：修复有问题的AOF文件，rdb和aof后面讲</span><br><span class="line">redis-check-dump：修复有问题的dump.rdb文件</span><br><span class="line">redis-sentinel：Redis集群使用</span><br><span class="line">redis-server：Redis服务器启动命令</span><br><span class="line">redis-cli：客户端，操作入口</span><br></pre></td></tr></table></figure>

<p>前台启动：***&#x2F;usr&#x2F;local&#x2F;bin*** 目录下启动 <em><strong>redis</strong></em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-server(前台启动)</span><br></pre></td></tr></table></figure>

<p>后台启动：</p>
<ul>
<li><p>安装 <em><strong>redis</strong></em> 的目录 <em><strong>&#x2F;opt&#x2F;redis-6.2.6</strong></em> 中将 <em><strong>redis.conf</strong></em> 复制到任意一个文件夹下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> redis.conf /etc/redis.conf</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改 <em><strong>&#x2F;etc&#x2F;redis.conf</strong></em> 配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim redis.conf<span class="comment"># daemonize no 修改为 daemonize yes</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><em><strong>&#x2F;usr&#x2F;local&#x2F;bin</strong></em> 目录下启动 <em><strong>redis</strong></em>，并进入客户端操作redis</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">redis-server /etc/redis.conf</span><br><span class="line">redis-cli -a 4213</span><br></pre></td></tr></table></figure></li>
</ul>
<p>关闭 ：</p>
<ul>
<li><em><strong>kill</strong></em> 进程</li>
<li>在redis-cli客户端使用命令 <em><strong>shutdown</strong></em></li>
</ul>
<h2 id="NoSQL数据库"><a href="#NoSQL数据库" class="headerlink" title="NoSQL数据库"></a>NoSQL数据库</h2><ul>
<li>解决 <em><strong>CPU</strong></em> 及内存压力</li>
<li>解决 <em><strong>IO</strong></em> 压力</li>
</ul>
<p>NoSQL，意即不仅仅是 SQL，泛指非关系型的数据库</p>
<p>NoSQL 不依赖业务逻辑方式存储，而以简单的 <em><strong>key-value</strong></em> 模式存储，因此大大的增加了数据库的扩展能力</p>
<ul>
<li>不遵循 <em><strong>SQL</strong></em> 标准</li>
<li>不支持 <em><strong>ACID</strong></em></li>
<li>远超于 <em><strong>SQL</strong></em> 的性能</li>
</ul>
<p><strong>适用于的场景</strong></p>
<ul>
<li>对数据高并发的读写</li>
<li>海量数据的读写</li>
<li>对数据高可扩展性的</li>
</ul>
<p><strong>不适用的场景</strong></p>
<ul>
<li>需要事务支持</li>
<li>基于 <em><strong>sql</strong></em> 的结构化查询存储，处理复杂的关系，需要级联查询</li>
</ul>
<p><strong>大数据时代常用的数据库类型</strong></p>
<ul>
<li><p>行式数据库：将数据表中一行数据放在一个块中</p>
</li>
<li><p>列式数据库：将数据表中一列（相同属性）数据放在一个块中</p>
</li>
</ul>
<h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><p><strong>redis.conf</strong></p>
<h3 id="Units"><a href="#Units" class="headerlink" title="Units"></a>Units</h3><p>单位，开头定义了一些基本的度量单位，只支持 bytes，不支持 bit</p>
<p>大小写不敏感</p>
<h3 id="INCLUDES"><a href="#INCLUDES" class="headerlink" title="INCLUDES"></a>INCLUDES</h3><p>包含，多实例的情况可以把公用的配置文件提取出来</p>
<h3 id="NETWORK"><a href="#NETWORK" class="headerlink" title="NETWORK"></a>NETWORK</h3><p>网络相关配置</p>
<p><em><strong>bind</strong></em>：默认情况 <code>bind=127.0.0.1</code> 只能接受本机的访问请求，注释的情况下，无限制接受任何 ip 地址的访问</p>
<p><strong>protected-mode</strong>：将本机访问保护模式设置 no</p>
<p>开启protected-mode，在没有设定 bind ip 且没有设密码的情况下Redis 只允许接受本机的响应</p>
<p><em><strong>port</strong></em>：端口号，默认 6379</p>
<p><strong>tcp-backlog</strong>：设置 tcp 的 backlog，backlog 其实是一个连接队列，backlog 队列总和 $&#x3D;$ 未完成三次握手队列 $+$ 已经完成三次握手队列</p>
<p><strong>timeout</strong>：一个空闲的客户端维持多少秒会关闭，0 表示关闭该功能。即永不关闭</p>
<p><strong>tcp-keepalive</strong>：对访问客户端的一种心跳检测，每 n 秒检测一次；单位为秒，如果设置为 0，则不会进行 Keepalive检测，建议设置成 60</p>
<h3 id="GENERAL"><a href="#GENERAL" class="headerlink" title="GENERAL"></a>GENERAL</h3><p>通用</p>
<p><strong>daemonize</strong>：是否为后台进程，设置为 yes（守护进程，后台启动）</p>
<p><strong>pidfile</strong>：存放 pid 文件的位置，每个实例会产生一个不同的pid 文件</p>
<p><strong>loglevel</strong>：指定日志记录级别，Redis 支持四个级别：debug、verbose、notice、warning，默认为 notice</p>
<p><strong>logfile</strong>：日志文件名称</p>
<p><strong>database</strong>：设定库的数量 默认16，默认数据库为 0，可以使用 <code>SELECT &lt;dbid&gt;</code> 命令在连接上指定数据库 id</p>
<h3 id="SECURITY"><a href="#SECURITY" class="headerlink" title="SECURITY"></a><strong>SECURITY</strong></h3><p>安全</p>
<p>访问密码的查看、设置和取消</p>
<p>在命令中设置密码，只是临时的，重启 redis 服务器，密码就还原了，永久设置，需要在配置文件中进行设置</p>
<h3 id="LIMITS"><a href="#LIMITS" class="headerlink" title="LIMITS"></a><strong>LIMITS</strong></h3><p>限制</p>
<p><em><strong>maxclients</strong></em>：设置 redis 同时可以与多少个客户端进行连接，默认情况下为 10000 个客户端，达到了此限制，redis 则会拒绝新的连接请求，并且向这些连接请求方发出 max number of clients reached 以作回应</p>
<p><em><strong>maxmemory</strong></em>：建议必须设置，否则，将内存占满，造成服务器宕机</p>
<p>设置 redis 可以使用的内存量，一旦到达内存使用上限，redis 将会试图移除内部数据，移除规则可以通过 maxmemory-policy 来指定</p>
<p>如果 redis 无法根据移除规则来移除内存中的数据，或者设置了不允许移除，那么 redis 则会针对那些需要申请内存的指令返回错误信息，比如 SET、LPUSH 等</p>
<p>但是对于无内存申请的指令，仍然会正常响应，比如 GET 等。如果你的 redis 是主 redis（ 说明你的 redis 有从 redis ），那么在设置内存使用上限时，需要在系统中留出一些内存空间给同步队列缓存，只有在你设置的是“不移除”的情况下，才不用考虑这个因素</p>
<p><em><strong>maxmemory-policy</strong></em></p>
<p><em><strong>volatile-lru</strong></em>：使用 LRU 算法移除 key，只对设置了过期时间的键（最近最少使用）</p>
<p><em><strong>allkeys-lru</strong></em>：在所有集合 key 中，使用 LRU 算法移除 key</p>
<p><em><strong>volatile-random</strong></em>：在过期集合中移除随机的 key，只对设置了过期时间的键</p>
<p><em><strong>allkeys-random</strong></em>：在所有集合 key 中，移除随机的 key</p>
<p><em><strong>volatile-ttl</strong></em>：移除那些 TTL 值最小的 key，即那些最近要过期的 key</p>
<p><em><strong>noeviction</strong></em>：不进行移除。针对写操作，只是返回错误信息</p>
<p><em><strong>maxmemory-samples</strong></em>：设置样本数量，<em><strong>LRU</strong></em> 算法和最小 <em><strong>TTL</strong></em> 算法都并非是精确的算法，而是估算值，所以你可以设置样本的大小，<em><strong>redis</strong></em> 默认会检查这么多个 <em><strong>key</strong></em> 并选择其中 <em><strong>LRU</strong></em> 的那个</p>
<p>一般设置 3 到 7 的数字，数值越小样本越不准确，但性能消耗越小</p>
<h2 id="常用五大基本数据类型"><a href="#常用五大基本数据类型" class="headerlink" title="常用五大基本数据类型"></a>常用五大基本数据类型</h2><h3 id="key操作"><a href="#key操作" class="headerlink" title="key操作"></a>key操作</h3><p><code>keys *</code>：查看当前库所有 <em><strong>key</strong></em></p>
<p><code>exists key</code>：判断某个 <em><strong>key</strong></em> 是否存在</p>
<p><code>type key</code>：查看你的 <em><strong>key</strong></em> 是什么类型</p>
<p><code>del key</code> ：删除指定的 <em><strong>key</strong></em> 数据</p>
<p><code>unlink key</code>：根据 <em><strong>value</strong></em> 选择非阻塞删除，仅将 <em><strong>keys</strong></em> 从 <em><strong>keyspace</strong></em> 元数据中删除，真正的删除在后续异步操作</p>
<p><code>expire key n</code> ：为给定的 <em><strong>key</strong></em> 设置过期时间</p>
<p><code>ttl key</code>：查看还有多少秒过期，-1表示永不过期，-2表示已过期</p>
<p><code>select</code>：切换数据库（数据库有0~15，0是默认的数据库）</p>
<p><code>dbsize</code>：查看当前数据库中 <em><strong>key</strong></em> 的数量</p>
<p><code>flushdb</code>：清空当前库</p>
<p><code>flushall</code>：清空全部库</p>
<h3 id="字符串（String）"><a href="#字符串（String）" class="headerlink" title="字符串（String）"></a>字符串（String）</h3><p><em><strong>String</strong></em> 类型是二进制安全的，可以包含任何数据，比如 <em><strong>jpg</strong></em> 图片或者序列化的对象</p>
<p><em><strong>String</strong></em> 类型是 <em><strong>Redis</strong></em> 最基本的数据类型，一个 <em><strong>Redis</strong></em> 中字符串 <em><strong>value</strong></em> 最多可以是 512M</p>
<p>常用命令：</p>
<p><code>set &lt;key&gt;&lt;value&gt;</code>：添加键值对（若key已经存在则修改value的值）</p>
<p><code>get &lt;key&gt;</code>：查询对应键的值</p>
<p><code>append &lt;key&gt;&lt;value&gt;</code>：将给定的 value 追加到原值的末尾</p>
<p><code>strlen &lt;key&gt;</code>：获得值的长度</p>
<p><code>setnx &lt;key&gt;&lt;value&gt;</code>：只有在 <em><strong>key</strong></em> 不存在时，设置 <em><strong>key</strong></em> 的值</p>
<p><code>incr &lt;key&gt;</code>：将 <em><strong>key</strong></em> 中储存的数字值增 1，只能对数字值操作，如果为空，新增值为 1（<strong>具有原子性</strong>）</p>
<p><code>decr &lt;key&gt;</code>：将 <em><strong>key</strong></em> 中储存的数字值减 1，只能对数字值操作，如果为空，新增值为 -1</p>
<p><code>incrby/decrby &lt;key&gt;&lt;步长&gt;</code>：将 <em><strong>key</strong></em> 中储存的数字值增减，自定义步长</p>
<p><code>mset &lt;key1&gt;&lt;value1&gt;&lt;key2&gt;&lt;value2&gt;...</code> ：同时设置一个或多个 <em><strong>key-value</strong></em> 对</p>
<p><code>mget &lt;key1&gt;&lt;key2&gt;&lt;key3&gt;...</code>：同时获取一个或多个 <em><strong>value</strong></em></p>
<p><code>msetnx &lt;key1&gt;&lt;value1&gt;&lt;key2&gt;&lt;value2&gt; </code>：同时设置一个或多个 <em><strong>key-value</strong></em> 对（所有给定 <em><strong>key</strong></em> 都不存在）</p>
<p><code>getrange &lt;key&gt;&lt;起始位置&gt;&lt;结束位置&gt;</code>：获得值中此范围的数据，从0开始</p>
<p><code>setrange &lt;key&gt;&lt;起始位置&gt;&lt;value&gt;</code>：在起始位置后插入value的值</p>
<p><code>setex &lt;key&gt;&lt;过期时间&gt;&lt;value&gt;</code>：设置键值的同时，设置过期时间，单位秒</p>
<p><code>getset &lt;key&gt;&lt;value&gt;</code>：以新换旧，设置了新值同时获得旧值。</p>
<p><strong>原子性</strong></p>
<p>所谓 <strong>原子</strong> 操作是指不会被线程调度机制打断的操作，操作一旦开始，就一直运行到结束，中间不会有任何 <em><strong>context switch</strong></em> （切换到另一个线程）</p>
<ul>
<li>在单线程中， 能够在单条指令中完成的操作都可以认为是”原子操作”，因为中断只能发生于指令之间</li>
<li>在多线程中，不能被其它进程（线程）打断的操作就叫原子操作</li>
</ul>
<p><em><strong>Redis</strong></em> 单命令的原子性主要得益于 <em><strong>Redis</strong></em> 的单线程</p>
<p><strong>数据结构</strong></p>
<p>String内部结构实现上类似于 <em><strong>Java</strong></em> 的 <em><strong>ArrayList</strong></em>，采用预分配冗余空间的方式来减少内存的频繁分配</p>
<h3 id="列表（List）"><a href="#列表（List）" class="headerlink" title="列表（List）"></a>列表（List）</h3><p><em><strong>Redis</strong></em> 列表是简单的字符串列表，按照插入顺序排序，可以添加一个元素到列表的头部（左边）或者尾部（右边）</p>
<p>底层实际是个双向链表，对两端的操作性能很高，通过索引下标操作中间的节点性能会较差</p>
<p>常用命令：</p>
<p><code>lpush/rpush &lt;key&gt;&lt;value1&gt;&lt;value2&gt;&lt;value3&gt; ...</code>： 从左边&#x2F;右边插入一个或多个值</p>
<p><code>lpop/rpop &lt;key&gt;</code>：从左边&#x2F;右边吐出一个值。值在键在，值光键亡</p>
<p><code>rpoplpush &lt;key1&gt;&lt;key2&gt;</code>：从 <em><strong>key1</strong></em> 列表右边吐出一个值，插到 <em><strong>key2</strong></em> 列表左边</p>
<p><code>lrange &lt;key&gt;&lt;start&gt;&lt;stop&gt;</code>：按照索引下标获得元素（从左到右），0左边第一个，-1右边第一个，（0 -1表示获取所有）</p>
<p><code>lindex &lt;key&gt;&lt;index&gt;</code>：按照索引下标获得元素（从左到右）</p>
<p><code>llen &lt;key&gt;</code>：获得列表长度</p>
<p><code>linsert &lt;key&gt; before/after &lt;value&gt;&lt;newvalue&gt;</code>：在 <em><strong>value</strong></em> 的前面&#x2F;后面插入 <em><strong>newvalue</strong></em> 插入值</p>
<p><code>lrem &lt;key&gt;&lt;n&gt;&lt;value&gt;</code>：从左边删除 <em><strong>n</strong></em> 个 <em><strong>value</strong></em>值（从左到右）</p>
<p><code>lset&lt;key&gt;&lt;index&gt;&lt;value&gt;</code>：将列表 <em><strong>key</strong></em> 下标为 <em><strong>index</strong></em> 的值替换成 <em><strong>value</strong></em></p>
<p><strong>数据结构</strong></p>
<p>首先在列表元素较少的情况下会使用一块连续的内存存储，这个结构是 <em><strong>ziplist</strong></em>，也即是压缩列表</p>
<p>它将所有的元素紧挨着一起存储，分配的是一块连续的内存，当数据量比较多的时候才会改成 <em><strong>quicklist</strong></em></p>
<p>因为普通的链表需要的附加指针空间太大，会比较浪费空间，<em><strong>Redis</strong></em> 将链表和 <em><strong>ziplist</strong></em> 结合起来组成了 <em><strong>quicklist</strong></em>。也就是将多个 <em><strong>ziplist</strong></em> 使用双向指针串起来使用。这样既满足了快速的插入删除性能，又不会出现太大的空间冗余</p>
<h3 id="Set（集合）"><a href="#Set（集合）" class="headerlink" title="Set（集合）"></a>Set（集合）</h3><p><em><strong>Set</strong></em> 对外提供的功能与 <em><strong>List</strong></em> 类似列表的功能，特殊之处在于 <em><strong>Set</strong></em> 是可以 <strong>自动排重</strong> 的，并且 <em><strong>Set</strong></em> 提供了判断某个成员是否在一个 <em><strong>Set</strong></em> 集合内的重要接口</p>
<p><em><strong>Redis</strong></em> 的 <em><strong>Set</strong></em> 是 <em><strong>String</strong></em> 类型的无序集合，底层其实是一个 <em><strong>value</strong></em> 为 <em><strong>null</strong></em> 的 <em><strong>hash</strong></em> 表，所以添加，删除，查找的复杂度都是 <em><strong>O(1)</strong></em></p>
<p>常用命令：</p>
<p><code>sadd &lt;key&gt;&lt;value1&gt;&lt;value2&gt; ... </code>：将一个或多个 <em><strong>member</strong></em> 元素加入到集合 <em><strong>key</strong></em> 中，已经存在的 <em><strong>member</strong></em> 元素将被忽略</p>
<p><code>smembers &lt;key&gt;</code>：取出该集合的所有值</p>
<p><code>sismember &lt;key&gt;&lt;value&gt;</code>：判断集合 <em><strong>key</strong></em> 是否为含有该 <em><strong>value</strong></em> 值，有返回 1，没有返回 0</p>
<p><code>scard &lt;key&gt;</code>：返回该集合的元素个数</p>
<p><code>srem &lt;key&gt;&lt;value1&gt;&lt;value2&gt; ...</code>：删除集合中的某个元素</p>
<p><code>spop &lt;key&gt;</code>：随机从该集合中吐出一个值，值光键亡</p>
<p><code>srandmember &lt;key&gt;&lt;n&gt;</code>：随机从该集合中取出 <em><strong>n</strong></em> 个值，不会从集合中删除</p>
<p><code>smove &lt;key&gt;&lt;newkey&gt;&lt;value&gt;</code>：把集合中一个值从一个集合(key)移动到另一个集合(newkey)</p>
<p><code>sinter &lt;key1&gt;&lt;key2&gt;</code>：返回两个集合的交集元素</p>
<p><code>sunion &lt;key1&gt;&lt;key2&gt;</code>：返回两个集合的并集元素</p>
<p><code>sdiff &lt;key1&gt;&lt;key2&gt;</code>：返回两个集合的差集元素（<em><strong>key1</strong></em> 中的，不包含 <em><strong>key2</strong></em> 中的）</p>
<p><strong>数据结构</strong></p>
<p><em><strong>Set</strong></em> 数据结构是字典，字典是用哈希表实现的</p>
<h3 id="Hash（哈希）"><a href="#Hash（哈希）" class="headerlink" title="Hash（哈希）"></a>Hash（哈希）</h3><p><em><strong>Redis hash</strong></em> 是一个键值对集合</p>
<p><em><strong>Redis hash</strong></em> 是一个 <em><strong>String</strong></em> 类型的 <em><strong>field</strong></em> 和 <em><strong>value</strong></em> 的映射表，<em><strong>hash</strong></em> 特别适合用于存储对象</p>
<p>常用命令：</p>
<p><code>hset &lt;key&gt;&lt;field&gt;&lt;value&gt;</code>：给 <em><strong>key</strong></em> 集合中的 <em><strong>field</strong></em> 键赋值 <em><strong>value</strong></em></p>
<p><code>hget &lt;key1&gt;&lt;field&gt;</code>：从 <em><strong>key1</strong></em> 集合 <em><strong>field</strong></em> 取出 <em><strong>value</strong></em></p>
<p><code>hmset &lt;key1&gt;&lt;field1&gt;&lt;value1&gt;&lt;field2&gt;&lt;value2&gt;...</code>： 批量设置 <em><strong>hash</strong></em> 的值</p>
<p><code>hexists &lt;key1&gt;&lt;field&gt;</code>：查看哈希表 <em><strong>key</strong></em> 中，给定域 <em><strong>field</strong></em> 是否存在</p>
<p><code>hkeys &lt;key&gt;</code>：列出该 <em><strong>hash</strong></em> 集合的所有 <em><strong>field</strong></em></p>
<p><code>hvals &lt;key&gt;</code>：列出该 <em><strong>hash</strong></em> 集合的所有 <em><strong>value</strong></em></p>
<p><code>hincrby &lt;key&gt;&lt;field&gt;&lt;increment&gt;</code>：为哈希表 <em><strong>key</strong></em> 中的域 <em><strong>field</strong></em> 的值加上增量 1   -1</p>
<p><code>hsetnx &lt;key&gt;&lt;field&gt;&lt;value&gt;</code>：将哈希表 <em><strong>key</strong></em> 中的域 <em><strong>field</strong></em> 的值设置为 <em><strong>value</strong></em>（当域 <em><strong>field</strong></em> 不存在）</p>
<p><strong>数据结构</strong></p>
<p><em><strong>Hash</strong></em> 类型对应的数据结构是两种：<em><strong>ziplist</strong></em>（压缩列表），<em><strong>hashtable</strong></em>（哈希表）</p>
<p>当 <em><strong>field-value</strong></em> 长度较短且个数较少时，使用 <em><strong>ziplist</strong></em>，否则使用 <em><strong>hashtable</strong></em></p>
<h3 id="Zset（有序集合）"><a href="#Zset（有序集合）" class="headerlink" title="Zset（有序集合）"></a>Zset（有序集合）</h3><p>有序集合的每个成员都关联了一个评分（<em><strong>score</strong></em>），这个评分（<em><strong>score</strong></em>）被用来按照从最低分到最高分的方式排序集合中的成员。集合的成员是唯一的，但是评分可以是重复的</p>
<p>因为元素是有序的，所以可以很快的根据评分（<em><strong>score</strong></em>）或者次序（<em><strong>position</strong></em>）来获取一个范围的元素</p>
<p>常用命令：</p>
<p><code>zadd &lt;key&gt;&lt;score1&gt;&lt;value1&gt;&lt;score2&gt;&lt;value2&gt;...</code>：将一个或多个 <em><strong>member</strong></em> 元素及其 <em><strong>score</strong></em> 值加入到有序集 <em><strong>key</strong></em> 当中</p>
<p><code>zrange &lt;key&gt;&lt;start&gt;&lt;stop&gt; [WITHSCORES] </code>：返回有序集 <em><strong>key</strong></em> 中，下标在 <em><strong>start和stop</strong></em> 之间的元素</p>
<p>当带 <em><strong>WITHSCORES</strong></em>，可以让分数一起和值返回到结果集</p>
<p><code>zrangebyscore &lt;key&gt; min max [withscores] [limit offset count]</code>：返回有序集 <em><strong>key</strong></em> 中，所有 <em><strong>score</strong></em> 值介于 <em><strong>min</strong></em> 和 <em><strong>max</strong></em> 之间（包括等于 <em><strong>min</strong></em> 或 <em><strong>max</strong></em> ）的成员，有序集成员按 <em><strong>score</strong></em> 值递增（从小到大）排列</p>
<p><code>zrevrangebyscore &lt;key&gt; max min [withscores] [limit offset count] </code>：同上，改为从大到小排列</p>
<p><code>zincrby &lt;key&gt;&lt;increment&gt;&lt;value&gt;</code>：为元素的 <em><strong>score</strong></em> 加上增量</p>
<p><code>zrem &lt;key&gt;&lt;value&gt;</code>：删除该集合下，指定值的元素</p>
<p><code>zcount &lt;key&gt;&lt;min&gt;&lt;max&gt;</code>：统计该集合，分数区间内的元素个数</p>
<p><code>zrank &lt;key&gt;&lt;value&gt;</code>：返回该值在集合中的排名，从 0 开始</p>
<p><strong>数据结构</strong></p>
<p><em><strong>SortedSet（zset）</strong></em>是 <em><strong>Redis</strong></em> 等价于 <em><strong>Java</strong></em> 的数据结构 ***Map&lt;String, Double&gt;***，可以给每一个元素 <em><strong>value</strong></em> 赋予一个权重 <em><strong>score</strong></em>，并且它又类似于 <em><strong>TreeSet</strong></em>，内部的元素会按照权重 <em><strong>score</strong></em> 进行排序，可以得到每个元素的名次，还可以通过 <em><strong>score</strong></em> 的范围来获取元素的列表</p>
<p><em><strong>zset</strong></em> 底层使用了两个数据结构</p>
<ul>
<li><em><strong>hash</strong></em>，<em><strong>hash</strong></em> 的作用就是关联元素 <em><strong>value</strong></em> 和权重 <em><strong>score</strong></em>，保障元素 <em><strong>value</strong></em> 的唯一性，可以通过元素 <em><strong>value</strong></em> 找到相应的 <em><strong>score</strong></em> 值</li>
<li>跳跃表，跳跃表的目的在于给元素 <em><strong>value</strong></em> 排序，根据 <em><strong>score</strong></em> 的范围获取元素列表</li>
</ul>
<h2 id="Redis6新数据结构"><a href="#Redis6新数据结构" class="headerlink" title="Redis6新数据结构"></a>Redis6新数据结构</h2><h3 id="Bitmaps"><a href="#Bitmaps" class="headerlink" title="Bitmaps"></a>Bitmaps</h3><p>实际是字符串类型（key-value），但是可以对字符串的位进行操作，可以将value看做数组（将字符串使用二进制0和1表示，数组的每一个元素称为偏移量）</p>
<p>常用命令：</p>
<p><code>setbit &lt;key&gt;&lt;offset&gt;&lt;value&gt;</code>：设置Bitmaps中某个偏移量的值（0或1）</p>
<p><code>get &lt;key&gt;&lt;offset&gt;</code>：获取Bitmaps中某个偏移量的值</p>
<p><code>bitcount &lt;key&gt; [start end]</code>：统计字符串从start到end字节比特值是1的数量</p>
<p><code>bitop and(or/not/xor) &lt;destkey&gt; &lt;key&gt;&lt;key1&gt;...</code>：多个Bitmaps的交集，并集，非，异或操作，并将结果保存在destkey中</p>
<h3 id="HyperLogLog"><a href="#HyperLogLog" class="headerlink" title="HyperLogLog"></a>HyperLogLog</h3><p>用来做基数统计的（基数：集合中去除重复元素之后所得的集合中元素的个数）</p>
<p>常用命令：</p>
<p><code>pfadd &lt;key&gt;&lt;element&gt;&lt;element1&gt;...</code>：添加指定元素到HyperLogLog中</p>
<p><code>pfcount &lt;key&gt;&lt;key1&gt;...</code>：统计HLL的近似基数</p>
<p><code>pfmerge &lt;destkey&gt;&lt;sourvekey&gt;&lt;sourvekey1&gt;...</code>：将一个或多个HLL合并之后的结果存储在另一个HLL中</p>
<h3 id="Geospatial"><a href="#Geospatial" class="headerlink" title="Geospatial"></a>Geospatial</h3><p>元素的2维坐标，在地图上就是经度和纬度</p>
<p>常见命令：</p>
<p><code>geoadd &lt;key&gt;&lt;longitude&gt;&lt;latitude&gt;&lt;member&gt;&lt;longitude1&gt;&lt;latitude1&gt;&lt;member1&gt;...</code>：添加地理位置（经度-180<del>180，纬度-85.05</del>85.05，名称）</p>
<p><code>geopos &lt;key&gt;&lt;member&gt;&lt;member1&gt;...</code>：获得指定地区的坐标信息</p>
<p><code>geodist &lt;key&gt;&lt;member1&gt;&lt;member2&gt; [m|km|mi|ft]</code>：获取两个位置之间的直线距离（米（默认），千米，英里，英尺）</p>
<p><code>georadius &lt;key&gt;&lt;longitude&gt;&lt;latitude&gt;&lt;radius&gt; [m|km|mi|ft]</code>：以给定的经纬度为中心，找出某一半径内的元素</p>
<h2 id="Redis的发布与订阅"><a href="#Redis的发布与订阅" class="headerlink" title="Redis的发布与订阅"></a>Redis的发布与订阅</h2><p>Redis 发布订阅（ <em><strong>pub&#x2F;sub</strong></em> ）是一种消息通信模式：发送者（ <em><strong>pub</strong></em> ）发送消息，订阅者（ <em><strong>sub</strong></em> ）接收消息</p>
<p>Redis 客户端可以订阅任意数量的频道</p>
<p>客户端可以订阅频道</p>
<img src="Redis/image-20220402231459951.png" alt="image-20220402231459951" style="zoom:80%;" />

<p>当给这个频道发布消息后，消息就会发送给订阅的客户端</p>
<img src="Redis/image-20220402231509749.png" alt="image-20220402231509749" style="zoom:80%;" />

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">subscribe channel  <span class="comment">#订阅channel频道</span></span><br><span class="line">publish channel hello  <span class="comment">#频道发送hello信息</span></span><br></pre></td></tr></table></figure>



<h2 id="事务和锁机制"><a href="#事务和锁机制" class="headerlink" title="事务和锁机制"></a>事务和锁机制</h2><p>Redis 事务是一个单独的隔离操作：事务中的所有命令都会序列化、按顺序地执行，事务在执行的过程中，不会被其他客户端发送来的命令请求所打断</p>
<p>Redis 事务的主要作用就是<strong>串联多个命令</strong>防止别的命令插队</p>
<p><img src="Redis/image-20220402231519830.png" alt="image-20220402231519830" style="zoom:80%;" /><img src="/Redis/image-20220402231537723.png" alt="image-20220402231537723"></p>
<p>从输入 <em><strong>Multi</strong></em> 命令开始，输入的命令都会依次进入命令队列中，但不会执行，直到输入 <em><strong>Exec</strong></em> 后，<em><strong>Redis</strong></em> 会将之前的命令队列中的命令依次执行（组队的过程中可以通过 <em><strong>Discard</strong></em> 来放弃组队）</p>
<p>当组队中某个命令出现了报告错误，执行时整个的所有队列都会被取消；执行时某个命令出现了错误报告，只是出错的命令不被执行，其他命令正常执行</p>
<ul>
<li><p>组队成功，提交成功</p>
<img src="Redis/image-20220402231541245.png" alt="image-20220402231541245" style="zoom:80%;" />
</li>
<li><p>放弃组队</p>
<img src="Redis/image-20220402231550506.png" alt="image-20220402231550506" style="zoom:80%;" /></li>
</ul>
<h3 id="悲观锁"><a href="#悲观锁" class="headerlink" title="悲观锁"></a>悲观锁</h3><p>悲观锁（<em><strong>Pessimistic Lock</strong></em>），即每次去拿数据的时候都认为有其他线程会修改，所以每次在拿数据的时候都会上锁，这样其他线程想要拿到这个数据就会被 <em><strong>block</strong></em> 直到成功拿到锁（效率低）</p>
<h3 id="乐观锁"><a href="#乐观锁" class="headerlink" title="乐观锁"></a>乐观锁</h3><p>乐观锁（<em><strong>Optimistic Lock</strong></em>），即每次去拿数据的时候都认为其他线程不会修改，所以不会上锁，但是在更新的时候会判断一下在此期间有没有其他线程去更新这个数据，可以使用版本号等机制（更新数据时版本号同样更新）</p>
<p><strong>乐观锁适用于多读的应用类型，这样可以提高吞吐量</strong></p>
<p>Redis就是利用 <em><strong>check-and-set</strong></em> （判断版本号是否相同）机制实现事务的</p>
<h4 id="Watch命令、unwatch命令"><a href="#Watch命令、unwatch命令" class="headerlink" title="Watch命令、unwatch命令"></a>Watch命令、unwatch命令</h4><p><strong>可以解决超卖的问题，但会造成库存遗留问题</strong></p>
<p><code>unwatch</code>：取消 <em><strong>WATCH</strong></em> 命令对所有 <em><strong>key</strong></em> 的监视，如果在执行 <em><strong>WATCH</strong></em> 命令之后，<em><strong>EXEC</strong></em> 命令或 <em><strong>DISCARD</strong></em> 命令先被执行，那么就不需要再执行 <em><strong>UNWATCH</strong></em></p>
<h3 id="事务三特性"><a href="#事务三特性" class="headerlink" title="事务三特性"></a>事务三特性</h3><ul>
<li><p>单独的隔离操作</p>
<p>事务中的所有命令都会序列化、按顺序地执行。事务在执行的过程中，不会被其他客户端发送来的命令请求所打断</p>
</li>
<li><p>没有隔离级别的概念</p>
<p>队列中的命令没有提交之前都不会实际被执行，因为事务提交前任何指令都不会被实际执行</p>
</li>
<li><p>不保证原子性</p>
<p>事务中如果有一条命令执行失败，其后的命令仍然会被执行，没有回滚</p>
</li>
</ul>
<h2 id="持久化"><a href="#持久化" class="headerlink" title="持久化"></a>持久化</h2><h3 id="RDB"><a href="#RDB" class="headerlink" title="RDB"></a>RDB</h3><p>在指定的时间间隔内将内存中的数据集快照写入磁盘， 即 <em><strong>Snapshot</strong></em> 快照，恢复时是将快照文件直接读到内存里</p>
<img src="Redis/image-20220402231605922.png" alt="image-20220402231605922" style="zoom:80%;" />

<p>Redis会单独创建一个子进程（<em><strong>fork</strong></em>）来进行持久化</p>
<p>先将数据写入到一个临时文件中，待持久化过程完成后，再将这个临时文件内容覆盖到 <em><strong>dump.rdb</strong></em></p>
<p>整个过程中，主进程是不进行任何 <em><strong>IO</strong></em> 操作的，这就确保了极高的性能，如果需要进行大规模数据的恢复，且对于数据恢复的完整性不是非常敏感，那 <em><strong>RDB</strong></em> 方式要比 <em><strong>AOF</strong></em> 方式更加的高效</p>
<p><strong>RDB的缺点是最后一次持久化后的数据可能丢失</strong></p>
<h4 id="Fork"><a href="#Fork" class="headerlink" title="Fork"></a>Fork</h4><ul>
<li>作用是复制一个与当前进程一样的进程，新进程的所有数据（变量、环境变量、程序计数器等） 都和原进程一致，但是是一个全新的进程，并作为原进程的子进程</li>
<li>在Linux程序中，<em><strong>fork()</strong></em> 会产生一个和父进程完全相同的子进程，但子进程在此后多会 <em><strong>exec</strong></em> 系统调用，出于效率考虑，Linux中引入了 <strong>写时拷贝技术</strong></li>
<li><strong>一般情况父进程和子进程会共用同一段物理内存</strong>，只有进程空间的各段的内容要发生变化时，才会将父进程的内容复制一份给子进程</li>
</ul>
<h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><p><strong>dump.rdb</strong>：文件名字，在 <em><strong>redis.conf</strong></em> 中配置文件名称，默认为 <em><strong>dump.rdb</strong></em></p>
<p><strong>dump.rdb</strong>：保存位置，<em><strong>rdb</strong></em> 文件的保存路径可以修改，默认为 <em><strong>Redis</strong></em> 启动时命令行所在的目录下</p>
<p><em><strong>stop-writes-on-bgsave-error</strong></em>：当 <em><strong>redis</strong></em> 无法写入磁盘，关闭 <em><strong>redis</strong></em> 的写入操作</p>
<p><em><strong>rdbcompression</strong></em>：持久化的文件是否进行压缩存储</p>
<p><em><strong>rdbchecksum</strong></em>：完整性的检查，即数据是否完整性、准确性</p>
<p><em><strong>save</strong></em>：表示写操作的次数（格式：save 秒 写操作次数，代表在该秒数内进行多少次写操作会将数据写入磁盘）</p>
<h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><ul>
<li>适合大规模的数据恢复</li>
<li>对数据完整性和一致性要求不高更适合使用</li>
<li>节省磁盘空间</li>
<li>恢复速度快</li>
</ul>
<h4 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h4><ul>
<li><em><strong>Fork</strong></em> 的时候，内存中的数据被克隆了一份，大致 2 倍的膨胀性需要考虑</li>
<li>虽然Redis在 <em><strong>fork</strong></em> 时使用了<strong>写时拷贝技术</strong>，但是如果数据庞大时还是比较消耗性能</li>
<li>在备份周期在一定间隔时间做一次备份，所以如果Redis意外 <em><strong>down</strong></em> 掉，就会丢失最后一次快照后的所有修改</li>
</ul>
<h3 id="AOF"><a href="#AOF" class="headerlink" title="AOF"></a>AOF</h3><p>以日志的形式来记录每个写操作（增量保存），将 Redis 执行过的所有写指令记录下来（读操作不记录）， 只许追加文件不可以修改文件，如果 Redis 重启就会根据日志文件的内容将写指令从前到后执行一次以完成数据的恢复工作</p>
<p><strong>执行流程</strong></p>
<ul>
<li>客户端的请求写命令会被 <em><strong>append</strong></em> 追加到 <em><strong>AOF</strong></em> 缓冲区内</li>
<li><em><strong>AOF</strong></em> 缓冲区根据 <em><strong>AOF</strong></em> 持久化策略 <code>[always,everysec,no]</code> 将操作 <em><strong>sync</strong></em> 同步到磁盘的 <em><strong>AOF</strong></em> 文件中</li>
<li><em><strong>AOF</strong></em> 文件大小超过重写策略或手动重写时，会对 <em><strong>AOF</strong></em> 文件 <em><strong>Rewrite</strong></em> 重写，压缩 <em><strong>AOF</strong></em> 文件容量</li>
<li><em><strong>Redis</strong></em> 服务重启时，会重新 <em><strong>load</strong></em> 加载 <em><strong>AOF</strong></em> 文件中的写操作达到数据恢复的目的</li>
</ul>
<p><em><strong>AOF</strong></em> 和 <em><strong>RDB</strong></em> 同时开启时，系统默认读取 <em><strong>AOF</strong></em> 的数据（数据不会存在丢失）</p>
<h4 id="配置-1"><a href="#配置-1" class="headerlink" title="配置"></a>配置</h4><p><strong>AOF默认不开启</strong></p>
<p><strong>appendonly.aof</strong>：文件名字，保存路径容rdb一致</p>
<p><em><strong>appendfsync always</strong></em>：始终同步，每次 <em><strong>Redis</strong></em> 的写入都会立刻记入日志（性能较差但数据完整性比较好）</p>
<p><em><strong>appendfsync everysec</strong></em>：每秒同步，每秒记入日志一次，如果宕机，本秒的数据可能丢失</p>
<p><em><strong>appendfsync no</strong></em>：Redis 不主动进行同步，把同步时机交给操作系统</p>
<p><strong>Rewrite压缩</strong></p>
<p>当 <em><strong>AOF</strong></em> 文件的大小超过所设定的阈值时，Redis 就会启动 <em><strong>AOF</strong></em> 文件的内容压缩，只保留可以恢复数据的最小指令集，可以使用命令 <em><strong>bgrewriteaof</strong></em></p>
<h4 id="优点-1"><a href="#优点-1" class="headerlink" title="优点"></a>优点</h4><ul>
<li>备份机制更稳健，丢失数据概率更低</li>
<li>可读的日志文本，通过操作 <em><strong>AOF</strong></em> 稳健，可以处理误操作</li>
</ul>
<h4 id="缺点-1"><a href="#缺点-1" class="headerlink" title="缺点"></a>缺点</h4><ul>
<li>比起 <em><strong>RDB</strong></em> 占用更多的磁盘空间</li>
<li>恢复备份速度要慢</li>
<li>每次读写都同步的话，有一定的性能压力</li>
<li>存在个别 <em><strong>Bug</strong></em>，造成不能恢复</li>
</ul>
<h3 id="选择"><a href="#选择" class="headerlink" title="选择"></a>选择</h3><p>官方推荐两个都启用</p>
<p>如果对数据不敏感，可以选单独用 <em><strong>RDB</strong></em></p>
<p>不建议单独用 <em><strong>AOF</strong></em>，因为可能会出现 <em><strong>Bug</strong></em></p>
<p>如果只是做纯内存缓存，可以都不用</p>
<h2 id="主从复制"><a href="#主从复制" class="headerlink" title="主从复制"></a>主从复制</h2><p>主机数据更新后根据配置和策略， 自动同步到从机的 <em><strong>master&#x2F;slaver</strong></em> 机制，<em><strong>Master</strong></em> 以写为主，<em><strong>Slaver</strong></em> 以读为主</p>
<img src="Redis/image-20220402231618214.png" alt="image-20220402231618214" style="zoom:80%;" />

<ol>
<li>读写分离，性能扩展</li>
<li>容灾快速恢复</li>
<li>一主多从</li>
</ol>
<h3 id="搭建一主两从"><a href="#搭建一主两从" class="headerlink" title="搭建一主两从"></a>搭建一主两从</h3><p>将 <em><strong>redis.conf</strong></em> 复制到当前目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> /etc/redis.conf /opt/etc/</span><br></pre></td></tr></table></figure>

<p>创建 3 个 <em><strong>redis.conf</strong></em> 配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">redis6379.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># redis6379.conf</span></span><br><span class="line">include /opt/etc/redis.conf <span class="comment">#引入原来的redis配置文件</span></span><br><span class="line">pidfile /var/run/redis_6379.pid</span><br><span class="line">port 6379</span><br><span class="line">dbfilename dump6379.rdb</span><br></pre></td></tr></table></figure>

<p>启动 3 台 <em><strong>redis</strong></em> 服务器，并查看主机运行情况</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">redis-server /etc/redis6379.conf</span><br><span class="line">redis-cli -p 6379</span><br><span class="line"></span><br><span class="line">info replication</span><br></pre></td></tr></table></figure>

<p>配从不配主</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">slaveof  &lt;ip&gt;&lt;port&gt;   <span class="comment">#成为某个实例的从服务器</span></span><br></pre></td></tr></table></figure>



<h3 id="一主二仆"><a href="#一主二仆" class="headerlink" title="一主二仆"></a>一主二仆</h3><p>一个主机，两个从机</p>
<p>当从机宕机，重新启动后不在是从机（重新设置为从机后会把主机的数据重新复制）</p>
<p>当主机宕机，从机仍然保持是从机，重新启动后仍然是主机</p>
<h3 id="薪火相传"><a href="#薪火相传" class="headerlink" title="薪火相传"></a>薪火相传</h3><img src="Redis/image-20220402231627461.png" alt="image-20220402231627461" style="zoom:80%;" />

<p>上一个 <em><strong>slave</strong></em> 可以是下一个 <em><strong>slave</strong></em> 的 <em><strong>master</strong></em>，<em><strong>slave</strong></em> 同样可以接收其他 <em><strong>slave</strong></em>的连接和同步请求，那么该 <em><strong>slave</strong></em> 作为了链条中下一个的 <em><strong>master</strong></em>，可以有效减轻 <em><strong>master</strong></em> 的写压力，去中心化降低风险</p>
<p>中途变更转向：会清除之前的数据，重新建立拷贝最新的</p>
<p>当某个 <em><strong>slave</strong></em> 宕机，后面的 <em><strong>slave</strong></em> 都没法备份</p>
<h3 id="反客为主"><a href="#反客为主" class="headerlink" title="反客为主"></a>反客为主</h3><p>当一个 <em><strong>master</strong></em> 宕机后，后面的 <em><strong>slave</strong></em> 可以立刻升为 <em><strong>master</strong></em>，其后面的 <em><strong>slave</strong></em> 不用做任何修改</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">slaveof no one</span><br></pre></td></tr></table></figure>



<h3 id="哨兵模式"><a href="#哨兵模式" class="headerlink" title="哨兵模式"></a>哨兵模式</h3><p><strong>反客为主的自动版</strong>，即能够后台监控主机是否故障，如果故障了根据投票数自动将从库转换为主库</p>
<p>创建 <em><strong>sentinel.conf</strong></em> 文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> /opt/etc/sentinel.conf</span><br></pre></td></tr></table></figure>

<p>配置哨兵</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mymaster：监控对象起的服务器名称</span></span><br><span class="line"><span class="comment"># 1表示至少有1个哨兵同意迁移的数量</span></span><br><span class="line">sentinel monitor mymaster ip 端口号 1</span><br></pre></td></tr></table></figure>

<p>启动哨兵</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-sentinel  /opt/etc/sentinel.conf </span><br></pre></td></tr></table></figure>

<p>主机宕机，会从机选举中产生新的主机（宕机的主机重新启动后会变为从机）</p>
<p><strong>选举规则</strong></p>
<ul>
<li>根据优先级别<em><strong>slave-priority&#x2F;replica-priority</strong></em>，优先选择优先级靠前的</li>
<li>根据偏移量（从机和主机的数据一致性），优先选择偏移量大的</li>
<li>根据 <em><strong>runid</strong></em>（redis启动时会动生成的id），优先选择最小的服务</li>
</ul>
<h4 id="复制延时"><a href="#复制延时" class="headerlink" title="复制延时"></a>复制延时</h4><p>由于所有的写操作都是先在 <em><strong>master</strong></em> 上操作，然后同步更新到 <em><strong>slave</strong></em> 上，所以从 <em><strong>master</strong></em> 同步到 <em><strong>slave</strong></em> 有一定的延迟，当系统很繁忙的时候，延迟问题会更加严重，<em><strong>slave</strong></em> 机器数量的增加也会使这个问题更加严重</p>
<h3 id="复制原理"><a href="#复制原理" class="headerlink" title="复制原理"></a>复制原理</h3><ul>
<li><em><strong>slave</strong></em> 启动成功连接到 <em><strong>master</strong></em> 后会发送一个 <em><strong>sync</strong></em> 命令（同步命令）</li>
<li><em><strong>master</strong></em> 接到命令启动后台的存盘进程，对数据进行持久化操作，同时收集所有接收到的用于修改数据集命令，在后台进程执行完毕之后，<em><strong>master</strong></em> 将传送整个数据文件（<em><strong>rdb</strong></em>）到 <em><strong>slave</strong></em>，以完成一次完全同步</li>
<li>连接成功之后当主服务进行写操作后，和从服务器进行数据同步</li>
<li>全量复制：<em><strong>slave</strong></em> 服务在接收到数据库文件数据后，将其存盘并加载到内存中</li>
<li>增量复制：<em><strong>master</strong></em> 继续将新的所有收集到的修改命令依次传给 <em><strong>slave</strong></em>，完成同步</li>
<li><em><strong>slave</strong></em>连接 <em><strong>master</strong></em>，一次完全同步（全量复制）将被自动执行</li>
</ul>
<h2 id="集群"><a href="#集群" class="headerlink" title="集群"></a>集群</h2><p>解决容量不够和并发写操作问题</p>
<ul>
<li><p>代理主机（ <em><strong>之前</strong></em> ）</p>
<img src="Redis/image-20220402231639618.png" alt="image-20220402231639618" style="zoom:80%;" />
</li>
<li><p>无中心化集群配置（ <em><strong>redis3.0</strong></em> ）</p>
</li>
</ul>
<img src="Redis/image-20220402231651540.png" alt="image-20220402231651540" style="zoom:80%;" />

<p>Redis 集群实现了对 Redis 的水平扩容，即启动 <em><strong>N</strong></em> 个 Redis 节点，将整个数据库分布存储在这 <em><strong>N</strong></em> 个节点中，每个节点存储总数据的 <em><strong>1&#x2F;N</strong></em> </p>
<p>Redis 集群通过分区（<em><strong>partition</strong></em>）来提供一定程度的可用性（<em><strong>availability</strong></em>），即使集群中有一部分节点失效或者无法进行通讯， 集群也可以继续处理命令请求</p>
<h3 id="搭建-Redis-集群"><a href="#搭建-Redis-集群" class="headerlink" title="搭建 Redis 集群"></a>搭建 <em>Redis</em> 集群</h3><p>创建配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">include /opt/etc/redis.conf <span class="comment">#引入原来的redis配置文件</span></span><br><span class="line">pidfile /var/run/redis_6379.pid</span><br><span class="line">port 6379</span><br><span class="line">dbfilename dump6379.rdb</span><br><span class="line">cluster-enabled <span class="built_in">yes</span>  <span class="comment">#打开集群模式</span></span><br><span class="line">cluster-config-file nodes-6379.conf  <span class="comment">#设置节点配置文件名称，需要更改</span></span><br><span class="line">cluster-node-timeout 15000  <span class="comment">#设置节点失联事件，超过该时间（ms），集群自动进行主从切换</span></span><br></pre></td></tr></table></figure>

<p>创建集群</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进入redis安装目录</span></span><br><span class="line"><span class="built_in">cd</span> /opt/redis-6.2.6/src</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行  （--cluster-replicas 1，表示希望为集群中的每个主节点创建一个从节点）</span></span><br><span class="line">redis-cli --cluster create --cluster-replicas 1 172.16.88.168:6379 172.16.88.168:6380 172.16.88.168:6381 172.16.88.168:6389 172.16.88.168:6390 172.16.88.168:6391</span><br></pre></td></tr></table></figure>

<p>采用集群策略连接</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">redis-cli -c -p 端口号  <span class="comment">#启动集群</span></span><br><span class="line">cluster nodes  <span class="comment">#命令查看集群信息</span></span><br></pre></td></tr></table></figure>



<h4 id="集群分配"><a href="#集群分配" class="headerlink" title="集群分配"></a>集群分配</h4><p>一个集群至少要有三个主节点</p>
<p>分配原则尽量保证每个主数据库运行在不同的 <em><strong>IP</strong></em> 地址，每个从库和主库不在一个 <em><strong>IP</strong></em> 地址上</p>
<img src="Redis/image-20220402231700831.png" alt="image-20220402231700831" style="zoom:80%;" />



<h4 id="什么是-slots"><a href="#什么是-slots" class="headerlink" title="什么是 slots"></a>什么是 slots</h4><p>一个Redis集群包含 <em><strong>16384</strong></em> 个插槽（<em><strong>hash slot</strong></em>），数据库中的每个键都属于这 <em><strong>16384</strong></em> 个插槽的其中一个</p>
<p>集群使用公式 <em><strong>CRC16(key)%16384</strong></em> 来计算键 <em><strong>key</strong></em> 属于哪个槽，<em><strong>CRC16(key)</strong></em> 语句用于计算键 <em><strong>key</strong></em> 的 <em><strong>CRC16</strong></em> 校验和 </p>
<p>集群中的每个节点负责处理一部分插槽</p>
<p> 例如， 如果一个集群有三个主库， 其中：</p>
<ul>
<li>节点 <em><strong>A</strong></em> 负责处理 <em><strong>0</strong></em> 号至 <em><strong>5460</strong></em> 号插槽</li>
<li>节点 <em><strong>B</strong></em> 负责处理 <em><strong>5461</strong></em> 号至 <em><strong>10922</strong></em> 号插槽</li>
<li>节点 <em><strong>C</strong></em> 负责处理 <em><strong>10923</strong></em> 号至 <em><strong>16383</strong></em> 号插槽</li>
</ul>
<h4 id="集群中录入值"><a href="#集群中录入值" class="headerlink" title="集群中录入值"></a>集群中录入值</h4><p>在 <em><strong>redis-cli</strong></em> 每次录入、查询键值，redis 都会计算出该 <em><strong>key</strong></em> 应该送往的插槽，如果不是该客户端对应服务器的插槽，redis 会报错，并告知应前往的redis实例地址和端口</p>
<p><em><strong>redis-cli</strong></em> 客户端提供了 <em><strong>–c</strong></em> 参数实现自动重定向</p>
<p>例如 <em><strong>redis-cli -c –p 6379</strong></em> 登入后，再录入、查询键值对可以自动重定向</p>
<p>集群中要一次添加多个<em><strong>key</strong></em>，需要将给<em><strong>key</strong></em>添加组（key后使用{user}，表示添加到user组）</p>
<h4 id="查询集群中的值"><a href="#查询集群中的值" class="headerlink" title="查询集群中的值"></a>查询集群中的值</h4><p>每个主机只能查询自己范围内的插槽的值</p>
<p><code>cluster keyslot &lt;key&gt;</code>：查询某个 <em><strong>key</strong></em> 的 **<em>slot</em> **</p>
<p><code>cluster countkeysinslot &lt;slot&gt;</code>：查询某个 <em><strong>slot</strong></em> 是否有值</p>
<p><code>CLUSTER GETKEYSINSLOT &lt;slot&gt;&lt;count&gt;</code>：返回 <em><strong>count</strong></em> 个 <em><strong>slot</strong></em> 槽中的键</p>
<h4 id="故障恢复"><a href="#故障恢复" class="headerlink" title="故障恢复"></a>故障恢复</h4><p>主节点下线，从节点会自动升为主节点（注意：<em><strong>15</strong></em> 秒超时），主节点恢复后会变成从机</p>
<p>如果所有某一段插槽的主从节点都宕掉，redis 服务是否还能继续</p>
<ul>
<li><em><strong>cluster-require-full-coverage&#x3D;yes</strong></em>：整个集群都挂掉</li>
<li><em><strong>cluster-require-full-coverage&#x3D;no</strong></em>：该插槽数据全都不能使用，也无法存储</li>
</ul>
<h3 id="优点-2"><a href="#优点-2" class="headerlink" title="优点"></a>优点</h3><ul>
<li>实现扩容</li>
<li>分摊压力</li>
<li>无中心配置相对简单</li>
</ul>
<h3 id="缺点-2"><a href="#缺点-2" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>多键操作是不被支持的，需要给键分在同组，根据组给键分槽</li>
<li>多键的Redis事务和<em><strong>lua</strong></em> 脚本不被支持</li>
<li>由于集群方案出现较晚，很多公司已经采用了其他的集群方案，而代理或者客户端分片的方案想要迁移至<em><strong>redis cluster</strong></em>，需要整体迁移而不是逐步过渡，复杂度较大</li>
</ul>
<h2 id="Jedis操作Redis"><a href="#Jedis操作Redis" class="headerlink" title="Jedis操作Redis"></a>Jedis操作Redis</h2><p><strong>依赖</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>连接 Redis</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JedisDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;192.168.57.101&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">pong</span> <span class="operator">=</span> jedis.ping();</span><br><span class="line">        System.out.println(<span class="string">&quot;连接成功：&quot;</span> + pong);</span><br><span class="line">        jedis.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Key</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">jedis.set(<span class="string">&quot;k1&quot;</span>, <span class="string">&quot;v1&quot;</span>);</span><br><span class="line">Set&lt;String&gt; keys = jedis.keys(<span class="string">&quot;*&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (String key : keys) &#123;</span><br><span class="line"> System.out.println(key);</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(jedis.exists(<span class="string">&quot;k1&quot;</span>));</span><br><span class="line">System.out.println(jedis.ttl(<span class="string">&quot;k1&quot;</span>));                </span><br><span class="line">System.out.println(jedis.get(<span class="string">&quot;k1&quot;</span>));</span><br></pre></td></tr></table></figure>

<p><strong>String</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">jedis.mset(<span class="string">&quot;str1&quot;</span>,<span class="string">&quot;v1&quot;</span>,<span class="string">&quot;str2&quot;</span>,<span class="string">&quot;v2&quot;</span>,<span class="string">&quot;str3&quot;</span>,<span class="string">&quot;v3&quot;</span>);</span><br><span class="line">System.out.println(jedis.mget(<span class="string">&quot;str1&quot;</span>,<span class="string">&quot;str2&quot;</span>,<span class="string">&quot;str3&quot;</span>));</span><br></pre></td></tr></table></figure>

<p><strong>List</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list = jedis.lrange(<span class="string">&quot;mylist&quot;</span>,<span class="number">0</span>,-<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (String element : list) &#123;</span><br><span class="line"> System.out.println(element);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Set</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">jedis.sadd(<span class="string">&quot;orders&quot;</span>, <span class="string">&quot;order01&quot;</span>);</span><br><span class="line">Set&lt;String&gt; smembers = jedis.smembers(<span class="string">&quot;orders&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (String order : smembers) &#123;</span><br><span class="line"> System.out.println(order);</span><br><span class="line">&#125;</span><br><span class="line">jedis.srem(<span class="string">&quot;orders&quot;</span>, <span class="string">&quot;order02&quot;</span>);</span><br></pre></td></tr></table></figure>

<p><strong>Hash</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">jedis.hset(<span class="string">&quot;hash1&quot;</span>,<span class="string">&quot;userName&quot;</span>,<span class="string">&quot;lisi&quot;</span>);</span><br><span class="line">System.out.println(jedis.hget(<span class="string">&quot;hash1&quot;</span>,<span class="string">&quot;userName&quot;</span>));</span><br><span class="line"></span><br><span class="line">Map&lt;String,String&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String,String&gt;();</span><br><span class="line">map.put(<span class="string">&quot;telphone&quot;</span>,<span class="string">&quot;13810169999&quot;</span>);</span><br><span class="line">jedis.hmset(<span class="string">&quot;hash2&quot;</span>,map);</span><br><span class="line">List&lt;String&gt; result = jedis.hmget(<span class="string">&quot;hash2&quot;</span>, <span class="string">&quot;telphone&quot;</span>,<span class="string">&quot;email&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (String element : result) &#123;</span><br><span class="line"> System.out.println(element);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>zset</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jedis.zadd(<span class="string">&quot;zset01&quot;</span>, <span class="number">100d</span>, <span class="string">&quot;z3&quot;</span>);</span><br><span class="line">Set&lt;String&gt; zrange = jedis.zrange(<span class="string">&quot;zset01&quot;</span>, <span class="number">0</span>, -<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (String e : zrange) &#123;</span><br><span class="line"> System.out.println(e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Jedis-主从复制"><a href="#Jedis-主从复制" class="headerlink" title="Jedis 主从复制"></a><em>Jedis</em> 主从复制</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> JedisSentinelPool jedisSentinelPool=<span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span>  Jedis <span class="title function_">getJedisFromSentinel</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(jedisSentinelPool==<span class="literal">null</span>)&#123;</span><br><span class="line">        Set&lt;String&gt; sentinelSet=<span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">        sentinelSet.add(<span class="string">&quot;172.16.88.168:26379&quot;</span>); <span class="comment">// 端口为sentinal</span></span><br><span class="line">        <span class="comment">//创建自定义pool连接池类</span></span><br><span class="line">        <span class="type">JedisPoolConfig</span> <span class="variable">jedisPoolConfig</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">JedisPoolConfig</span>();</span><br><span class="line">        jedisPoolConfig.setMaxTotal(<span class="number">10</span>); <span class="comment">// 最大可用连接数</span></span><br><span class="line">        jedisPoolConfig.setMaxIdle(<span class="number">5</span>); <span class="comment">// 最大闲置连接数</span></span><br><span class="line">        jedisPoolConfig.setMinIdle(<span class="number">5</span>); <span class="comment">// 最小闲置连接数</span></span><br><span class="line">        jedisPoolConfig.setBlockWhenExhausted(<span class="literal">true</span>); <span class="comment">// 连接耗尽是否等待</span></span><br><span class="line">        jedisPoolConfig.setMaxWaitMillis(<span class="number">2000</span>); <span class="comment">// 等待时间</span></span><br><span class="line">        jedisPoolConfig.setTestOnBorrow(<span class="literal">true</span>); <span class="comment">// 取连接的时候进行测试</span></span><br><span class="line"></span><br><span class="line">        jedisSentinelPool=<span class="keyword">new</span> <span class="title class_">JedisSentinelPool</span>(<span class="string">&quot;mymaster&quot;</span>,sentinelSet,jedisPoolConfig); <span class="comment">// 服务主机名</span></span><br><span class="line">        <span class="keyword">return</span> jedisSentinelPool.getResource();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> jedisSentinelPool.getResource();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="集群的-Jedis-开发"><a href="#集群的-Jedis-开发" class="headerlink" title="集群的 Jedis 开发"></a>集群的 <em>Jedis</em> 开发</h3><p>即使连接的不是主机，集群会自动切换主机存储（主机写，从机读）</p>
<p>无中心化主从集群，无论从哪台主机写的数据，其他主机上都能读到数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JedisClusterTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123; </span><br><span class="line">        Set&lt;HostAndPort&gt;set =<span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;HostAndPort&gt;();</span><br><span class="line">        set.add(<span class="keyword">new</span> <span class="title class_">HostAndPort</span>(<span class="string">&quot;172.16.88.168&quot;</span>,<span class="number">6379</span>)); <span class="comment">// 任何一个端口</span></span><br><span class="line">        <span class="comment">//创建集群</span></span><br><span class="line">        <span class="type">JedisCluster</span> <span class="variable">jedisCluster</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JedisCluster</span>(set);</span><br><span class="line">        jedisCluster.set(<span class="string">&quot;k1&quot;</span>, <span class="string">&quot;v1&quot;</span>);</span><br><span class="line">        System.out.println(jedisCluster.get(<span class="string">&quot;k1&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="应用问题解决"><a href="#应用问题解决" class="headerlink" title="应用问题解决"></a>应用问题解决</h2><h3 id="缓存穿透"><a href="#缓存穿透" class="headerlink" title="缓存穿透"></a>缓存穿透</h3><img src="Redis/image-20220402231713881.png" alt="image-20220402231713881" style="zoom: 80%;" />

<p><em><strong>key</strong></em> 对应的数据在数据源并不存在，每次针对此 <em><strong>key</strong></em> 的请求从缓存获取不到，请求都会压到数据源，从而可能压垮数据源</p>
<p>比如用一个不存在的用户 <em><strong>id</strong></em> 获取用户信息，不论缓存还是数据库都没有，若黑客利用此漏洞进行攻击可能压垮数据库</p>
<ol>
<li>应用服务器压力变大</li>
<li>redis 命中率下降，一直查询数据库</li>
</ol>
<h4 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h4><ul>
<li><p><strong>对空值缓存</strong></p>
<p>如果一个查询返回的数据为空（不管是数据是否不存在），仍然把这个空结果（<em><strong>null</strong></em>）进行缓存，设置空结果的过期时间会很短，最长不超过五分钟</p>
</li>
<li><p><strong>设置可访问的名单（白名单）</strong></p>
<p>使用 <em><strong>bitmaps</strong></em> 类型定义一个可以访问的名单，名单 <em><strong>id</strong></em> 作为 <em><strong>bitmaps</strong></em> 的偏移量，每次访问和 <em><strong>bitmap</strong></em> 里面的 <em><strong>id</strong></em> 进行比较，如果访问 <em><strong>id</strong></em> 不在 <em><strong>bitmaps</strong></em> 里面，进行拦截，则不允许访问</p>
</li>
<li><p><strong>采用布隆过滤器</strong></p>
<p>布隆过滤器（<em><strong>Bloom Filter</strong></em>）是1970年由布隆提出的。它实际上是一个很长的二进制向量（位图）和一系列随机映射函数（哈希函数）</p>
<p>布隆过滤器可以用于检索一个元素是否在一个集合中。它的优点是空间效率和查询时间都远远超过一般的算法，缺点是有一定的误识别率和删除困难</p>
<p>将所有可能存在的数据哈希到一个足够大的 <em><strong>bitmaps</strong></em> 中，一个一定不存在的数据会被这个 <em><strong>bitmaps</strong></em> 拦截掉，从而避免了对底层存储系统的查询压力</p>
</li>
<li><p><strong>进行实时监控</strong></p>
<p>当发现 Redis 的命中率开始急速降低，需要排查访问对象和访问的数据，和运维人员配合，可以设置黑名单限制服务</p>
</li>
</ul>
<h3 id="缓存击穿"><a href="#缓存击穿" class="headerlink" title="缓存击穿"></a>缓存击穿</h3><img src="Redis/image-20220402231733279.png" alt="image-20220402231733279" style="zoom:80%;" />

<p><em><strong>key</strong></em> 对应的数据存在，但在 redis 中过期，此时若有大量并发请求过来，这些请求发现缓存过期一般都会从后端<em><strong>DB</strong></em> 加载数据并回设到缓存，这个时候大并发的请求可能会瞬间把后端 <em><strong>DB</strong></em> 压垮</p>
<ol>
<li>数据库访问压力瞬间增大</li>
<li>redis中没有出现大量 <em><strong>key</strong></em> 过期，<em><strong>redis</strong></em> 正常运行（即某个经常访问的 <em><strong>key</strong></em> 过期，突然大量访问这个数据）</li>
</ol>
<h4 id="解决-1"><a href="#解决-1" class="headerlink" title="解决"></a>解决</h4><ul>
<li><p><strong>预先设置热门数据</strong></p>
<p>在 redis 高峰访问之前，把一些热门数据提前存入到 redis 里面，加大这些热门数据 <em><strong>key</strong></em> 的时长</p>
</li>
<li><p><strong>实时调整</strong></p>
<p>现场监控哪些数据热门，实时调整 <em><strong>key</strong></em> 的过期时长</p>
</li>
<li><p><strong>使用锁</strong></p>
</li>
</ul>
<h3 id="缓存雪崩"><a href="#缓存雪崩" class="headerlink" title="缓存雪崩"></a>缓存雪崩</h3><p><em><strong>key</strong></em> 对应的数据存在，但在 redis 中过期，此时若有大量并发请求过来，这些请求发现缓存过期一般都会从后端<em><strong>DB</strong></em> 加载数据并回设到缓存，这个时候大并发的请求可能会瞬间把后端 <em><strong>DB</strong></em> 压垮</p>
<p>缓存雪崩与缓存击穿的区别在于这里针对很多 <em><strong>key</strong></em> 缓存，前者则是某一个 <em><strong>key</strong></em></p>
<ol>
<li>数据库压力变大</li>
<li>即极少的时间段，查询大量 <em><strong>key</strong></em> 的集中过期情况</li>
</ol>
<h4 id="解决-2"><a href="#解决-2" class="headerlink" title="解决"></a>解决</h4><ul>
<li><p><strong>构建多级缓存架构</strong></p>
<p><em><strong>nginx</strong></em> 缓存 + <em><strong>redis</strong></em> 缓存 + 其他缓存（<em><strong>ehcache</strong></em>等）</p>
</li>
<li><p><strong>使用锁或队列</strong></p>
<p>用加锁或者队列的方式保证来保证不会有大量的线程对数据库一次性进行读写，从而避免失效时大量的并发请求落到底层存储系统上。不适用高并发情况</p>
</li>
<li><p><strong>设置过期标志更新缓存</strong></p>
<p>记录缓存数据是否过期（设置提前量），如果过期会触发通知另外的线程在后台去更新实际 <em><strong>key</strong></em> 的缓存</p>
</li>
<li><p><strong>将缓存失效时间分散开</strong></p>
<p>比如我们可以在原有的失效时间基础上增加一个随机值，比如 1～5 分钟随机，这样每一个缓存的过期时间的重复率就会降低，就很难引发集体失效的事件</p>
</li>
</ul>
<h3 id="分布式锁"><a href="#分布式锁" class="headerlink" title="分布式锁"></a>分布式锁</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/11/16/Redis/" data-id="cl3u71bk4000j380l0eq0f39j" data-title="Redis" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Linux8" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/11/13/Linux8/" class="article-date">
  <time class="dt-published" datetime="2021-11-13T11:03:57.000Z" itemprop="datePublished">2021-11-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/11/13/Linux8/">Linux8</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Linux8"><a href="#Linux8" class="headerlink" title="Linux8"></a>Linux8</h1><h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><ol>
<li>**&#x2F;**：根目录</li>
<li><strong>bin</strong>：存储一些二进制文件，文件都是可以被运行的</li>
<li><strong>sbin</strong>：存储一些可以被执行的二进制文件，但必须有super权限的用户才能执行</li>
<li><strong>dev</strong>：存储外接设备，外接设备不能直接使用，需要挂载</li>
<li><strong>etc</strong>：存储一些配置文件</li>
<li><strong>home</strong>：除了root用户以外的其他用户的家目录</li>
<li><strong>proc</strong>：存储linux运行时的进程</li>
<li><strong>root</strong>：root用户的家目录</li>
<li><strong>tmp</strong>：临时的，存储系统运行产生的临时文件</li>
<li><strong>lib</strong>：库文件</li>
<li><strong>usr</strong>：存放用户自己安装的软件</li>
<li><strong>var</strong>：存放的程序或系统的日志文件</li>
<li><strong>boot</strong>：系统内核</li>
<li><strong>media</strong>：移动设备默认挂载点</li>
<li><strong>mnt</strong>：外接设备手动挂载在mnt目录</li>
</ol>
<h2 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h2><p>tcpdump -nn -i 网卡名称(eth0) port 端口</p>
<h3 id="命令管理"><a href="#命令管理" class="headerlink" title="命令管理"></a>命令管理</h3><h4 id="别名机制"><a href="#别名机制" class="headerlink" title="别名机制"></a>别名机制</h4><p>创建自定的命令，依靠别名映射文件~&#x2F;.bashrc</p>
<h4 id="快捷键："><a href="#快捷键：" class="headerlink" title="快捷键："></a>快捷键：</h4><p>Ctrl+U：删除光标前的内容</p>
<p>Ctrl+C：终止命令执行</p>
<p>Ctrl+Shift+C：复制</p>
<p>Ctrl+Shift+V：粘贴</p>
<p>clear或Ctrl+L：清除终端中的命令或信息</p>
<h4 id="help"><a href="#help" class="headerlink" title="help"></a>help</h4><p>type 命令：查看命令是内部命令（Shell内部）还是外部命令</p>
<p>功能：获取命令说明</p>
<p>格式：内部命令：<code>help 命令</code></p>
<p>​			外部命令：<code>命令 --help</code></p>
<h4 id="man"><a href="#man" class="headerlink" title="man"></a>man</h4><p>功能：查看命令详细说明</p>
<p>格式：<code>man 命令</code></p>
<h4 id="which"><a href="#which" class="headerlink" title="which"></a>which</h4><p>功能：查看命令的绝对路径</p>
<p>格式：<code>which 命令</code></p>
<h4 id="whereis"><a href="#whereis" class="headerlink" title="whereis"></a>whereis</h4><p>功能：查看命令的绝对路径以及文档手册信息</p>
<p>格式：<code>whereis 命令</code></p>
<h4 id="管道"><a href="#管道" class="headerlink" title="管道 |"></a>管道 |</h4><p>管道不能单独使用，要结合其他命令使用</p>
<ol>
<li>管道前边命令的输出结果用于管道后边命令的输入</li>
<li>|xargs：结合管道使用，让上一个的标准输出作为下一个命令的参数</li>
</ol>
<h4 id="sudo"><a href="#sudo" class="headerlink" title="sudo"></a>sudo</h4><ol>
<li>sudo可以让管理员事先定义某些特殊命令谁可以执行</li>
<li>sudo的配置文件：&#x2F;etc&#x2F;sudoers</li>
<li>使用visudo命令打开配置文件，进行修改，允许的命令建议用which查看完整路径在写入</li>
</ol>
<h3 id="目录管理"><a href="#目录管理" class="headerlink" title="目录管理"></a>目录管理</h3><h4 id="ls"><a href="#ls" class="headerlink" title="ls"></a>ls</h4><p>功能：列出当前目录下所有内容</p>
<p>格式：<code>ls [选项] [文件名或目录名]</code></p>
<p>选项及作用：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-s</td>
<td>显示每个文件的大小</td>
</tr>
<tr>
<td>-S</td>
<td>按文件大小排序</td>
</tr>
<tr>
<td>-a</td>
<td>显示目录中全部文件（包括隐藏文件）</td>
</tr>
<tr>
<td>-l</td>
<td>使用长列表格式，显示文件详细信息</td>
</tr>
<tr>
<td>-t</td>
<td>按文件修改的时间排序</td>
</tr>
<tr>
<td>-F</td>
<td>显示文件类型描述符</td>
</tr>
<tr>
<td>-h</td>
<td>通过可读性高的形式展示</td>
</tr>
</tbody></table>
<h4 id="cd"><a href="#cd" class="headerlink" title="cd"></a>cd</h4><p>功能：切换用户所在目录</p>
<p>格式：<code>cd [路径名或特殊符号]</code></p>
<p>特殊符号及作用：</p>
<table>
<thead>
<tr>
<th>特殊符号</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>&#x2F;</td>
<td>从当前目录跳转到根目录</td>
</tr>
<tr>
<td>.</td>
<td>前往当前目录</td>
</tr>
<tr>
<td>. .</td>
<td>前往上一级目录</td>
</tr>
<tr>
<td>-</td>
<td>进入当前目录之前操作的目录</td>
</tr>
<tr>
<td>~或无参数</td>
<td>回到当前用户的家目录</td>
</tr>
</tbody></table>
<h4 id="pwd"><a href="#pwd" class="headerlink" title="pwd"></a>pwd</h4><p>功能：显示当前目录的绝对路径</p>
<p>格式：<code>pwd</code></p>
<h4 id="mkdir"><a href="#mkdir" class="headerlink" title="mkdir"></a>mkdir</h4><p>功能：创建一个新的目录</p>
<p>格式：<code>mkdir [选项] 目录名</code></p>
<p>选项及作用：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-m 权限</td>
<td>对新建目录设置存取权限，权限有744、755等</td>
</tr>
<tr>
<td>-p</td>
<td>一次性创建多级目录（以递归形式创建）</td>
</tr>
</tbody></table>
<h4 id="rmdir"><a href="#rmdir" class="headerlink" title="rmdir"></a>rmdir</h4><p>功能：删除一个空目录</p>
<p>格式：<code>rmdir [-p] 目录名</code>（-p代表递归删除各级目录）</p>
<h3 id="文件管理"><a href="#文件管理" class="headerlink" title="文件管理"></a>文件管理</h3><h4 id="touch"><a href="#touch" class="headerlink" title="touch"></a>touch</h4><p>功能：创建一个空文件</p>
<p>格式：<code>touch 文件名</code></p>
<h4 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h4><p>功能：显示某文件的内容</p>
<p>格式：<code>cat [选项] [文件名]...</code></p>
<p>选项及作用：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-a</td>
<td>显示所有字符（换行符、制表符、其它非打印字符）</td>
</tr>
<tr>
<td>-n</td>
<td>对文件中所有的行进行编号并显示行号</td>
</tr>
<tr>
<td>-b</td>
<td>除了空行不编号，文件中其它行都进行编号并显示行号</td>
</tr>
<tr>
<td>-s</td>
<td>将连续的空行压缩为一个空行</td>
</tr>
</tbody></table>
<p>其它特殊格式：</p>
<table>
<thead>
<tr>
<th>特殊格式</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>cat 文件名 | ls</td>
<td>按页显示文件内容</td>
</tr>
<tr>
<td>cat</td>
<td>此命令没有任何参数，即cat单独使用。在开始执行时，光标停留在下一行，等待键盘输入，当用户输入一行后，按下回车，就会显示一行相同的内容。当用户结束输入时，按下Ctrl+D键退出，回到命令提示符下。</td>
</tr>
<tr>
<td>cat &gt; 新文件名</td>
<td>“&gt;”这个大于号是重导向符号。代表把键盘输入的信息重导向输入到新文件中。内容输入结束后，同样也是按Ctrl+D键退出新文件的制作。</td>
</tr>
<tr>
<td>cat 文件名2 &gt;&gt; 文件名1</td>
<td>该用法实现了把文件2的全部内容追加到文件1的末尾</td>
</tr>
<tr>
<td>cat 文件名1 文件名2 &gt; 文件名3</td>
<td>该用法实现了把文件1和文件2的内容合并输入到文件3中。文件3中的内容是按文件1和文件2的顺序排列的。</td>
</tr>
</tbody></table>
<h4 id="head"><a href="#head" class="headerlink" title="head"></a>head</h4><p>功能：查看文件开头部分的内容</p>
<p>格式：<code>head [数字选项] 文件名</code></p>
<p>数字选项及作用：</p>
<table>
<thead>
<tr>
<th>数字选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-3</td>
<td>显示文件前3行的内容</td>
</tr>
<tr>
<td>-n</td>
<td>显示文件前n行的内容</td>
</tr>
</tbody></table>
<p>说明：如果不指定数字选项，则默认只显示文件前10行。</p>
<h4 id="tail"><a href="#tail" class="headerlink" title="tail"></a>tail</h4><p>功能：查看文件结尾部分的内容</p>
<p>格式：<code>tail [数字选项] 文件名</code></p>
<p>数字选项及作用：</p>
<table>
<thead>
<tr>
<th>数字选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-3</td>
<td>显示文件末尾3行的内容</td>
</tr>
<tr>
<td>-n</td>
<td>显示文件末尾n行的内容</td>
</tr>
</tbody></table>
<p>说明：如果不指定数字选项，则默认只显示文件末尾10行的内容。</p>
<h4 id="more"><a href="#more" class="headerlink" title="more"></a>more</h4><p>功能：对文件内容或查询结果分屏显示</p>
<p>格式：<code>more [选项] 文件名</code></p>
<p>选项及作用：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-p</td>
<td>清屏，不滚屏</td>
</tr>
<tr>
<td>-s</td>
<td>把连续的空行压缩为一个空行</td>
</tr>
<tr>
<td>+n</td>
<td>从第n行开始显示</td>
</tr>
</tbody></table>
<h4 id="less"><a href="#less" class="headerlink" title="less"></a>less</h4><p>功能：对文件内容或查询结果分屏显示</p>
<p>格式：<code>less [选项] 文件名</code></p>
<h4 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h4><p>功能：在指定的文件中查找指定的字符串</p>
<p>格式：<code>grep [选项] 关键字 文件名</code></p>
<p>选项及作用：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-i</td>
<td>不区分大小写</td>
</tr>
</tbody></table>
<h5 id="规则表达式"><a href="#规则表达式" class="headerlink" title="规则表达式"></a>规则表达式</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">^    # 锚定行的开始 如：&#x27;^grep&#x27;匹配所有以grep开头的行。    </span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">   <span class="comment"># 锚定行的结束 如：&#x27;grep$&#x27; 匹配所有以grep结尾的行。</span></span></span><br><span class="line">.    # 匹配一个非换行符的字符 如：&#x27;gr.p&#x27;匹配gr后接一个任意字符，然后是p。    </span><br><span class="line">*    # 匹配零个或多个先前字符 如：&#x27;*grep&#x27;匹配所有一个或多个空格后紧跟grep的行。    </span><br><span class="line">.*   # 一起用代表任意字符。   </span><br><span class="line">[]   # 匹配一个指定范围内的字符，如&#x27;[Gg]rep&#x27;匹配Grep和grep。    </span><br><span class="line">[^]  # 匹配一个不在指定范围内的字符，如：&#x27;[^A-FH-Z]rep&#x27;匹配不包含A-R和T-Z的一个字母开头，紧跟rep的行。    </span><br><span class="line">\(..\)  # 标记匹配字符，如&#x27;\(love\)&#x27;，love被标记为1。    </span><br><span class="line">\&lt;      # 锚定单词的开始，如:&#x27;\&lt;grep&#x27;匹配包含以grep开头的单词的行。    </span><br><span class="line">\&gt;      # 锚定单词的结束，如&#x27;grep\&gt;&#x27;匹配包含以grep结尾的单词的行。    </span><br><span class="line">x\&#123;m\&#125;  # 重复字符x，m次，如：&#x27;0\&#123;5\&#125;&#x27;匹配包含5个o的行。    </span><br><span class="line">x\&#123;m,\&#125;   # 重复字符x,至少m次，如：&#x27;o\&#123;5,\&#125;&#x27;匹配至少有5个o的行。    </span><br><span class="line">x\&#123;m,n\&#125;  # 重复字符x，至少m次，不多于n次，如：&#x27;o\&#123;5,10\&#125;&#x27;匹配5--10个o的行。   </span><br><span class="line">\w    # 匹配文字和数字字符，也就是[A-Za-z0-9]，如：&#x27;G\w*p&#x27;匹配以G后跟零个或多个文字或数字字符，然后是p。   </span><br><span class="line">\W    # \w的反置形式，匹配一个或多个非单词字符，如点号句号等。   </span><br><span class="line">\b    # 单词锁定符，如: &#x27;\bgrep\b&#x27;只匹配grep。  </span><br></pre></td></tr></table></figure>



<h4 id="cp"><a href="#cp" class="headerlink" title="cp"></a>cp</h4><p>功能：进行文件的复制</p>
<p>格式：<code>cp [选项] 源文件 目标路径</code></p>
<p>选项及作用：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-i</td>
<td>以安全询问方式进行源文件的复制</td>
</tr>
<tr>
<td>-r</td>
<td>递归复制</td>
</tr>
<tr>
<td>-p</td>
<td>保留源文件或目录的属性</td>
</tr>
<tr>
<td>-a</td>
<td>递归复制，并保留源文件或目录的属性</td>
</tr>
</tbody></table>
<p>说明：该命令实现了把源文件复制到目标路径中，文件名不变。如果为目标路径下的文件名，则以文件的重命名方式实现文件的复制。目标路径可以是相对路径，也可以是绝对路径。</p>
<h4 id="rm"><a href="#rm" class="headerlink" title="rm"></a>rm</h4><p>功能：删除指定的文件</p>
<p>格式：<code>rm [选项] 文件名或目录名</code></p>
<p>选项及作用：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-i</td>
<td>以安全询问方式进行删除文件</td>
</tr>
<tr>
<td>-r</td>
<td>递归处理，将指定目录下的所有文件及子目录一并处理</td>
</tr>
<tr>
<td>-f</td>
<td>强制删除文件或目录</td>
</tr>
<tr>
<td>-v</td>
<td>显示指令执行过程</td>
</tr>
</tbody></table>
<h4 id="mv"><a href="#mv" class="headerlink" title="mv"></a>mv</h4><p>功能：移动指定的文件，可用于重命名文件</p>
<p>格式：<code>mv 文件名 路径名</code></p>
<h4 id="wc"><a href="#wc" class="headerlink" title="wc"></a>wc</h4><p>功能：统计文件的行数、单词数、字符数。</p>
<p>格式：<code>wc [选项] 文件名</code></p>
<p>选项及作用：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-l</td>
<td>显示文件的行数</td>
</tr>
<tr>
<td>-w</td>
<td>显示文件的单词数</td>
</tr>
<tr>
<td>-m</td>
<td>显示文件的字符数</td>
</tr>
</tbody></table>
<h4 id="file"><a href="#file" class="headerlink" title="file"></a>file</h4><p>功能：查看文件类型  （d文件夹，-文件，l软链接，c输入输出设备，b存储设备，p管道文件）</p>
<p>格式：<code>file 文件名</code></p>
<h4 id="stat"><a href="#stat" class="headerlink" title="stat"></a>stat</h4><p>功能：查看文件详细信息</p>
<p>格式：<code>stat 文件路径</code></p>
<h4 id="ln"><a href="#ln" class="headerlink" title="ln"></a>ln</h4><p>功能：创建链接</p>
<p>格式：硬链接：<code>ln 原始文件路径 快捷方式路径</code></p>
<p>​			软链接：<code>ln -s 原始文件路径 快捷方式路径</code></p>
<h4 id="sort"><a href="#sort" class="headerlink" title="sort"></a>sort</h4><p>功能：对文件内容或查询结果进行排序</p>
<p>格式：<code>sort [选项] 文件名</code></p>
<p>选项及作用：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-f</td>
<td>忽略大小写</td>
</tr>
<tr>
<td>-r</td>
<td>反向排序</td>
</tr>
<tr>
<td>-t</td>
<td>指定分隔符</td>
</tr>
<tr>
<td>-i</td>
<td>只考虑可以打印的字符，忽略任何非显示字符</td>
</tr>
</tbody></table>
<h4 id="find"><a href="#find" class="headerlink" title="find"></a>find</h4><p>功能：查找文件或目录</p>
<p>格式：<code>find 路径 选项 关键字</code></p>
<p>选项：</p>
<p>​	-name：按照文档名字进行搜索</p>
<p>​	-iname：忽略大小写按照文档名字进行搜索</p>
<p>​	-size：根据文件大小（-表示小于，+表示大于）</p>
<p>​	-type：按照文档类型进行搜索（-表示文件，d表示文件夹）</p>
<p><code>find 路径 选项 关键字 动作</code></p>
<p>动作：</p>
<p>​	-exec 命令：将找出的文件按照命令执行</p>
<p>​	-ok 命令：将找出的文件按照命令询问执行       命令后加{}表示find查找到的数据      然后必须以空格、反斜杠、					  分号结尾</p>
<p>​	-ls：将找出的文件详细信息列出</p>
<p>​	-delete：将找出的文件删除</p>
<h4 id="输出重定向"><a href="#输出重定向" class="headerlink" title="输出重定向"></a>输出重定向</h4><p>**”&gt;”**：覆盖输出，会覆盖原先文件的内容；1&gt;覆盖正确输出，会覆盖原先文件的内容；2&gt;覆盖错误输出，会覆盖原先文件的内容</p>
<p>**&amp;&gt;**：覆盖正确和错误输出，会覆盖原先文件的内容</p>
<p>**”&gt;&gt;”**：追加输出，在原先的文件末尾继续添加</p>
<p>格式：<code>查看文件指令 &gt; 文件（文件可以不存在，不存在会创建）</code></p>
<h4 id="echo"><a href="#echo" class="headerlink" title="echo"></a>echo</h4><p>功能：显示命令行中的字符串</p>
<p>格式：<code>echo [选项] [字符串]</code></p>
<p>选项及作用：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-n</td>
<td>输出字符串后，光标不换行</td>
</tr>
</tbody></table>
<h4 id="chmod"><a href="#chmod" class="headerlink" title="chmod"></a>chmod</h4><p>ls -l查看的信息的第一个十位字符含义：</p>
<p>​	第1位：文档类型（d文件夹，-文件，l软链接，c输入输出设备，b存储设备，p管道文件）</p>
<p>​	第2-4位：文档所有者的权限情况   （读：r -，-写：w -，执行：x -）（按照读、写、执行依次取值）</p>
<p>​	第5-7位：与所有者同在一个组的权限情况</p>
<p>​	第8-10位：其他用户的权限情况</p>
<p>功能：修改文件的权限和属性</p>
<p>格式： <code>chmod [&lt;文件使用者&gt;&lt;操作符号&gt;&lt;权限类型&gt;] 文件名1 文件名2...</code></p>
<p><strong>注：</strong>[&lt;文件使用者&gt;&lt;操作符号&gt;&lt;权限类型&gt;] 作为一个部分，中间不加空格。</p>
<ol>
<li><p>文件使用者有（ u、g、o、a） 4种类型，在使用时，可以采用其中的任何一个，也可以组合使用。</p>
<p>u：表示user（文件主），就是文件或目录的所有者</p>
<p>g：表示group（组群），文件主所在组群的用户</p>
<p>o：表示other，其他用户</p>
<p>a：表示all，所有用户</p>
</li>
<li><p>操作符号有3种类型，分别是 +、-、&#x3D;。</p>
<p>+：表示增加权限</p>
<p>-：表示删除或取消权限</p>
<p>&#x3D;：表示给文件使用者设定的权限</p>
</li>
<li><p>权限类型有3种基本类型，分别是r、w、x，-，这些类型可以组合使用。</p>
<p>r：代表可读权限</p>
<p>w：代表可写权限</p>
<p>x：代表可执行权限</p>
<p>-：表示没有相对应的权限</p>
</li>
</ol>
<p>选项及作用：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>a+rw</td>
<td>为所有用户增加可读、可写的权限</td>
</tr>
<tr>
<td>g+w</td>
<td>为组群用户加可写权限</td>
</tr>
<tr>
<td>a-rwx</td>
<td>取消所有用户可读、可写、可执行权限</td>
</tr>
<tr>
<td>o-rwx</td>
<td>取消其他用户可读、可写、可执行权限</td>
</tr>
<tr>
<td>a+rw</td>
<td>为所有用户加读、写的权限</td>
</tr>
<tr>
<td>ug+r</td>
<td>为所有者和组群用户增加读权限</td>
</tr>
<tr>
<td>g&#x3D;rx</td>
<td>只允许组群用户可读、可执行，并删除其他权限</td>
</tr>
<tr>
<td>自定义</td>
<td>可以根据实际需要进行组合</td>
</tr>
</tbody></table>
<p>其他格式：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod [mode] 文件名</span><br></pre></td></tr></table></figure>

<p>mode是指 3个 0~7 范围的八进制数值，分别代表user、group、other 的权限，并且按照文件所有者，文件所有者所在群组的用户，其他人的顺序</p>
<p>权限也可以用数字来表示：0表示没有权限，1表示可执行权限，2表示可写权限，4表示可读权限。</p>
<p><strong>举例1：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod a=rwx filename</span><br><span class="line">chmod 777 filename</span><br></pre></td></tr></table></figure>

<p>对以上的两个例子分析：</p>
<p>a&#x3D;rwx表示允许所有用户可读、可写、可执行。</p>
<p>777指三个八进制数值，即第一个数字“7”指允许user的可读、可写、可执行，第二个数字“7”指允许group的可读、可写、可执行，第三个数字“7”指允许other的可读、可写、可执行。</p>
<p>rwx权限&#x3D;4+2+1&#x3D;7（可读、可写、可执行）</p>
<p>rw权限&#x3D;4+2&#x3D;6（可读、可写）</p>
<p>rx权限&#x3D;4+1&#x3D;5（可读、可执行）</p>
<p><strong>举例2：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod ug=rwx,o=x filename</span><br><span class="line">chmod 771 filename</span><br></pre></td></tr></table></figure>

<ol>
<li><p>冒险位</p>
</li>
<li><p>强制位</p>
</li>
<li><p>粘滞位：公共目录中只能创建者和root你让那个删除文件（x位变为t）</p>
<p>chmod o+t 路径：添加粘滞位</p>
</li>
<li><p>默认权限：目录的默认权限最大为0777，文件的额默认权限最大为0666</p>
<ol>
<li><p>临时修改默认权限：用户名 umask 四位数     （目录默认权限&#x3D;0777-umask；文件默认权限&#x3D;0666-umask【文件默认没有x权限，如果算出来有x权限，权限进行加1，变成读或写权限】）</p>
</li>
<li><p>永久控制默认权限：</p>
<p>全部用户生效：vim &#x2F;etc&#x2F;bashrc配置文件最后添加umask 四位数字</p>
<p>某个用户生效：vim ~&#x2F;.bashrc配置文件最后添加umask 四位数字</p>
</li>
</ol>
</li>
<li><p>ACL策略：对某个文件添加权限（ll后权限字段有+）</p>
<ol>
<li>给文件添加用户权限：setfacl -m u:用户名:权限(rwx) 文件名</li>
<li>给文件添加用户组权限：setfacl -m g:用户组名:权限(rwx) 文件名</li>
<li>查看文件的ACL策略：getfacl 文件名</li>
<li>删除文件的所有ACL策略：setfacl -b 文件名</li>
</ol>
</li>
</ol>
<h4 id="setfacl"><a href="#setfacl" class="headerlink" title="setfacl"></a>setfacl</h4><p>功能：设置文件权限</p>
<p>格式： </p>
<ol>
<li><p>给某个用户添加权限：<code>setfacl -m u:用户:rwx 文件</code></p>
<ol start="2">
<li>给某个用户组添加权限：<code>setfacl -m g:用户组:rwx 文件</code></li>
<li>删除某个用户添加权限：<code>setfacl -x u:用户:rwx 文件</code></li>
<li>删除某个用户组添加权限：<code>setfacl -x g:用户组:rwx 文件</code></li>
</ol>
</li>
</ol>
<p><strong>getfacl 文件</strong>：查看文件的权限</p>
<h4 id="vim"><a href="#vim" class="headerlink" title="vim"></a>vim</h4><p>功能：编辑文件</p>
<p>格式：<code>vim 文件路径</code></p>
<p>​			<code>	vim 文件路径1 文件路径2</code></p>
<p>打开文件并将光标移动到指定行：<code>vim +数字 文件路径</code></p>
<p>打开文件并将高亮显示关键词：<code>vim +/关键词 文件路径</code></p>
<h5 id="三种模式"><a href="#三种模式" class="headerlink" title="三种模式"></a>三种模式</h5><ol>
<li><p><strong>命令模式</strong>：在该模式下是不能对文件直接编辑，可以输入快捷键进行删除行，复制行，移动光标，粘贴等操作（打开文件默认进入）</p>
<ol>
<li>光标的移动：<ol>
<li>光标移动到行首：shift+6或^</li>
<li>光标移动到行尾：shift+4或$</li>
<li>光标移动到首行：gg</li>
<li>光标移动到末行：G</li>
<li>光标移动到指定行：数字G</li>
<li>以当前光标为基准移动指定行：数字上键&#x2F;下键&#x2F;左键&#x2F;右键</li>
<li>向上翻屏：ctrl+b</li>
<li>向下翻屏：ctrl+f</li>
</ol>
</li>
<li>复制操作<ol>
<li>复制光标所在行：yy</li>
<li>以光标为准向下复制n行：nyy</li>
<li>可视化复制：ctrl+v，按上下左右选中，再按yy键复制</li>
</ol>
</li>
<li>剪切&#x2F;删除<ol>
<li>剪切&#x2F;删除光标所在行：dd</li>
<li>以光标为准向下剪切&#x2F;删除n行：ndd</li>
<li>剪切&#x2F;删除光标所在行，但下一行不向上移动：D</li>
</ol>
</li>
<li>粘贴：在想要粘贴的地方按p键</li>
<li>撤销&#x2F;恢复<ol>
<li>撤销：输入：u 或u</li>
<li>恢复：ctrl+r，恢复之前的撤销操作</li>
</ol>
</li>
</ol>
</li>
<li><p><strong>编辑模式</strong>：在该模式下可以对文件的内容进行编辑  i或a进入编辑模式</p>
</li>
<li><p><strong>末行模式</strong>：可以在末行输入命令对文件进行操作（替换，保存，搜索，退出，撤销，高亮等）</p>
<p>在命令模式按：或&#x2F;进入末行模式</p>
<ol>
<li>保存文件：：w</li>
<li>另存文件：：w  路径</li>
<li>退出：：q</li>
<li>保存并退出：：wq 或：x(修改则保存退出，不修改则原样退出)</li>
<li>强制退出：：q！</li>
<li>搜索&#x2F;查找：&#x2F;关键词（结果上下切换N&#x2F;n）</li>
<li>取消高亮：：nohl</li>
<li>替换光标所在行的第一处：：s&#x2F;搜索的关键词&#x2F;替换的内容</li>
<li>替换光标所在行的全部符合内容：：s&#x2F;搜索的关键词&#x2F;替换的内容&#x2F;g</li>
<li>替换每行的第一个符合内容：：%s&#x2F;搜索的关键词&#x2F;替换的内容</li>
<li>替换文档的全部符合内容：：%s&#x2F;搜索的关键词&#x2F;替换的内容&#x2F;g</li>
<li>显示行号：set nu     取消行号：set nonu</li>
<li>同时打开多个文件时切换打开的文件：<ol>
<li>查看当前已经打开的文件名称：：files</li>
<li>切换文件：：open 文件名称           切换下一个文件：：bn      切换上一个文件：：bp</li>
</ol>
</li>
<li>代码着色：syntax on     不显示：syntax off</li>
</ol>
</li>
</ol>
<h5 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h5><p><strong>针对同一个配置项，若个人配置文件有该项，则以个人配置文件为准</strong></p>
<ol>
<li>个人配置文件~&#x2F;.vimrc<ol>
<li>没有该文件，可以进行新建   .vimrc</li>
</ol>
</li>
<li>全局配置文件（vim自带）</li>
</ol>
<h5 id="异常退出"><a href="#异常退出" class="headerlink" title="异常退出"></a>异常退出</h5><p>将交换文件删除：rm -f .passwd.swp</p>
<h3 id="系统管理"><a href="#系统管理" class="headerlink" title="系统管理"></a>系统管理</h3><h4 id="rpm"><a href="#rpm" class="headerlink" title="rpm"></a>rpm</h4><p>需要下载好rpm包到本地</p>
<p>获取rpm包，RedHat&#x2F;CentOS光盘；<a target="_blank" rel="noopener" href="http://www.pbone.net;相应软件官方下载/">www.pbone.net；相应软件官方下载</a></p>
<p>命令：</p>
<ol>
<li><p>查询：rpm -q 软件名：查询软件的安装情况</p>
<p>​			rpm -ql 软件名：查询软件的安装列表</p>
</li>
<li><p>卸载：rpm -e 软件名</p>
</li>
<li><p>卸载有依赖关系的软件：rpm -e 软件名 –nodeps</p>
</li>
<li><p>安装：rpm -ivh 软件包完整名称</p>
</li>
<li><p>升级：rpm -Uvh 软件包（没安装，会自动安装）或rpm -Fvh 软件包</p>
</li>
</ol>
<h4 id="yum-x2F-dnf"><a href="#yum-x2F-dnf" class="headerlink" title="yum&#x2F;dnf"></a>yum&#x2F;dnf</h4><p>需要配置软件仓库</p>
<ol>
<li>配置本地仓库<ol>
<li>挂载镜像：mount -o ro &#x2F;dev&#x2F;sr0 &#x2F;media</li>
<li>配置.repo的文件</li>
</ol>
</li>
<li>配置网络仓库</li>
</ol>
<p>命令：</p>
<ol>
<li>清空缓存：yum clear all</li>
<li>创建yum缓存：yum makecache</li>
<li>查看仓库：yum repolist</li>
<li>查看仓库软件包：yum list</li>
<li>安装软件包：dnf install 软件包名</li>
<li>卸载：dnf -y remove 软件包</li>
<li>升级：dnf update 软件包</li>
</ol>
<h4 id="systemctl"><a href="#systemctl" class="headerlink" title="systemctl"></a>systemctl</h4><p><strong>systemctl命令</strong> 是系统服务管理器指令，它实际上将 service 和 chkconfig 这两个命令组合到一起。</p>
<table>
<thead>
<tr>
<th>任务</th>
<th>旧指令</th>
<th>新指令</th>
</tr>
</thead>
<tbody><tr>
<td>使某服务自动启动</td>
<td>chkconfig –level 3 httpd on</td>
<td>systemctl <strong>enable</strong> httpd.service</td>
</tr>
<tr>
<td>使某服务不自动启动</td>
<td>chkconfig –level 3 httpd off</td>
<td>systemctl <strong>disable</strong> httpd.service</td>
</tr>
<tr>
<td>检查服务状态</td>
<td>service httpd status</td>
<td>systemctl <strong>status</strong> httpd.service （服务详细信息）                       systemctl is-active httpd.service （仅显示是否 Active)</td>
</tr>
<tr>
<td>显示所有已启动的服务</td>
<td>chkconfig –list</td>
<td>systemctl list-units –type&#x3D;service</td>
</tr>
<tr>
<td>启动服务</td>
<td>service httpd start</td>
<td>systemctl <strong>start</strong> httpd.service</td>
</tr>
<tr>
<td>停止服务</td>
<td>service httpd stop</td>
<td>systemctl <strong>stop</strong> httpd.service</td>
</tr>
<tr>
<td>重启服务</td>
<td>service httpd restart</td>
<td>systemctl <strong>restart</strong> httpd.service</td>
</tr>
<tr>
<td>重载服务</td>
<td>service httpd reload</td>
<td>systemctl <strong>reload</strong> httpd.service</td>
</tr>
</tbody></table>
<h4 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h4><p>功能：查看服务器进程信息</p>
<p>格式：<code>ps -ef</code></p>
<p>​	-e：表示列出全部的进程</p>
<p>​	-f：显示全部的列</p>
<p>查看某个进程的信息：<code>ps -ef | grep 进程路径名</code></p>
<h4 id="top"><a href="#top" class="headerlink" title="top"></a>top</h4><p>功能：查看进程资源</p>
<p>top：查看服务器的进程占的资源（Q键退出）</p>
<h4 id="kill"><a href="#kill" class="headerlink" title="kill"></a>kill</h4><p>功能：杀死进程</p>
<p>格式：<code>kill 进程PID</code>或<code>killall 进程名称</code></p>
<h4 id="reboot"><a href="#reboot" class="headerlink" title="reboot"></a>reboot</h4><p>功能：重启计算机</p>
<p>格式：<code>reboot</code></p>
<p>模拟重启，但不重启：<code>reboot -w</code></p>
<h4 id="shutdown"><a href="#shutdown" class="headerlink" title="shutdown"></a>shutdown</h4><p>shutdown -h now：现在关机</p>
<p>shutdown -h 10：10分钟后关机</p>
<p>shutdown -r now：现在重启</p>
<p>shutdown -r 10：10分钟后重启</p>
<p>shutdown -c：取消关机、重启</p>
<h4 id="uname"><a href="#uname" class="headerlink" title="uname"></a>uname</h4><p>功能：获取操作系统信息</p>
<p>​	uname -a：获取操作系统的详细信息</p>
<h4 id="运行级别"><a href="#运行级别" class="headerlink" title="运行级别"></a>运行级别</h4><p>&#x2F;etc&#x2F;inittab：运行级别配置文件</p>
<h4 id="at"><a href="#at" class="headerlink" title="at"></a>at</h4><p>功能：创建计划任务</p>
<p>格式：<code>at 选项 时间 </code>   ctrl+D退出</p>
<p>时间：<code>now + count time-units</code>，now就是当前时间，time-units是时间单位，这里能够是minutes（分钟）、hours（小时）、days（天）、weeks（星期）。count是时间的数量，究竟是几天，还是几小时，等等。 更有一种计时方法就是直接使用today（今天）、tomorrow（明天）来指定完成命令的时间</p>
<p>选项</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-f：指定包含具体指令的任务文件；</span><br><span class="line">-q：指定新任务的队列名称；</span><br><span class="line">-l：显示待执行任务的列表；</span><br><span class="line">-d：删除指定的待执行任务；</span><br><span class="line">-m：任务执行完成后向用户发送E-mail。</span><br></pre></td></tr></table></figure>

<h4 id="crond"><a href="#crond" class="headerlink" title="crond"></a>crond</h4><p>功能：设定计划任务</p>
<p>-u user 是指设定指定 user 的时程表，这个前提是你必须要有其权限(比如说是 root)才能够指定他人的时程表g</p>
<p>格式：<code>crontab 选项</code></p>
<p>常用选项： -l：列出指定用户的计划任务列表</p>
<p>​					-e：编辑指定用户的计划任务列表</p>
<p>编辑计划任务的语法规则：</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">描述</th>
<th align="left">允许的值</th>
</tr>
</thead>
<tbody><tr>
<td align="left">分钟</td>
<td align="left">一小时的第几分</td>
<td align="left">0-59</td>
</tr>
<tr>
<td align="left">小时</td>
<td align="left">一天的第几小时</td>
<td align="left">0-23</td>
</tr>
<tr>
<td align="left">日期</td>
<td align="left">一个月的的第几天</td>
<td align="left">1-31</td>
</tr>
<tr>
<td align="left">月份</td>
<td align="left">一年的第几个月</td>
<td align="left">1-12</td>
</tr>
<tr>
<td align="left">周几</td>
<td align="left">一周的第几天</td>
<td align="left">0-6</td>
</tr>
<tr>
<td align="left">命令</td>
<td align="left">命令</td>
<td align="left">可以被执行的任何命令</td>
</tr>
</tbody></table>
<p>​	分(0<del>23) 时(0</del>59) 日(1<del>31) 月(1</del>12) 周(0~7) 操作</p>
<p>*：表示取每个数字</p>
<p>-：表示取连续的区间（比如1-6）</p>
<p>&#x2F;：表示每多少个（比如每十分钟一次可以在分的位置写*&#x2F;10）</p>
<p>，：表示多个取值</p>
<p>管理用户不能设置计划任务：&#x2F;etc&#x2F;cron.deny</p>
<p>管理用户设置计划任务白名单：&#x2F;etc&#x2F;cron.allow</p>
<h3 id="磁盘管理"><a href="#磁盘管理" class="headerlink" title="磁盘管理"></a>磁盘管理</h3><h4 id="df"><a href="#df" class="headerlink" title="df"></a>df</h4><p>功能：查看当前硬盘的分区信息</p>
<p>格式：<code>df [选项]</code></p>
<p>选项及作用：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-a</td>
<td>显示每个文件系统和各分区的磁盘使用情况</td>
</tr>
<tr>
<td>-i</td>
<td>显示i节点的使用量</td>
</tr>
<tr>
<td>-k</td>
<td>以千字节（KB）的方式显示分区大小和挂上来的文件分区大小</td>
</tr>
<tr>
<td>-h</td>
<td>以兆字节（MB）的方式显示分区大小和挂上来的文件分区大小</td>
</tr>
<tr>
<td>-t</td>
<td>列出某个文件系统的所有分区磁盘空间使用量</td>
</tr>
</tbody></table>
<h4 id="du"><a href="#du" class="headerlink" title="du"></a>du</h4><p>功能：查看当前目录下所有文件及目录信息</p>
<p>格式：<code>du [选项]</code></p>
<p>选项及作用：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-a</td>
<td>显示所有文件及目录的大小</td>
</tr>
<tr>
<td>-h</td>
<td>以兆字节（MB）或吉字节（GB）为单位显示文件或目录的大小</td>
</tr>
<tr>
<td>-b</td>
<td>以字节（B）为单位显示文件或目录的大小</td>
</tr>
<tr>
<td>-s</td>
<td>列出各文件大小的总和</td>
</tr>
</tbody></table>
<h4 id="fsck"><a href="#fsck" class="headerlink" title="fsck"></a>fsck</h4><p>功能：对硬盘进行检测</p>
<p>格式：<code>fsck 分区名</code></p>
<h4 id="free"><a href="#free" class="headerlink" title="free"></a>free</h4><p>功能：查看内存</p>
<p>格式：<code>free -m</code></p>
<p>​	-m单位为mb</p>
<h3 id="时间管理"><a href="#时间管理" class="headerlink" title="时间管理"></a>时间管理</h3><h4 id="uptime"><a href="#uptime" class="headerlink" title="uptime"></a>uptime</h4><p>uptime：输出计算机持续在线时间</p>
<h4 id="date"><a href="#date" class="headerlink" title="date"></a>date</h4><ol>
<li><p>date：读取时间</p>
</li>
<li><p>date +%F：读取时间，年月日</p>
</li>
<li><p>date “+%F %T”：读取时间，年月日时分秒</p>
</li>
<li><p>date -d “-1 day” “+%Y-%m-%d %H:%M:%S”：输出一天前的时间</p>
</li>
</ol>
<h4 id="cal"><a href="#cal" class="headerlink" title="cal"></a>cal</h4><p>功能：查看日历</p>
<p>格式：<code>cal [选项] [月] [年]</code></p>
<p>选项:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-l # 显示单月输出；</span><br><span class="line">-3 # 显示临近三个月的日历；</span><br><span class="line">-s # 将星期日作为月的第一天；</span><br><span class="line">-m # 显示星期一作为一周的第一天..  (缺省为星期日.)</span><br><span class="line">-j # 显示儒略历的(Julian)日期 (以 1 为基的天数, 从 1 月 1 日开始计数) .</span><br><span class="line">-y # 显示当前年份的日历..</span><br></pre></td></tr></table></figure>



<h4 id="ntpdate"><a href="#ntpdate" class="headerlink" title="ntpdate"></a>ntpdate</h4><p>功能：使用网络计时协议（NTP）设置日期和时间</p>
<p>格式：<code>ntpdate [选项]</code></p>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-aKeyid</td>
<td>使用 Keyid 来认证全部数据包。</td>
</tr>
<tr>
<td>-b</td>
<td>通过调用 settimeofday 子例程来增加时钟的时间。</td>
</tr>
<tr>
<td>-d</td>
<td>指定调试方式。判断 ntpdate 命令会产生什么结果（不产生实际的结果）。结果再现在屏幕上。这个标志使用无特权的端口。</td>
</tr>
<tr>
<td>-eAuthenticationDelay</td>
<td>指定延迟认证处理的时间秒数。</td>
</tr>
<tr>
<td>-kKeyFile</td>
<td>当不使用缺省值 &#x2F;etc&#x2F;ntp.keys 文件时，为包含密钥的文件指定一个不同的名称。 请参阅文件KeyFile的描述。</td>
</tr>
<tr>
<td>-oVersion</td>
<td>当轮询它的发出数据包时，指定使用的 NTP 版本实现。 Version 的值可以是 1，2，3。缺省值是 3。</td>
</tr>
<tr>
<td>-pSamples</td>
<td>指定从每个服务器获取的样本的数目。 Samples 的值在 1 和 8 之间，并包括 1 和 8。它的缺省值是 4。</td>
</tr>
<tr>
<td>-s</td>
<td>指定日志操作 syslog 设施的使用，而不是使用标准输出。 当运行 ntpdate 命令和 cron命令时，它是很有用的。</td>
</tr>
<tr>
<td>-tTimeOut</td>
<td>指定等待响应的时间。给定 TimeOut 的值四舍五入为 0.2 秒的倍数。缺省值是 1 秒。</td>
</tr>
<tr>
<td>-u</td>
<td>指定使用无特权的端口发送数据包。 当在一个对特权端口的输入流量进行阻拦的防火墙后是很有益的， 并希望在防火墙之外和主机同步。防火墙是一个系统或者计算机，它控制从外网对专用网的访问。</td>
</tr>
</tbody></table>
<p>启动时间同步服务：systemctl start chronyd</p>
<h3 id="用户管理"><a href="#用户管理" class="headerlink" title="用户管理"></a>用户管理</h3><h4 id="hostname"><a href="#hostname" class="headerlink" title="hostname"></a>hostname</h4><p>功能：查看完整的主机名</p>
<p>格式：<code>hostname</code></p>
<p>​	-f：输出当前主机名中的FQDN（全限定域名）</p>
<p>设置主机名：<code>hostnamectl set-hostname 主机名</code></p>
<h4 id="id"><a href="#id" class="headerlink" title="id"></a>id</h4><p>功能：显示用户信息，默认显示当前用户的的信息</p>
<p>格式：<code>id [用户名]</code></p>
<h4 id="whoami"><a href="#whoami" class="headerlink" title="whoami"></a>whoami</h4><p>whoami：显示当前登录的用户名</p>
<h4 id="用户和用户组管理"><a href="#用户和用户组管理" class="headerlink" title="用户和用户组管理"></a>用户和用户组管理</h4><p>&#x2F;etc&#x2F;passwd：存储用户的关键信息      用户名：密码：用户id：用户主组id：注释：家目录：解释器shell</p>
<p>&#x2F;etc&#x2F;group：存储用户组的关键信息      用户名：密码：用户组id：组内用户名</p>
<p>&#x2F;etc&#x2F;shadow：存储用户密码的关键信息</p>
<h5 id="用户管理-1"><a href="#用户管理-1" class="headerlink" title="用户管理"></a>用户管理</h5><ol>
<li><p><strong>添加用户</strong>：useradd [选项] 用户名</p>
<p>选项： -g：指定用户的用户主组（用户主组名或id）</p>
<p>​			-G：指定用户的的附加组（用户附加组名或id）</p>
<p>​			-u：自定义用户的uid</p>
<p>​			-s：修改shell，不能登录</p>
<p>​			-d：家目录</p>
<p>​			-c：添加用户注释</p>
</li>
<li><p><strong>设置密码</strong>：passwd 用户名        <strong>修改用户密码</strong>：chage -d 0：下次登录时必须设置密码</p>
</li>
<li><p><strong>修改用户</strong>：usermod 选项 用户名</p>
<p>选项： -g：指定用户的用户主组（用户主组名或id）</p>
<p>​			-G：指定用户的的附加组（用户附加组名或id）</p>
<p>​			-u：自定义用户的uid</p>
<p>​			-l：修改用户名</p>
</li>
<li><p><strong>删除用户</strong>：userdel [选项] 用户名</p>
<p>选项：-r：删除用户的同时，删除家目录</p>
</li>
<li><p><strong>切换用户</strong>：su 用户名</p>
</li>
</ol>
<h5 id="用户组管理"><a href="#用户组管理" class="headerlink" title="用户组管理"></a>用户组管理</h5><ol>
<li><p><strong>添加用户组</strong>：groupadd [选项] 用户组名</p>
<p>选项： -g：自定义用户组的id</p>
</li>
<li><p><strong>设置用户组密码</strong>：gpasswd 组名</p>
</li>
<li><p><strong>修改用户组</strong>：groupmod 选项 用户组名</p>
<p>选项： -g：自定义用户组的id</p>
<p>​			-u：修改用户组的名称</p>
</li>
<li><p><strong>删除用户组</strong>：groupdel 用户组名</p>
<p>当该组是某个组的主组时，不允许删除</p>
</li>
<li><p><strong>管理组成员</strong>：gpasswd 选项  用户 组名</p>
<p>选项：-a：添加用户到组</p>
<p>​			-d：从组中删除成员</p>
<p>​			-M：指定组的成员</p>
<p>​			-A：指定管理员</p>
<p>​			-r：删除组密码</p>
</li>
</ol>
<h5 id="修改文档所属的用户和用户组-当要删除用户时，就要更改文档对应的属主和属组信息"><a href="#修改文档所属的用户和用户组-当要删除用户时，就要更改文档对应的属主和属组信息" class="headerlink" title="修改文档所属的用户和用户组    当要删除用户时，就要更改文档对应的属主和属组信息"></a>修改文档所属的用户和用户组    当要删除用户时，就要更改文档对应的属主和属组信息</h5><p><strong>chown 用户名: 文档路径</strong>：修改文件的属主</p>
<p><strong>chown 用户名:用户组名 文档路径</strong>：修改文件的属主和属组</p>
<p><strong>chgrp 用户组名 文档路径</strong>：修改文件的属组</p>
<h3 id="解压缩"><a href="#解压缩" class="headerlink" title="解压缩"></a>解压缩</h3><h4 id="bzip2"><a href="#bzip2" class="headerlink" title="bzip2"></a>bzip2</h4><p>功能：压缩文件</p>
<p>格式：<code>bzip2 文件名1 [文件名2]...</code></p>
<p>说明：使用该命令对文件进行压缩后，压缩前的原始文件消失，系统会生成一个新的压缩文件，压缩文件的后缀为.bz2。而且，使用该命令压缩的文件，必须用bunzip2来进行解压操作。</p>
<h5 id="bunzip2"><a href="#bunzip2" class="headerlink" title="bunzip2"></a>bunzip2</h5><p>功能：解压文件</p>
<p>格式：<code>bunzip2 文件名1 [文件名2]...</code></p>
<h4 id="gzip"><a href="#gzip" class="headerlink" title="gzip"></a>gzip</h4><p>功能：压缩或解压文件</p>
<p>格式：<code>gzip [选项] 文件名</code></p>
<p>选项及作用：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-d</td>
<td>解压操作</td>
</tr>
<tr>
<td>-n</td>
<td>指定压缩级别，n的范围是1~9</td>
</tr>
</tbody></table>
<h5 id="unzip"><a href="#unzip" class="headerlink" title="unzip"></a>unzip</h5><p>功能：解压以.zip为后缀的压缩文件</p>
<p>格式：<code>unzip [选项] 文件名.zip</code></p>
<p>选项及作用：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-d</td>
<td>将文件解压到指定目录中</td>
</tr>
<tr>
<td>-n</td>
<td>不覆盖原来已存在的文件</td>
</tr>
<tr>
<td>-v</td>
<td>查看文件目录列表但不解压</td>
</tr>
<tr>
<td>-o</td>
<td>已默认方式覆盖已存在的文件</td>
</tr>
</tbody></table>
<p>举例： <code>unzip -n filename.zip -d /home/ubuntu</code>将文件filename.zip解压到&#x2F;home&#x2F;ubuntu目录中。</p>
<h4 id="zcat和bzcat"><a href="#zcat和bzcat" class="headerlink" title="zcat和bzcat"></a>zcat和bzcat</h4><p>功能：这两个都是用来查看压缩文件内容的，压缩文件不用解压也能查看。</p>
<p>格式：<code>zcat 文件名</code>或<code>bzcat 文件名</code></p>
<h4 id="tar"><a href="#tar" class="headerlink" title="tar"></a>tar</h4><p>功能：对文件或目录进行打包或解包操作</p>
<p>格式：<code>tar [选项] [备份包的文件名] [要打包或解包的文件或目录]</code></p>
<p>选项及作用：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>-c</td>
<td>创建新的打包文件</td>
</tr>
<tr>
<td>-t</td>
<td>查看打包文件里的文件目录</td>
</tr>
<tr>
<td>-f</td>
<td>使用文件或设备</td>
</tr>
<tr>
<td>-v</td>
<td>显示打包压缩或解包压缩后的文件的详细清单</td>
</tr>
<tr>
<td>-x</td>
<td>抽取.tar文件的内容</td>
</tr>
<tr>
<td>-z</td>
<td>打包后直接用gzip命令进行压缩或解压文件</td>
</tr>
<tr>
<td>-j</td>
<td>打包后直接用bzip2命令进行压缩或解压文件</td>
</tr>
</tbody></table>
<p>常用：</p>
<p>​	tar –czvf jpg.tar *.jpg &#x2F;&#x2F;将目录里所有jpg文件打包成tar.jpg</p>
<p>​	tar -xzvf file.tar.gz &#x2F;&#x2F;解压tar.g</p>
<h3 id="网络管理"><a href="#网络管理" class="headerlink" title="网络管理"></a>网络管理</h3><h4 id="ifconfig"><a href="#ifconfig" class="headerlink" title="ifconfig"></a>ifconfig</h4><p>ifconfig：获取网卡信息</p>
<h4 id="netstat"><a href="#netstat" class="headerlink" title="netstat"></a>netstat</h4><p>netstat -hnlp：查看网络的连接状态</p>
<p>​	-t：表示只列出tcp协议的连接</p>
<p>​	-n：将地址从字母组合转化成ip地址，将协议转化成端口号表示</p>
<p>​	-l：过滤出“state”状态列中其值为LISTEN（监听）的连接</p>
<p>​	-p：显示发起连接的进程PID和进程名称</p>
<p>​	-a：全部网络的连接信息</p>
<h4 id="ping"><a href="#ping" class="headerlink" title="ping"></a>ping</h4><p>功能：检测当前主机与目标主机是否联通</p>
<p>格式：<code>ping 主机id</code></p>
<h4 id="traceroute-主机地址"><a href="#traceroute-主机地址" class="headerlink" title="traceroute 主机地址"></a>traceroute 主机地址</h4><p>功能：查找当前主机与目标主机之间的网关，会沿途给各个路由器发送ICMP数据包（需要安装）</p>
<p>格式：<code>traceroute 主机地址</code></p>
<p>在线查询工具：<a target="_blank" rel="noopener" href="http://tool.chinaz.com/">http://tool.chinaz.com</a></p>
<h4 id="arp-a"><a href="#arp-a" class="headerlink" title="arp -a"></a>arp -a</h4><p>功能：根据ip地址获取物理地址</p>
<h4 id="tcpdump"><a href="#tcpdump" class="headerlink" title="tcpdump"></a>tcpdump</h4><p>功能：抓包</p>
<p>格式：<code>tcpdump 协议 port端口</code></p>
<h4 id="配置静态ip"><a href="#配置静态ip" class="headerlink" title="配置静态ip"></a>配置静态ip</h4><ol>
<li><p>修改&#x2F;etc&#x2F;sysconfig&#x2F;network-scriptsifcfg-ens160文件； </p>
<p>重写加载配置文件：nmcli connection reload ens160；</p>
<p>激活网卡：nmcli connection up ens160</p>
</li>
<li><p>nmcli命令</p>
</li>
<li><p>nmtui图形界面</p>
</li>
</ol>
<h4 id="SSH服务"><a href="#SSH服务" class="headerlink" title="SSH服务"></a>SSH服务</h4><p>ssh：安全外壳协议，用于远程连接，文件传输，默认端口22</p>
<p>安装openssh-server软件</p>
<p>ssh配置文件：&#x2F;etc&#x2F;ssh&#x2F;sshd_config</p>
<p>启动&#x2F;停止&#x2F;重启ssh服务：systemctl  start sshd.service</p>
<ol>
<li>linux下安装openssh-clients软件，远程连接linux服务器；<ol>
<li>登录服务器：ssh -p 端口号 -l 用户名 ip地址</li>
<li>执行命令：ssh -p 端口号哦 -l 用户名 IP地址 命令</li>
<li>本地文件拷贝到远端：scp -P 端口号 [-r] 本地文件 id地址:远端路径</li>
<li>远端文件拷贝到本地：scp -P 端口号 用户名@id地址:&#x2F;文件 本地路径</li>
</ol>
</li>
</ol>
<h4 id="防火墙"><a href="#防火墙" class="headerlink" title="防火墙"></a>防火墙</h4><p>CentOS8中防火墙是：firewalld</p>
<p>防火墙的启动&#x2F;停止&#x2F;重启&#x2F;查看：systemctl start&#x2F;stop&#x2F;restart&#x2F; status firewalld.service</p>
<p>开启防火墙22端口：firewall-cmd –add-port&#x3D;5672&#x2F;tcp –permanent</p>
<p>firewall-cmd –list-ports		&#x2F;&#x2F;查看已经放行的所有端口</p>
<p>firewall-cmd –reload		&#x2F;&#x2F;让③中有permanent（永久生效）需重新加载</p>
<h3 id="设备管理"><a href="#设备管理" class="headerlink" title="设备管理"></a>设备管理</h3><h4 id="mount"><a href="#mount" class="headerlink" title="mount"></a>mount</h4><p>功能：挂在物理设备</p>
<p>格式：<code>mount设备原始地址 要挂在的路径</code></p>
<h4 id="umount"><a href="#umount" class="headerlink" title="umount"></a>umount</h4><p>功能：解挂物理设备</p>
<p>格式：<code>umount 当前设备挂载的路径</code></p>
<h2 id="Shell"><a href="#Shell" class="headerlink" title="Shell"></a>Shell</h2><h3 id="编写规范"><a href="#编写规范" class="headerlink" title="编写规范"></a>编写规范</h3><ol>
<li><p>代码规范：</p>
<p>​					#!&#x2F;bin&#x2F;base（首行必须编写）</p>
<p>​					Shell相关指令</p>
</li>
<li><p>文件命名规范：文件名.sh</p>
</li>
</ol>
<h3 id="使用流程"><a href="#使用流程" class="headerlink" title="使用流程"></a>使用流程</h3><ol>
<li>创建.sh文件</li>
<li>编写shell代码</li>
<li>执行shell脚本（必须得有执行权限）</li>
</ol>
<h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><ol>
<li>定义：变量名&#x3D;变量值（&#x3D;左右不能有空格）变量值为指令时，需要使用&#96;&#96;括起来(tab上边的反引号)</li>
<li>使用：$变量名</li>
<li>只读变量：readonly 变量名    在一个变量复制之后再使用</li>
<li>接收用户输入：read -p 提示信息 变量名</li>
<li>删除变量：unset 变量名</li>
</ol>
<h3 id="条件判断语句"><a href="#条件判断语句" class="headerlink" title="条件判断语句"></a>条件判断语句</h3><p>if 条件</p>
<p>then</p>
<p>​	语句</p>
<p>elif 条件</p>
<p>then </p>
<p>​	语句</p>
<p>else</p>
<p>​	语句</p>
<p>fi</p>
<h3 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h3><p>expr 数字 运算符 数字</p>
<h2 id="web控制台"><a href="#web控制台" class="headerlink" title="web控制台"></a>web控制台</h2><ol>
<li>启动cockpit.service服务</li>
<li>登录：通过ip地址:9090登录</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/11/13/Linux8/" data-id="cl3u71bjx000b380l4r5j7enj" data-title="Linux8" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Maven" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/30/Maven/" class="article-date">
  <time class="dt-published" datetime="2021-01-30T05:47:47.000Z" itemprop="datePublished">2021-01-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/30/Maven/">Maven</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Maven"><a href="#Maven" class="headerlink" title="Maven"></a>Maven</h1><p><a target="_blank" rel="noopener" href="https://mvnrepository.com/">https://mvnrepository.com/</a></p>
<h2 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h2><p>maven可以管理jar文件</p>
<p>自动下载jar文件和它的文档，源代码</p>
<p>管理jar文件的直接依赖</p>
<p>管理需要的jar版本</p>
<p>编译程序，测试程序，打包成jar、war文件，部署项目</p>
<h2 id="构建"><a href="#构建" class="headerlink" title="构建"></a>构建</h2><p>maven的生命周期是清理、编译、测试、打包、安装、部署</p>
<p><strong>当执行命令时生命周期前边的命令也会依次执行</strong></p>
<p><strong>清理(mvn clean)</strong></p>
<p>将之前项目编译的东西删除</p>
<p><strong>编译(mvn compile)(mvn test-compile)</strong></p>
<p>那程序源代码编译为可执行代码文件，同时编译多个文件</p>
<p><strong>测试(mvn test)</strong></p>
<p>执行测试程序的代码，验证你的功能是否正确，同时测试验证多个代码和功能</p>
<p><strong>报告</strong></p>
<p>生成测试结果文件</p>
<p><strong>打包(mvn package)</strong></p>
<p>将项目的main目录中的所有class文件、配置文件等多有资源放到一个压缩文件中</p>
<p>java文件压缩为.jar，javaweb文件压缩为.war</p>
<p><strong>安装(mvn install)</strong></p>
<p>将打包的文件安装到maven本机仓库</p>
<p><strong>部署(mvn deploy)</strong></p>
<p>将安装好的程序进行部署</p>
<h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><p>idea中要先完成目录结构，在点击Mark Directory设置目录属性</p>
<p>项目根目录：</p>
<p>​	–src：源码</p>
<p>​				–main：主工程代码</p>
<p>​						–java：主工程代码</p>
<p>​						–resources：需要使用的配置文件</p>
<p>​						–webapp：web项目的资源目录</p>
<p>​				–test：测试代码</p>
<p>​						–java：测试代码</p>
<p>​						–resources：测试需要的配置文件</p>
<p>​	–pom.xml：项目的核心配置文件</p>
<h2 id="pom"><a href="#pom" class="headerlink" title="pom"></a>pom</h2><p>项目对象模型</p>
<h3 id="坐标"><a href="#坐标" class="headerlink" title="坐标"></a>坐标</h3><p>唯一值，在互联网中唯一标识一个项目</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>公司域名的倒写<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>自定义项目名称<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>自定义版本号<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h3><p>dependencies和dependency，相当于java中的import</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--导入项目依赖--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>公司域名的倒写<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>自定义项目名称<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">version</span>&gt;</span>自定义版本号<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="依赖范围"><a href="#依赖范围" class="headerlink" title="依赖范围"></a>依赖范围</h3><p>依赖的范围有compile、test、provided、默认采用compile</p>
<p>​	compile：主程序（编译）、测试程序、打包、部署（运行）有效</p>
<p>​	test：测试程序有效</p>
<p>​	provided：主程序（编译）、测试程序有效（不参与打包和部署）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--导入项目依赖--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>公司域名的倒写<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>自定义项目名称<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">version</span>&gt;</span>自定义版本号<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--项目依赖的范围--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>依赖范围<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!--maven自带属性--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="自定义属性"><a href="#自定义属性" class="headerlink" title="自定义属性"></a>自定义属性</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--在&lt;properties&gt;标签中进行声明定义&lt;标签名&gt;&lt;/标签名&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mysql.version</span>&gt;</span>属性值<span class="tag">&lt;/<span class="name">mysql.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--在pom.xml其他文职使用，$&#123;标签名&#125;--&gt;</span></span><br><span class="line">$&#123;mysql.version&#125;</span><br></pre></td></tr></table></figure>

<h3 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">finalName</span>&gt;</span>test2<span class="tag">&lt;/<span class="name">finalName</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">pluginManagement</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--插件版本--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-clean-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">pluginManagement</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="资源插件"><a href="#资源插件" class="headerlink" title="资源插件"></a>资源插件</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resoutces</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--此时maven下的默认导入资源目录不存在，不会导入资源目录只会导入设置的目录文件--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>要导入的资源存在的目录(src开始)<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>目录下的文件类型<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">          		<span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--不启用过滤器，&lt;include&gt;相当于过滤器--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resoutces</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="依赖-1"><a href="#依赖-1" class="headerlink" title="依赖"></a>依赖</h2><h3 id="依赖传递"><a href="#依赖传递" class="headerlink" title="依赖传递"></a>依赖传递</h3><p>非compile范围的依赖不能传递</p>
<p>若存在依赖冲突，则验证路径最短者优先，验证路径相同时先声明者优先</p>
<h3 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h3><p>创建父工程，打包方式是pom</p>
<p>在父工程中统一管理junit依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--导入项目依赖--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--项目依赖的范围--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在子工程中声明对父工程的引用</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.zhq.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>Parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--以当前文件为基准的父工程的pom.xml文件的相对路径（可不写）--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>../Parent/pom.xml<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>将子工程的坐标和父工程的坐标中重复的内容删除，删除junit的版本号，使用父工程统一管理</p>
<h3 id="聚合"><a href="#聚合" class="headerlink" title="聚合"></a>聚合</h3><p>一键安装各个模块工程</p>
<p>在一个总模块工程中配置各个参与聚合的模块</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置聚合--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">modules</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--指定各个子工程的相对路径--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span>&gt;</span>../Hello<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">modules</span>&gt;</span></span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/01/30/Maven/" data-id="cl3u71bk0000e380laocq1gfu" data-title="Maven" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-MySQL" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/30/MySQL/" class="article-date">
  <time class="dt-published" datetime="2021-01-30T05:47:47.000Z" itemprop="datePublished">2021-01-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/30/MySQL/">MySQL</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h1><h2 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h2><p>windows中服务的启动和关闭：net stop mysql、net start mysql</p>
<p>Linux中<strong>启动&#x2F;关闭mysql</strong><br>service mysqld start<br>service mysqld stop<br>service mysqld restart</p>
<p>登录：mysql -u用户名 -p  输入密码</p>
<p>​			mysql -h ip地址 -u用户名 -p 输入密码</p>
<p>退出：exit</p>
<h3 id="创建数据库和表"><a href="#创建数据库和表" class="headerlink" title="创建数据库和表"></a>创建数据库和表</h3><p>创建数据库语句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE database;</span><br></pre></td></tr></table></figure>

<p>展示所有数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> DATABASES;</span><br></pre></td></tr></table></figure>

<p>使用指定数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">USE database;</span><br></pre></td></tr></table></figure>

<p>创建表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> student(</span><br><span class="line">    s_no <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">PRIMARY</span> KEY COMMENT<span class="string">&#x27;学生学号&#x27;</span>,</span><br><span class="line">    s_name <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT<span class="string">&#x27;学生姓名 不能为空&#x27;</span>,</span><br><span class="line">    s_sex <span class="type">VARCHAR</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT<span class="string">&#x27;学生性别&#x27;</span>,</span><br><span class="line">    s_birthday DATETIME COMMENT<span class="string">&#x27;学生生日&#x27;</span>,</span><br><span class="line">    s_class <span class="type">VARCHAR</span>(<span class="number">20</span>) COMMENT<span class="string">&#x27;学生所在的班级&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>展示表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DESCRIBE</span> <span class="keyword">table</span>;</span><br></pre></td></tr></table></figure>

<img src="MySQL/image-20220402230725522.png" alt="image-20220402230725522" />



<h3 id="对表的数据操作"><a href="#对表的数据操作" class="headerlink" title="对表的数据操作"></a>对表的数据操作</h3><h4 id="查看操作"><a href="#查看操作" class="headerlink" title="查看操作"></a>查看操作</h4><p>查看表中的记录</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="keyword">table</span>;</span><br></pre></td></tr></table></figure>

<h4 id="插入操作"><a href="#插入操作" class="headerlink" title="插入操作"></a>插入操作</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">table</span> <span class="keyword">VALUES</span> (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>...);</span><br></pre></td></tr></table></figure>

<h4 id="删除操作"><a href="#删除操作" class="headerlink" title="删除操作"></a>删除操作</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> <span class="keyword">table</span> <span class="keyword">WHERE</span> cow <span class="operator">=</span> <span class="string">&#x27;&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="修改数据"><a href="#修改数据" class="headerlink" title="修改数据"></a>修改数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> <span class="keyword">table</span> <span class="keyword">SET</span> cow1 <span class="operator">=</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">WHERE</span> cow2 <span class="operator">=</span> <span class="string">&#x27;&#x27;</span>;</span><br></pre></td></tr></table></figure>



<h2 id="约束"><a href="#约束" class="headerlink" title="约束"></a>约束</h2><h3 id="主键"><a href="#主键" class="headerlink" title="主键"></a>主键</h3><p>能够唯一确定表中的一条记录。我们通过给某个字段添加该约束，就可以使得该字段不重复且不为空。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">user</span> (</span><br><span class="line">	id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">	name <span class="type">VARCHAR</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h4 id="联合主键"><a href="#联合主键" class="headerlink" title="联合主键"></a>联合主键</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> user2 (</span><br><span class="line">	id <span class="type">INT</span>,</span><br><span class="line">	name <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY(id, name)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>此处字段id和name一同作为主键，联合主键要求每个字段<strong>加起来不同即可</strong>（无需每个字段都不同）</p>
<h4 id="建表后添加主键"><a href="#建表后添加主键" class="headerlink" title="建表后添加主键"></a>建表后添加主键</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALERT <span class="keyword">TABLE</span> user2 <span class="keyword">ADD</span> <span class="keyword">PRIMARY</span> KEY (id);</span><br></pre></td></tr></table></figure>

<p>或者通过<strong>修改字段</strong>的方式来添加主键</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALERT <span class="keyword">TABLE</span> user2 MODIFY id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY;</span><br></pre></td></tr></table></figure>

<h4 id="建表后删除主键"><a href="#建表后删除主键" class="headerlink" title="建表后删除主键"></a>建表后删除主键</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALERT <span class="keyword">TABLE</span> user2 <span class="keyword">DROP</span> <span class="keyword">PRIMARY</span> KEY (id);</span><br></pre></td></tr></table></figure>

<h3 id="自增约束"><a href="#自增约束" class="headerlink" title="自增约束"></a>自增约束</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> user3 (</span><br><span class="line">	id <span class="type">INT</span> AUTO_INCREAMENT,</span><br><span class="line">	name <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> user3 (name) <span class="keyword">VALUES</span> (<span class="string">&#x27;name&#x27;</span>); <span class="operator">/</span><span class="operator">/</span>插入成功，自动生成了id</span><br></pre></td></tr></table></figure>

<p>自增约束一般<strong>与主键搭配使用</strong></p>
<h3 id="唯一约束"><a href="#唯一约束" class="headerlink" title="唯一约束"></a>唯一约束</h3><p>约束修饰的字段不可以重复</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> user4 (</span><br><span class="line">	id <span class="type">INT</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">	name <span class="type">VARCHAR</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> user4 (</span><br><span class="line">	id <span class="type">INT</span>,</span><br><span class="line">	name <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">	<span class="keyword">UNIQUE</span>(id, name)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="非空约束"><a href="#非空约束" class="headerlink" title="非空约束"></a>非空约束</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> user4 (</span><br><span class="line">	id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	name <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="默认约束"><a href="#默认约束" class="headerlink" title="默认约束"></a>默认约束</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> user4 (</span><br><span class="line">	id <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">10</span>,</span><br><span class="line">	name <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>如果我们插入字段时没有传值，就会<strong>使用默认值</strong></p>
<h3 id="外键约束"><a href="#外键约束" class="headerlink" title="外键约束"></a>外键约束</h3><p>主表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> master(</span><br><span class="line">	id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">	name <span class="type">VARCHAR</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>从表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> pet(</span><br><span class="line">	id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">	name <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">	master_id <span class="type">int</span>,</span><br><span class="line">	<span class="keyword">FOREIGN</span> KEY(master_id) <span class="keyword">REFERENCES</span> master(id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<ul>
<li>主表中没有的数据，在副表中是不可以使用的</li>
<li>主表中的数据被副标引用时，是不可以删除的</li>
</ul>
<h2 id="数据库的三大范式"><a href="#数据库的三大范式" class="headerlink" title="数据库的三大范式"></a>数据库的三大范式</h2><h3 id="多表之间的关系"><a href="#多表之间的关系" class="headerlink" title="多表之间的关系"></a>多表之间的关系</h3><h4 id="一对一"><a href="#一对一" class="headerlink" title="一对一"></a>一对一</h4><p>可以在任意一方建立外键，指向一方的主键</p>
<h4 id="一对多"><a href="#一对多" class="headerlink" title="一对多"></a>一对多</h4><p>在多的一个方建立外键，指向一的一方的主键</p>
<h4 id="多对多"><a href="#多对多" class="headerlink" title="多对多"></a>多对多</h4><p>多对多关系的实现需要借助第三张中间表，中间表至少包含两个字段，这两个字段作为第三张表的外键，分别指向两张表的主键</p>
<p><strong>函数依赖</strong>：如果通过A属性（属性组）的值可以唯一确定B属性的值，则称B依赖于A</p>
<p><strong>完全函数依赖</strong>：如果A是一个属性组，则B属性值的确定需要依赖于A属性组中的所有属性值</p>
<p><strong>部分函数依赖</strong>：如果A是一个属性组，则B属性值的确定值需要依赖于A属性组中的某一些属性值</p>
<p><strong>传递函数依赖</strong>：如果通过A属性（属性组）的值可以唯一确定B属性的值，在通过B属性（属性组）的值可以唯一确定C属性的值，则称C传递函数依赖于A</p>
<p><strong>码</strong>：如果一张表中，一个属性或属性组，被其他所有属性所完全依赖，则称该属性（属性组）为该表的码</p>
<p><strong>主属性</strong>：码属性组中的所有属性</p>
<p><strong>非主属性</strong>：除码属性组的其他属性</p>
<h3 id="第一范式"><a href="#第一范式" class="headerlink" title="第一范式"></a>第一范式</h3><p><strong>数据库表的每一列都是不可分割的基本数据项，同一列中不能有多个值</strong></p>
<p>建表如下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> student(</span><br><span class="line">	id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCRAEMENT,</span><br><span class="line">	name <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">	province <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">	city <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">	area <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">	street: <span class="type">VARCHAR</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>就是<strong>符合第一范式</strong>的，但<strong>并不是拆分的越详细越好</strong></p>
<h3 id="第二范式"><a href="#第二范式" class="headerlink" title="第二范式"></a>第二范式</h3><ul>
<li>满足第一范式的条件下，第二范式要求：<strong>除主键外的每一列，都必须完全依赖于主键[ 消除部分函数依赖 ]</strong></li>
<li>如果出现不完全依赖，则只可能发生在<strong>联合主键</strong>的情况下</li>
</ul>
<p><strong>不满足第二范式的例子</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">order</span>(</span><br><span class="line">	product_id <span class="type">INT</span>,</span><br><span class="line">	customer_id <span class="type">INT</span>,</span><br><span class="line">	product_name <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">	customer_name <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY(product_id, customer_id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>此处product_name只依赖于product_id，customer_name只依赖于customer_id，是部分函数依赖</p>
<h3 id="第三范式"><a href="#第三范式" class="headerlink" title="第三范式"></a>第三范式</h3><p><strong>满足第二范式，除主键外的其他列之间不能有传递依赖关系[消除传递函数依赖]</strong></p>
<p><strong>不满足第三范式的例子</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">order</span>(</span><br><span class="line">	id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">	product_id <span class="type">INT</span>,</span><br><span class="line">	customer_id <span class="type">INT</span>,</span><br><span class="line">	customer_phone <span class="type">INT</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>此处customer_phone又依赖于customer_id，存在传递依赖关系，不满足第三范式</p>
<h2 id="查询练习"><a href="#查询练习" class="headerlink" title="查询练习"></a>查询练习</h2><ul>
<li>查询student表中所有记录的s_name,s_sex和s_class列</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s_no,s_name,s_class <span class="keyword">FROM</span>  student;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询教师所有的单位但是不重复的t_depart列——DISTINCT(列名)</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span>(t_depart) <span class="keyword">FROM</span> teacher;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询score表中成绩在60-80之间所有的记录(sc_degree)</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s_no, sc_degree <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> sc_degree <span class="keyword">BETWEEN</span> <span class="number">60</span> <span class="keyword">AND</span> <span class="number">80</span>;</span><br><span class="line"><span class="keyword">SELECT</span> s_no, sc_degree <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> sc_degree <span class="operator">&gt;</span> <span class="number">60</span> <span class="keyword">AND</span> sc_degree <span class="operator">&lt;</span> <span class="number">80</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询score表中成绩为85, 86, 或者88的记录(sc_degree)——IN(结果集合)</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s_no, sc_degree <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> sc_degree <span class="keyword">IN</span>(<span class="number">85</span>, <span class="number">86</span>, <span class="number">88</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>查询student表中’95031’班或者性别为’女’的同学记录——OR</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> s_class <span class="operator">=</span> <span class="string">&#x27;95031&#x27;</span> <span class="keyword">OR</span> s_sex <span class="operator">=</span> <span class="string">&#x27;女&#x27;</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>以sc_degree降序查询score表中所有的记录——ORDER BY 列名 DESC</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s_no, sc_degree <span class="keyword">FROM</span> score <span class="keyword">ORDER</span> <span class="keyword">BY</span> sc_degree <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询’95031’班的学生人数——COUNT(*)</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> s_class <span class="operator">=</span> <span class="string">&#x27;95031&#x27;</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询score表中的最高分数的学生号和课程号——MAX(列名)</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s_no, c_no <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> sc_degree <span class="operator">=</span> (<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(sc_degree) <span class="keyword">FROM</span> score);</span><br></pre></td></tr></table></figure>

<ul>
<li>查询每门课的平均成绩——AVG(列名)</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> c_no, <span class="built_in">AVG</span>(sc_degree) <span class="keyword">FROM</span> score <span class="keyword">GROUP</span> <span class="keyword">BY</span> c_no;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询score表中至少有2名学生选修的,并且以3开头的课程的平均分——GROUP BY 列名 HAVING 条件</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> c_no, <span class="built_in">AVG</span>(sc_degree) <span class="keyword">FROM</span> score <span class="keyword">GROUP</span> <span class="keyword">BY</span> c_no <span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(c_no) <span class="operator">&gt;=</span><span class="number">2</span> <span class="keyword">AND</span> c_no <span class="keyword">LIKE</span> <span class="string">&#x27;3%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询所有的学生 s_name , c_no, sc_degree列</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s_name, c_no, sc_degree <span class="keyword">FROM</span> student, score <span class="keyword">WHERE</span> student.s_no <span class="operator">=</span> score.s_no;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询所有学生的s_no, c_name, sc_degree列</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s_no, c_name, sc_degree <span class="keyword">FROM</span> student, score, course <span class="keyword">WHERE</span> student.s_no <span class="operator">=</span> score.s_no <span class="keyword">AND</span> score.c_no <span class="operator">=</span> course.c_no;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询所有的学生 s_name , c_name, sc_degree列</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s_name, c_name, sc_degree <span class="keyword">FROM</span> student, score, course <span class="keyword">WHERE</span> student.s_no <span class="operator">=</span> score.s_no <span class="keyword">AND</span> score.c_no <span class="operator">=</span> course.c_no;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询班级是’95031’班学生每门课的平均分</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> c_no, <span class="built_in">AVG</span>(sc_degree) <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> s_no <span class="keyword">IN</span> (<span class="keyword">SELECT</span> s_no <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> s_class <span class="operator">=</span> <span class="string">&#x27;95031&#x27;</span>) <span class="keyword">GROUP</span> <span class="keyword">BY</span>(c_no);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> c_no, <span class="built_in">AVG</span>(sc_degree) <span class="keyword">FROM</span> student <span class="keyword">AS</span> s <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> score <span class="keyword">AS</span> sc <span class="keyword">ON</span> s.s_no <span class="operator">=</span> sc.s_no <span class="keyword">WHERE</span> s_class <span class="operator">=</span> <span class="string">&#x27;95031&#x27;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> c_no;</span><br><span class="line"></span><br><span class="line"><span class="comment">--查询内容包含课程名（c_name）</span></span><br><span class="line"><span class="keyword">SELECT</span> c.c_no, c.c_name, <span class="built_in">AVG</span>(sc.sc_degree) <span class="keyword">FROM</span> student <span class="keyword">AS</span> s, course <span class="keyword">AS</span> c, score <span class="keyword">AS</span> sc <span class="keyword">WHERE</span> s.s_no <span class="operator">=</span> sc.s_no <span class="keyword">AND</span> sc.c_no <span class="operator">=</span> c.c_no <span class="keyword">AND</span> s.s_class <span class="operator">=</span> <span class="string">&#x27;95031&#x27;</span>  <span class="keyword">GROUP</span> <span class="keyword">BY</span> c.c_no;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询选修”3-105”课程的成绩高于’109’号同学’3-105’成绩 的所有同学的记录</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span><span class="keyword">FROM</span> student <span class="keyword">AS</span> s, score <span class="keyword">AS</span> sc <span class="keyword">WHERE</span> sc.sc_degree <span class="operator">&gt;</span> (<span class="keyword">SELECT</span> sc_degree <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> s_no <span class="operator">=</span> <span class="string">&#x27;109&#x27;</span> <span class="keyword">AND</span> c_no <span class="operator">=</span> <span class="string">&#x27;3-105&#x27;</span>) <span class="keyword">AND</span> sc.c_no <span class="operator">=</span> <span class="string">&#x27;3-105&#x27;</span> <span class="keyword">AND</span> s.s_no <span class="operator">=</span> sc.s_no;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询所有与学号为108.101的同学同年出生的所有学生的s_no,s_name和s_birthday</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span><span class="keyword">FROM</span> student <span class="keyword">WHERE</span> <span class="keyword">YEAR</span>(s_birthday) <span class="keyword">IN</span> (<span class="keyword">SELECT</span> <span class="keyword">YEAR</span>(s_birthday) <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> s_no <span class="keyword">IN</span> (<span class="string">&#x27;101&#x27;</span>, <span class="string">&#x27;108&#x27;</span>));</span><br></pre></td></tr></table></figure>

<ul>
<li>查询 张旭 教师任课的学生的成绩</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s.s_name, sc.sc_degree <span class="keyword">FROM</span> score <span class="keyword">AS</span> sc, student <span class="keyword">AS</span> s <span class="keyword">WHERE</span> c_no <span class="operator">=</span> (<span class="keyword">SELECT</span> c_no <span class="keyword">FROM</span> course <span class="keyword">WHERE</span> t_no <span class="operator">=</span> (<span class="keyword">SELECT</span> t_no <span class="keyword">FROM</span> teacher <span class="keyword">WHERE</span> t_name <span class="operator">=</span> <span class="string">&#x27;张旭&#x27;</span>)) <span class="keyword">AND</span> s.s_no <span class="operator">=</span> sc.s_no;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询95033班和95031班全体学生的记录</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> s_class <span class="keyword">IN</span> (<span class="string">&#x27;95033&#x27;</span>, <span class="string">&#x27;95031&#x27;</span>) <span class="keyword">ORDER</span> <span class="keyword">BY</span> s_class;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询存在85分以上成绩的c_name和对应的老师</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> t_name, c_name <span class="keyword">FROM</span> course <span class="keyword">AS</span> c, teacher <span class="keyword">AS</span> t <span class="keyword">WHERE</span> c_no <span class="keyword">IN</span> (<span class="keyword">SELECT</span> c_no <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> sc_degree <span class="operator">&gt;</span> <span class="number">85</span>) <span class="keyword">AND</span> c.t_no <span class="operator">=</span> t.t_no;</span><br></pre></td></tr></table></figure>

<ul>
<li>查出所有’计算机系’ 教师所教课程的教师信息、课程信息及学生信息</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  <span class="operator">*</span> <span class="keyword">FROM</span> teacher <span class="keyword">AS</span> t, course <span class="keyword">AS</span> c, student <span class="keyword">AS</span> s, score <span class="keyword">AS</span> sc </span><br><span class="line"><span class="keyword">WHERE</span> s.s_no <span class="operator">=</span> sc.s_no </span><br><span class="line"><span class="keyword">AND</span> c.t_no <span class="operator">=</span> t.t_no </span><br><span class="line"><span class="keyword">AND</span> sc.c_no <span class="operator">=</span> c.c_no </span><br><span class="line"><span class="keyword">AND</span> t.t_no <span class="keyword">IN</span> (<span class="keyword">SELECT</span> t_no <span class="keyword">FROM</span> teacher <span class="keyword">WHERE</span> t_depart <span class="operator">=</span> <span class="string">&#x27;计算机系&#x27;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>查询’计算机系’与’电子工程系’ 不同职称的教师的name和rof</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> teacher <span class="keyword">WHERE</span> t_depart <span class="operator">=</span> <span class="string">&#x27;计算机系&#x27;</span> </span><br><span class="line"><span class="keyword">AND</span> t_rof <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> t_rof <span class="keyword">FROM</span> teacher <span class="keyword">WHERE</span> t_depart <span class="operator">=</span> <span class="string">&#x27;电子工程系&#x27;</span>)</span><br><span class="line"><span class="keyword">UNION</span> </span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> teacher <span class="keyword">WHERE</span> t_depart <span class="operator">=</span> <span class="string">&#x27;电子工程系&#x27;</span> </span><br><span class="line"><span class="keyword">AND</span> t_rof <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> t_rof <span class="keyword">FROM</span> teacher <span class="keyword">WHERE</span> t_depart <span class="operator">=</span> <span class="string">&#x27;计算机系&#x27;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>查询选修编号为”3-105”课程且成绩<strong>至少</strong>高于选修编号为’3-245’同学的c_no,s_no和sc_degree,并且按照sc_degree从高到地次序排序</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> c_no <span class="operator">=</span> <span class="string">&#x27;3-105&#x27;</span> <span class="keyword">AND</span> sc_degree <span class="operator">&gt;</span> <span class="keyword">ANY</span>(<span class="keyword">SELECT</span> sc_degree <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> c_no <span class="operator">=</span> <span class="string">&#x27;3-245&#x27;</span>) <span class="keyword">ORDER</span> <span class="keyword">BY</span> sc_degree <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询选修编号为”3-105”且成绩高于选修编号为”3-245”课程的同学c_no.s_no和sc_degree</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> c_no <span class="operator">=</span> <span class="string">&#x27;3-105&#x27;</span> </span><br><span class="line"><span class="keyword">AND</span> sc_degree <span class="operator">&gt;</span> <span class="keyword">ALL</span>(<span class="keyword">SELECT</span> sc_degree <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> c_no <span class="operator">=</span> <span class="string">&#x27;3-245&#x27;</span>)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> sc_degree <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>查出学生的信息,课程名称,分数(s_name c_name,sc_degree)</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s.s_name, c.c_name, sc.sc_degree <span class="keyword">FROM</span> student <span class="keyword">AS</span> s, course <span class="keyword">AS</span> c, score <span class="keyword">AS</span> sc</span><br><span class="line"><span class="keyword">WHERE</span> s.s_no <span class="operator">=</span> sc.s_no</span><br><span class="line"><span class="keyword">AND</span> c.c_no <span class="operator">=</span> sc.c_no</span><br><span class="line"><span class="keyword">AND</span> sc.sc_degree <span class="operator">&gt;</span> <span class="keyword">ALL</span>(<span class="keyword">SELECT</span> sc_degree <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> c_no <span class="operator">=</span> <span class="string">&#x27;3-245&#x27;</span>)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> sc_degree <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<p>总结:</p>
<ul>
<li><p>ANY 和 ALL</p>
<ul>
<li>ANY:表示任何一个就行了,如;数组A中的值比数组B中任何一个都要大,那么只要A和B中最小的比较就行了</li>
<li>ALL:表示所有都要比较,如:数组A中的值比数组B中所有的数都要大,那么A要和B中最大的值比较才行</li>
</ul>
</li>
<li><p>查询所有教师和同学的 name ,sex, birthday</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s_name, s_sex, s_birthday <span class="keyword">FROM</span> student</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> t_name, t_sex, t_birthday <span class="keyword">FROM</span> teacher;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询所有’女’教师和’女’学生的name,sex,birthday</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s_name, s_sex, s_birthday <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> s_sex <span class="operator">=</span> <span class="string">&#x27;女&#x27;</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> t_name, t_sex, t_birthday <span class="keyword">FROM</span> teacher <span class="keyword">WHERE</span> t_sex <span class="operator">=</span> <span class="string">&#x27;女&#x27;</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询成绩比该课程平均成绩低的同学的成绩表</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> score <span class="keyword">AS</span> a <span class="keyword">WHERE</span> sc_degree <span class="operator">&lt;</span> (<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(sc_degree) <span class="keyword">FROM</span> score <span class="keyword">AS</span> b <span class="keyword">WHERE</span> a.c_no <span class="operator">=</span> b.c_no);</span><br></pre></td></tr></table></figure>

<ul>
<li>查询成绩比该课程平均成绩低的同学的成绩表，并显示出学生name,课程name以及分数</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s.s_name <span class="keyword">AS</span> 学生姓名, c.c_name <span class="keyword">AS</span> 课程名, a.sc_degree <span class="keyword">AS</span> 成绩  <span class="keyword">FROM</span> score <span class="keyword">AS</span> a, student <span class="keyword">AS</span> s, course <span class="keyword">AS</span> c </span><br><span class="line"><span class="keyword">WHERE</span> sc_degree <span class="operator">&lt;</span> (<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(sc_degree) <span class="keyword">FROM</span> score <span class="keyword">AS</span> b <span class="keyword">WHERE</span> a.c_no <span class="operator">=</span> b.c_no)</span><br><span class="line"><span class="keyword">AND</span> s.s_no <span class="operator">=</span> a.s_no</span><br><span class="line"><span class="keyword">AND</span> c.c_no <span class="operator">=</span> a.c_no;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询所有任课教师的t_name 和 t_depart(要在分数表中可以查得到)</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> teacher <span class="keyword">WHERE</span> t_no <span class="keyword">IN</span> (<span class="keyword">SELECT</span> t_no <span class="keyword">FROM</span> course <span class="keyword">WHERE</span> c_no <span class="keyword">IN</span> (<span class="keyword">SELECT</span> c_no <span class="keyword">FROM</span> score));</span><br></pre></td></tr></table></figure>

<ul>
<li>查出至少有2名男生的班号</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s_class <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> s_sex <span class="operator">=</span> <span class="string">&#x27;男&#x27;</span> </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> s_class <span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(s_no) <span class="operator">&gt;</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询student 表中 不姓”王”的同学的记录</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> s_name <span class="keyword">NOT</span> <span class="keyword">LIKE</span> <span class="string">&#x27;王%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询student 中每个学生的姓名和年龄(当前时间 - 出生年份)</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s_name <span class="keyword">AS</span> 姓名, (<span class="keyword">YEAR</span>(NOW())<span class="operator">-</span><span class="keyword">YEAR</span>(s_birthday)) <span class="keyword">AS</span> 年龄 <span class="keyword">FROM</span> student;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询student中最大和最小的 s_birthday的值</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(s_birthday), <span class="built_in">MIN</span>(s_birthday) <span class="keyword">FROM</span> student;</span><br></pre></td></tr></table></figure>

<ul>
<li>以班级号和年龄从大到小的顺序查询student表中的全部记录</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">ORDER</span> <span class="keyword">BY</span> s_class <span class="keyword">DESC</span>, (<span class="keyword">YEAR</span>(NOW()) <span class="operator">-</span> <span class="keyword">YEAR</span>(s_birthday)) <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询”男”教师 及其所上的课</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> t.t_name, c.c_name <span class="keyword">FROM</span> teacher <span class="keyword">AS</span> t, course <span class="keyword">AS</span> c <span class="keyword">WHERE</span> t.t_sex <span class="operator">=</span> <span class="string">&#x27;男&#x27;</span>  <span class="keyword">AND</span> t.t_no <span class="operator">=</span> c.t_no;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询最高分同学的s_no c_no 和 sc_degree;</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> s_no <span class="operator">=</span> (<span class="keyword">SELECT</span> s_no <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> sc_degree  <span class="operator">=</span> (<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(sc_degree) <span class="keyword">FROM</span> score));</span><br></pre></td></tr></table></figure>

<ul>
<li>查询和”李军”同性别的所有同学的s_name</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s_name <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> s_sex <span class="operator">=</span>  (<span class="keyword">SELECT</span> s_sex <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> s_name <span class="operator">=</span> <span class="string">&#x27;李军&#x27;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>查询和”李军”同性别并且同班的所有同学的s_name</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s_name <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> s_sex <span class="operator">=</span>  (<span class="keyword">SELECT</span> s_sex <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> s_name <span class="operator">=</span> <span class="string">&#x27;李军&#x27;</span>)</span><br><span class="line"><span class="keyword">AND</span> s_class <span class="operator">=</span> (<span class="keyword">SELECT</span> s_class <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> s_name <span class="operator">=</span> <span class="string">&#x27;李军&#x27;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>查询所有选修’计算机导论’课程的’男’同学的成绩表，并显示出s_name,c_name</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s.s_name, c.c_name, sc.sc_degree <span class="keyword">FROM</span> student <span class="keyword">AS</span> s, score <span class="keyword">AS</span> sc, course <span class="keyword">AS</span> c </span><br><span class="line"><span class="keyword">WHERE</span> s.s_no <span class="operator">=</span> sc.s_no <span class="keyword">AND</span> c.c_no <span class="operator">=</span> sc.c_no </span><br><span class="line"><span class="keyword">AND</span> c.c_name <span class="operator">=</span> <span class="string">&#x27;计算机导论&#x27;</span></span><br><span class="line"><span class="keyword">AND</span> s.s_sex <span class="operator">=</span> <span class="string">&#x27;男&#x27;</span>;</span><br></pre></td></tr></table></figure>



<h3 id="连接查询"><a href="#连接查询" class="headerlink" title="连接查询"></a>连接查询</h3><p><strong>没有创建外键时，可以使用内外查询将两个表的内容合并在一起查询</strong></p>
<h4 id="内连接"><a href="#内连接" class="headerlink" title="内连接"></a>内连接</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> ... <span class="keyword">ON</span> ...</span><br></pre></td></tr></table></figure>

<p>举例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> person <span class="keyword">AS</span> p <span class="keyword">INNER</span> <span class="keyword">JOIN</span> card  <span class="keyword">AS</span> c <span class="keyword">ON</span> p.card_id <span class="operator">=</span> c.id;</span><br></pre></td></tr></table></figure>

<p><strong>内联查询：两张表通过某个字段合并起来，查询出相关数据</strong></p>
<h4 id="外连接"><a href="#外连接" class="headerlink" title="外连接"></a>外连接</h4><h5 id="左外连接"><a href="#左外连接" class="headerlink" title="左外连接"></a>左外连接</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> ... <span class="keyword">ON</span> ...</span><br><span class="line">或</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> ... <span class="keyword">ON</span> ...</span><br></pre></td></tr></table></figure>

<p>举例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> person <span class="keyword">AS</span> p <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> card <span class="keyword">AS</span> c <span class="keyword">ON</span> p.card_id <span class="operator">=</span> c.id;</span><br><span class="line">或者</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> person <span class="keyword">AS</span> p <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> card <span class="keyword">AS</span> c <span class="keyword">ON</span> p.card_id <span class="operator">=</span> c.id;</span><br></pre></td></tr></table></figure>

<p><strong>左外连接：</strong></p>
<ul>
<li>会把左表里的所有数据都取出来</li>
<li>对于右表，如果有数据就取出，如果没有就为空</li>
</ul>
<h5 id="右外连接"><a href="#右外连接" class="headerlink" title="右外连接"></a>右外连接</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> ... <span class="keyword">ON</span> ...</span><br><span class="line">或</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> ... <span class="keyword">ON</span> ...</span><br></pre></td></tr></table></figure>

<p>举例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> person <span class="keyword">AS</span> p <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> card <span class="keyword">AS</span> c <span class="keyword">ON</span> p.card_id <span class="operator">=</span> c.id;</span><br><span class="line">或</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> person <span class="keyword">AS</span> p <span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> card <span class="keyword">AS</span> c <span class="keyword">ON</span> p.card_id <span class="operator">=</span> c.id;</span><br></pre></td></tr></table></figure>

<p><strong>右外连接</strong></p>
<ul>
<li>会把右表中的所有数据都取出来</li>
<li>对于左表，如果有数据就取出，如果没有就为空</li>
</ul>
<h5 id="三种连接的图解"><a href="#三种连接的图解" class="headerlink" title="三种连接的图解"></a>三种连接的图解</h5><img src="MySQL/image-20220402230403970.png" alt="image-20220402230403970" style="zoom:80%;" />



<h2 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h2><p>事务是一个最小的不可分割的单元，事务能够保证一个业务的完整性</p>
<p>多条sql语句<strong>要么同时成功，要么同时失败</strong></p>
<h3 id="自动提交、手动提交和回滚"><a href="#自动提交、手动提交和回滚" class="headerlink" title="自动提交、手动提交和回滚"></a>自动提交、手动提交和回滚</h3><p>通过**ROLLBACK;**指令可以回滚，但需要关闭自动提交</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SET autocommit = 0</span><br><span class="line">查看自动提交状态</span><br><span class="line">SELECT @@autocommit;</span><br></pre></td></tr></table></figure>

<p>但如果在进行操作之后，执行提交事务**COMMIT;**则无法再进行回滚（持久化）</p>
<h3 id="手动开启事务"><a href="#手动开启事务" class="headerlink" title="手动开启事务"></a>手动开启事务</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line">或者</span><br><span class="line"><span class="keyword">START</span> TRANSACTION;</span><br></pre></td></tr></table></figure>

<h3 id="四大特征-ACID"><a href="#四大特征-ACID" class="headerlink" title="四大特征 ACID"></a>四大特征 ACID</h3><ul>
<li>原子性：事务是最小的单位，<strong>不可再分</strong></li>
<li>一致性：同一事务中的sql语句<strong>要么同时成功，要么同时失败</strong></li>
<li>隔离性：事务1和事务2之间具有隔离性</li>
<li>持久性：事物<strong>一旦结束</strong>（commit），就<strong>不可返回</strong>（rollback）</li>
</ul>
<h4 id="隔离性"><a href="#隔离性" class="headerlink" title="隔离性"></a>隔离性</h4><ul>
<li>事务的隔离级别<ul>
<li>读未提交 read uncommitted</li>
<li>读已提交 read committed</li>
<li>可以重复读 repeatable read</li>
<li>串行化 serializable</li>
</ul>
</li>
</ul>
<img src="MySQL/image-20220402230523842.png" alt="image-20220402230523842" style="zoom:80%;" />

<ul>
<li>事务的并发问题<ul>
<li>脏读：事务A读取了事务B更新的数据，然后<strong>B回滚操作</strong>，那么<strong>A读取到的数据是脏数据</strong></li>
<li>不可重复读：事务 A 多次读取同一数据，事务B在事务A多次读取的过程中，对数据作了<strong>更新并提交</strong>，<strong>导致事务A多次读取同一数据时，结果不一致</strong></li>
<li>幻读：系统管理员A将数据库中所有学生的成绩从具体分数改为ABCDE等级，但是系统管理员B就在这个时候插入了一条具体分数的记录，当系统管理员A改结束后发现还有一条记录没有改过来，就好像发生了幻觉一样，这就叫幻读</li>
</ul>
</li>
</ul>
<p><strong>总结</strong>：<strong>不可重复读侧重于修改，幻读侧重于新增或删除</strong></p>
<p> 解决不可重复读的问题只需锁住满足条件的行，解决幻读需要锁表</p>
<ul>
<li>查看数据库的隔离级别</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">版本 <span class="number">5.</span>x</span><br><span class="line"><span class="keyword">SELECT</span> @<span class="variable">@global</span>.tx_isolation;</span><br><span class="line"></span><br><span class="line">版本 <span class="number">8.0</span></span><br><span class="line"><span class="keyword">SELECT</span> @<span class="variable">@global</span>.transaction_isolation;</span><br></pre></td></tr></table></figure>

<ul>
<li>修改数据库的隔离级别</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> transaction isolation level read committed;</span><br></pre></td></tr></table></figure>



<h2 id="BeanUtils工具类"><a href="#BeanUtils工具类" class="headerlink" title="BeanUtils工具类"></a>BeanUtils工具类</h2><p>简化数据封装，用于封装javaBean的</p>
<h3 id="javaBean"><a href="#javaBean" class="headerlink" title="javaBean"></a>javaBean</h3><p>标准java类</p>
<ol>
<li>类必须被public修饰</li>
<li>必须提供空参public修饰的构造函数</li>
<li>成员变量必须使用private修饰</li>
<li>提供公共public修饰的setter和getter方法</li>
</ol>
<h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3><p>ssetter和getter方法截取后的产物，例如getUsername() —-username就是属性</p>
<h3 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h3><ol>
<li>setProperty() 设置bean的属性值      </li>
<li>getProperty()获取bean的属性值        </li>
<li>populate(Object obj, Map map)将map集合的键值对信息封装到JavaBean对象中</li>
</ol>
<p>注意：需要导入commons-beanutils-1.8.3.jar该包需要，两个jar包的支持：commons-collections-3.2.1.jar，commons-logging-1.1.1.jar</p>
<h1 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h1><h2 id="JDBC概述"><a href="#JDBC概述" class="headerlink" title="JDBC概述"></a>JDBC概述</h2><ul>
<li><p>JDBC(Java Database Connectivity)是一个<strong>独立于特定数据库管理系统、通用的SQL数据库存取和操作的公共接口</strong>（一组API），定义了用来访问数据库的标准Java类库，（<strong>java.sql,javax.sql</strong>）使用这些类库可以以一种<strong>标准</strong>的方法、方便地访问数据库资源。</p>
</li>
<li><p>JDBC的目标是使Java程序员使用JDBC可以连接任何<strong>提供了JDBC驱动程序</strong>的数据库系统，这样就使得程序员无需对特定的数据库系统的特点有过多的了解，从而大大简化和加快了开发过程。</p>
</li>
</ul>
<h3 id="两种思想"><a href="#两种思想" class="headerlink" title="两种思想"></a>两种思想</h3><h4 id="面向接口编程"><a href="#面向接口编程" class="headerlink" title="面向接口编程"></a>面向接口编程</h4><p>将数据库的实现类封装成接口，直接使用接口</p>
<h4 id="ORM编程思想"><a href="#ORM编程思想" class="headerlink" title="ORM编程思想"></a>ORM编程思想</h4><p>object relationship mapping 对象关系映射</p>
<p>一个数据表对应一个java类</p>
<p>表中一条记录对应java类的一个对象</p>
<p>表中一个字段对应java类的一个属性</p>
<h3 id="两种技术"><a href="#两种技术" class="headerlink" title="两种技术"></a>两种技术</h3><h4 id="ResultSetMetaData元数据"><a href="#ResultSetMetaData元数据" class="headerlink" title="ResultSetMetaData元数据"></a>ResultSetMetaData元数据</h4><ol>
<li>getColumnCount()：获取列数</li>
<li>getColumnLabel()：获取列别名（没有别名获取的是列的名称）</li>
</ol>
<h4 id="反射"><a href="#反射" class="headerlink" title="反射"></a>反射</h4><ol>
<li>创建对应运行时类的对象——newIncentive()</li>
<li>在运行时，动态的调用指定运行时类的属性，方法</li>
</ol>
<h3 id="数据库与SQL类型转化"><a href="#数据库与SQL类型转化" class="headerlink" title="数据库与SQL类型转化"></a>数据库与SQL类型转化</h3><p><img src="https://dot-grill-f98.notion.site/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F050ac75a-59c7-4787-a78d-97b29e8991bf%2FUntitled.png?table=block&id=85c87d1a-bfae-4711-a62e-9c4e3db7ad63&spaceId=65247838-fa1c-443f-8939-5945fc1748c5&width=1950&userId=&cache=v2" alt="img"></p>
<h2 id="JDBC编写步骤"><a href="#JDBC编写步骤" class="headerlink" title="JDBC编写步骤"></a>JDBC编写步骤</h2><img src="MySQL/image-20220402230638657.png" alt="image-20220402230638657" style="zoom:80%;" />



<p>ODBC(<strong>Open Database Connectivity</strong>，开放式数据库连接)，是微软在Windows平台下推出的。使用者在程序中只需要调用ODBC API，由 ODBC 驱动程序将调用转换成为对特定的数据库的调用请求。</p>
<h3 id="加载驱动到项目"><a href="#加载驱动到项目" class="headerlink" title="加载驱动到项目"></a>加载驱动到项目</h3><ul>
<li>在项目文件下创建lib文件夹，拷贝驱动文件到lib文件夹下</li>
<li>添加依赖：选中对应模块或者项目，将lib中的jar包添加到模块或者项目中</li>
</ul>
<h3 id="连接数据库"><a href="#连接数据库" class="headerlink" title="连接数据库"></a>连接数据库</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test5</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">	<span class="comment">//1. 通过类加载器 获取 数据库文件中的配置信息</span></span><br><span class="line">	<span class="type">ClassLoader</span> <span class="variable">loader</span> <span class="operator">=</span> JDBCTest1.class.getClassLoader();</span><br><span class="line">	<span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> loader.getResourceAsStream(<span class="string">&quot;jdbcTest.properties&quot;</span>);</span><br><span class="line">	<span class="type">Properties</span> <span class="variable">info</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">	info.load(is);</span><br><span class="line">	<span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> info.getProperty(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">	<span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> info.getProperty(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">	<span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> info.getProperty(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">	<span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> info.getProperty(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//2. 通过反射加载驱动类</span></span><br><span class="line">	Class.forName(driver);</span><br><span class="line">	<span class="comment">//3. 连接数据库</span></span><br><span class="line">	<span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> DriverManager.getConnection(url, user, password);</span><br><span class="line">	System.out.println(con);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配置文件<strong>Properties</strong></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/ks</span></span><br><span class="line"><span class="attr">user</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">4213</span></span><br><span class="line"><span class="attr">driver</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br></pre></td></tr></table></figure>

<p><strong>好处</strong>：实现了代码与数据库连接信息的分离，解耦 ；如果需要修改配置文件信息，可以避免程序重新打包</p>
<h2 id="JDBC相关操作"><a href="#JDBC相关操作" class="headerlink" title="JDBC相关操作"></a>JDBC相关操作</h2><h3 id="JDBC相关类"><a href="#JDBC相关类" class="headerlink" title="JDBC相关类"></a>JDBC相关类</h3><h4 id="DriverManager"><a href="#DriverManager" class="headerlink" title="DriverManager"></a>DriverManager</h4><p>驱动管理对象</p>
<p>作用：</p>
<ol>
<li>注册驱动：告诉程序使用哪个数据库驱动jar（一般使用Class.forName(“驱动”)）</li>
<li>获取数据库连接：DriverManager.getConnection(String url, String user, String password)</li>
</ol>
<h4 id="Connection"><a href="#Connection" class="headerlink" title="Connection"></a>Connection</h4><p>数据库连接对象</p>
<ol>
<li>获取执行sql语句的对象：connection.createStatement()或connection.prepareStatement(String sql)</li>
<li>管理事务：<ol>
<li>开启事务：setAutoCommit(false)</li>
<li>提交事务：commit()</li>
<li>回滚事务：rollback()</li>
</ol>
</li>
</ol>
<h4 id="ResultSet"><a href="#ResultSet" class="headerlink" title="ResultSet"></a>ResultSet</h4><p>结果集对象，封装查询结果</p>
<ol>
<li>resultSet.next()：游标向下移动</li>
<li>resultSet.getXxx()：获取数据</li>
</ol>
<h4 id="Statement"><a href="#Statement" class="headerlink" title="Statement"></a>Statement</h4><ul>
<li>通过调用 Connection 对象的 createStatement() 方法创建该对象。该对象用于执行静态的 SQL 语句，并且返回执行结果。</li>
<li>Statement 接口中定义了下列方法用于执行 SQL 语句：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">excuteUpdate</span><span class="params">(String sql)</span>：执行更新操作INSERT、UPDATE、DELETE</span><br><span class="line">ResultSet <span class="title function_">executeQuery</span><span class="params">(String sql)</span>：执行查询操作SELECT</span><br></pre></td></tr></table></figure>

<ul>
<li>但是使用Statement操作数据表存在弊端：</li>
</ul>
<h5 id="问题一：存在拼串操作，繁琐"><a href="#问题一：存在拼串操作，繁琐" class="headerlink" title="问题一：存在拼串操作，繁琐"></a><strong>问题一：存在拼串操作，繁琐</strong></h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String <span class="keyword">sql</span> <span class="operator">=</span> &quot;SELECT user,password FROM user_table WHERE USER = &#x27;&quot; <span class="operator">+</span> userName <span class="operator">+</span> &quot;&#x27; AND PASSWORD = &#x27;&quot; <span class="operator">+</span> password <span class="operator">+</span> &quot;&#x27;&quot;;</span><br></pre></td></tr></table></figure>

<h5 id="问题二：存在SQL注入问题"><a href="#问题二：存在SQL注入问题" class="headerlink" title="问题二：存在SQL注入问题"></a><strong>问题二：存在SQL注入问题</strong></h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">user</span>:<span class="number">1</span><span class="string">&#x27; OR </span></span><br><span class="line"><span class="string">#password:=&#x27;</span><span class="number">1</span><span class="string">&#x27; OR &#x27;</span><span class="number">1</span><span class="string">&#x27; = &#x27;</span><span class="number">1</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>,PASSWORD <span class="keyword">FROM</span> user_table <span class="keyword">WHERE</span> <span class="keyword">USER</span> <span class="operator">=</span> <span class="string">&#x27;1&#x27;</span> <span class="keyword">OR</span> <span class="string">&#x27; AND PASSWORD = &#x27;</span><span class="operator">=</span><span class="string">&#x27;1&#x27;</span> <span class="keyword">OR</span> <span class="string">&#x27;1&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;1&#x27;</span></span><br></pre></td></tr></table></figure>

<p>对于 Java 而言，要防范 SQL 注入，只要用 PreparedStatement 取代 Statement 就可以了。</p>
<h4 id="PreparedStatement"><a href="#PreparedStatement" class="headerlink" title="PreparedStatement"></a>PreparedStatement</h4><p>PreparedStatement 是一个特殊的Statement对象</p>
<h5 id="PreparedStatement对比Statement"><a href="#PreparedStatement对比Statement" class="headerlink" title="PreparedStatement对比Statement"></a>PreparedStatement对比Statement</h5><ul>
<li>拼串和SQL注入的问题</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.Statement中，直接输入SQL语句进行执行，就会出现SQL注入问题</span></span><br><span class="line">SELECT USER,PASSWORD FROM user_table <span class="type">WHERE</span> <span class="variable">USER</span> <span class="operator">=</span> <span class="string">&#x27;1&#x27;</span> OR <span class="string">&#x27; AND PASSWORD = &#x27;</span>=<span class="string">&#x27;1&#x27;</span> OR <span class="string">&#x27;1&#x27;</span> = <span class="string">&#x27;1&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//2.在PreparStatement中则是先进行SQL的预编译, 使用占位符，不用拼串，后续填充占位符，也不会改变SQL原有的逻辑，解决SQL注入</span></span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM admin WHERE username = ? AND PASSWORD = ?;&quot;</span>;</span><br><span class="line"><span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br></pre></td></tr></table></figure>

<ul>
<li><p>Statement无法操作Blob类型的数据</p>
</li>
<li><p>repaerStatement便于批量操作，Statement批量操作：执行一次SQL语句，需要校验一次SQL，repaerStatement批量操作：无论执行多少次SQL，都只校验一次，效率更高</p>
</li>
<li><p><strong>PreparedStatement 能最大可能提高性能：</strong>语句在被DBServer的编译器编译后的执行代码被缓存下来，下次调用时只要是相同的预编译语句就不需要编译，只要将参数直接传入编译过的语句执行代码中就会得到执行。</p>
</li>
</ul>
<h4 id="ResultSetMetaData"><a href="#ResultSetMetaData" class="headerlink" title="ResultSetMetaData"></a>ResultSetMetaData</h4><p>结果集的元数据：ResultSetMetaData rsmd &#x3D; res.getMetaData();</p>
<p>获取列数：</p>
<p>​	int columnCount &#x3D; rsmd.getColumnCount();</p>
<p> 获取列名：</p>
<p>​	String columnName &#x3D; rsmd.getColumnLabel(i + 1);</p>
<h3 id="CURD操作"><a href="#CURD操作" class="headerlink" title="CURD操作"></a>CURD操作</h3><ul>
<li>数据库连接被用于向数据库服务器发送命令和 SQL 语句，并接受数据库服务器返回的结果。其实一个数据库连接就是一个Socket连接。</li>
<li>在 java.sql 包中有 3 个接口分别定义了对数据库的调用的不同方式：<ul>
<li>Statement：用于执行静态 SQL 语句并返回它所生成结果的对象。</li>
<li>PrepatedStatement：SQL 语句被预编译并存储在此对象中，可以使用此对象多次高效地执行该语句。</li>
<li>CallableStatement：用于执行 SQL 存储过程</li>
</ul>
</li>
</ul>
<img src="MySQL/image-20220402230653825.png" alt="image-20220402230653825" style="zoom:80%;" />

<h4 id="增-x2F-删-x2F-改：通用"><a href="#增-x2F-删-x2F-改：通用" class="headerlink" title="增&#x2F;删&#x2F;改：通用"></a>增&#x2F;删&#x2F;改：通用</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">commonUpdate</span><span class="params">(String sql, Object... args)</span>&#123;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//数据库建立连接</span></span><br><span class="line">        conn = JDBCUtils.getConnection();</span><br><span class="line">        <span class="comment">//预编译SQL</span></span><br><span class="line">        ps = conn.prepareStatement(sql);</span><br><span class="line">        <span class="comment">//填充占位符</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length; i++) &#123;</span><br><span class="line">            ps.setObject(i+<span class="number">1</span>,args[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//执行SQL</span></span><br><span class="line">        ps.execute();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="comment">//关闭连接</span></span><br><span class="line">        JDBCUtils.closeResource(conn,ps);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="查询：通用"><a href="#查询：通用" class="headerlink" title="查询：通用"></a>查询：通用</h4><ul>
<li><p>查询与增删改的区别，查询返回结果集ResultSet</p>
</li>
<li><p>使用next方法检查结果集中是否存在数据</p>
</li>
<li><p>有数据则指针下移看，指向数据，无数据则指针不下移</p>
<p>resultSet.next方法类似iterate.hasNext 与 iterate.next的功能综合版本，但是不会返回数据</p>
</li>
<li><p>是通过索引获取当前行的数据</p>
</li>
<li><p>推荐将存储到对象之中</p>
</li>
</ul>
<p><strong>针对单表进行查询</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Customer 表进行查询</span></span><br><span class="line"><span class="keyword">public</span> Customer <span class="title function_">CommonqueryTest</span><span class="params">(String sql,Object... args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">//连接数据库</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JDBCUtils.getConnection();</span><br><span class="line">		<span class="comment">//预编译SQL</span></span><br><span class="line">		<span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br><span class="line">		<span class="comment">//填充占位符</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length; i++) &#123;</span><br><span class="line">			ps.setObject(i+<span class="number">1</span>,args[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//返回结果集</span></span><br><span class="line">		<span class="type">ResultSet</span> <span class="variable">res</span> <span class="operator">=</span> ps.executeQuery();</span><br><span class="line">		<span class="comment">//获取结果集的元数据</span></span><br><span class="line">		<span class="type">ResultSetMetaData</span> <span class="variable">rsmd</span> <span class="operator">=</span> res.getMetaData();</span><br><span class="line">    	<span class="comment">//获取结果集的列数</span></span><br><span class="line">		<span class="type">int</span> <span class="variable">columnCount</span> <span class="operator">=</span> rsmd.getColumnCount();</span><br><span class="line">		<span class="comment">//判断结果集中是否存在对象，将指针指向数据行</span></span><br><span class="line">		<span class="keyword">if</span>(res.next())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Customer</span>();</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; columnCount; i++) &#123;</span><br><span class="line">				<span class="comment">//获取列值</span></span><br><span class="line">				<span class="type">Object</span> <span class="variable">columnValue</span> <span class="operator">=</span> res.getObject(i + <span class="number">1</span>);</span><br><span class="line">                <span class="comment">//获取列名（属性名）</span></span><br><span class="line">				<span class="type">String</span> <span class="variable">columnName</span> <span class="operator">=</span> rsmd.getColumnLabel(i + <span class="number">1</span>);</span><br><span class="line">				<span class="comment">//通过反射修改类的属性值</span></span><br><span class="line">                <span class="comment">//反射类字段值</span></span><br><span class="line">				<span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> Customer.class.getDeclaredField(columnName);</span><br><span class="line">				<span class="comment">//访问私有字段</span></span><br><span class="line">				field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">				<span class="comment">//设置值</span></span><br><span class="line">				field.set(customer,columnValue);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> customer;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p><strong>针对通用表进行查询</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;T&gt; T <span class="title function_">CommonqueryTest2</span><span class="params">(Class&lt;T&gt; clazz, String sql,Object... args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">//连接数据库</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JDBCUtils.getConnection();</span><br><span class="line">		<span class="comment">//预编译</span></span><br><span class="line">		<span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br><span class="line">		<span class="comment">//填充占位符</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length; i++) &#123;</span><br><span class="line">			ps.setObject(i+<span class="number">1</span>,args[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//查询获取结果集</span></span><br><span class="line">		<span class="type">ResultSet</span> <span class="variable">res</span> <span class="operator">=</span> ps.executeQuery();</span><br><span class="line">		<span class="comment">//获取结果集的元数据</span></span><br><span class="line">		<span class="type">ResultSetMetaData</span> <span class="variable">rsmd</span> <span class="operator">=</span> res.getMetaData();</span><br><span class="line">		<span class="type">int</span> <span class="variable">columnCount</span> <span class="operator">=</span> rsmd.getColumnCount();</span><br><span class="line">		<span class="comment">//获取结果集</span></span><br><span class="line">		<span class="keyword">if</span>(res.next())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="type">T</span> <span class="variable">t</span> <span class="operator">=</span> clazz.newInstance();</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; columnCount; i++) &#123;</span><br><span class="line">				<span class="comment">//获取列名、值</span></span><br><span class="line">				<span class="type">Object</span> <span class="variable">columnValue</span> <span class="operator">=</span> res.getObject(i + <span class="number">1</span>);</span><br><span class="line">				<span class="type">String</span> <span class="variable">columnName</span> <span class="operator">=</span> rsmd.getColumnLabel(i + <span class="number">1</span>);</span><br><span class="line">                <span class="comment">//getColumnLabel：先获取别名，没有别名获取字段名</span></span><br><span class="line">				<span class="comment">//反射类字段值</span></span><br><span class="line">				<span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> clazz.getDeclaredField(columnName);</span><br><span class="line">				<span class="comment">//访问私有字段</span></span><br><span class="line">				field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">				<span class="comment">//设置值</span></span><br><span class="line">				field.set(t,columnValue);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> t;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p><strong>返回查询的集合</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;T&gt; List&lt;T&gt; <span class="title function_">CommonqueryTest3</span><span class="params">(Class&lt;T&gt; clazz, String sql, Object... args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">//连接数据库</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JDBCUtils.getConnection();</span><br><span class="line">		<span class="comment">//预编译</span></span><br><span class="line">		<span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br><span class="line">		<span class="comment">//填充占位符</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length; i++) &#123;</span><br><span class="line">			ps.setObject(i+<span class="number">1</span>,args[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//查询获取结果集</span></span><br><span class="line">		<span class="type">ResultSet</span> <span class="variable">res</span> <span class="operator">=</span> ps.executeQuery();</span><br><span class="line">		<span class="comment">//获取结果集的元数据</span></span><br><span class="line">		<span class="type">ResultSetMetaData</span> <span class="variable">rsmd</span> <span class="operator">=</span> res.getMetaData();</span><br><span class="line">		<span class="type">int</span> <span class="variable">columnCount</span> <span class="operator">=</span> rsmd.getColumnCount();</span><br><span class="line">		ArrayList&lt;T&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">		<span class="comment">//获取结果集</span></span><br><span class="line">		<span class="keyword">while</span>(res.next())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="type">T</span> <span class="variable">t</span> <span class="operator">=</span> clazz.newInstance();</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; columnCount; i++) &#123;</span><br><span class="line">				<span class="comment">//获取列名、值</span></span><br><span class="line">				<span class="type">Object</span> <span class="variable">columnValue</span> <span class="operator">=</span> res.getObject(i + <span class="number">1</span>);</span><br><span class="line">				<span class="type">String</span> <span class="variable">columnName</span> <span class="operator">=</span> rsmd.getColumnLabel(i + <span class="number">1</span>);</span><br><span class="line">				<span class="comment">//反射类字段值</span></span><br><span class="line">				<span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> clazz.getDeclaredField(columnName);</span><br><span class="line">				<span class="comment">//访问私有字段</span></span><br><span class="line">				field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">				<span class="comment">//设置值</span></span><br><span class="line">				field.set(t,columnValue);</span><br><span class="line">			&#125;</span><br><span class="line">			list.add(t);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> list;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>ResultSetMetaData ：结果集的元数据：对结果集进行描述的数据 </p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>根据ORM编程思想，数据库一行数据对应一个Java对象，数据库一个字段对应Java类的一个属性，所以当数据库字段与Java属性名不一致会报错</p>
<p><strong>数据库字段名要与Java类中属性名不一致：则必须在SQL语句中给字段起别名</strong></p>
<p><strong>思维导图</strong></p>
<p><img src="MySQL/image-20220402230725522.png" alt="image-20220402230725522" style="zoom:80%;" /><img src="/MySQL/image-20220402230801923.png" alt="image-20220402230801923"></p>
<h3 id="JDBCUtils工具类"><a href="#JDBCUtils工具类" class="headerlink" title="JDBCUtils工具类"></a>JDBCUtils工具类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDBCUtils</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">		<span class="comment">//通过类加载器 获取 数据库文件中的配置信息</span></span><br><span class="line">		<span class="type">ClassLoader</span> <span class="variable">loader</span> <span class="operator">=</span> ClassLoader.getSystemClassLoader();</span><br><span class="line">		<span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> loader.getResourceAsStream(<span class="string">&quot;jdbc.properties&quot;</span>);</span><br><span class="line">		<span class="type">Properties</span> <span class="variable">info</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">		info.load(is);</span><br><span class="line">		<span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> info.getProperty(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">		<span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> info.getProperty(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">		<span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> info.getProperty(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">		<span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> info.getProperty(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">		<span class="comment">//通过反射加载驱动类</span></span><br><span class="line">		Class.forName(driver);</span><br><span class="line">		<span class="comment">//连接数据库</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> DriverManager.getConnection(url, user, password);</span><br><span class="line">		<span class="keyword">return</span> con;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">closeResource</span><span class="params">(Connection con, Statement ps, ResultSet re)</span> &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (re != <span class="literal">null</span>)</span><br><span class="line">				re.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException throwables) &#123;</span><br><span class="line">			throwables.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (ps != <span class="literal">null</span>)</span><br><span class="line">				ps.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException throwables) &#123;</span><br><span class="line">			throwables.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (con != <span class="literal">null</span>)</span><br><span class="line">				con.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException throwables) &#123;</span><br><span class="line">			throwables.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="操作Blob"><a href="#操作Blob" class="headerlink" title="操作Blob"></a>操作Blob</h3><ul>
<li><p>MySQL中，BLOB是一个二进制大型对象，是一个可以存储大量数据的容器，它能容纳不同大小的数据。</p>
</li>
<li><p>插入BLOB类型的数据必须使用PreparedStatement，因为BLOB类型的数据无法使用字符串拼接写的。</p>
</li>
<li><p>MySQL的四种BLOB类型(除了在存储的最大信息量上不同外，他们是等同的)</p>
<img src="MySQL/image-20220402230806064.png" alt="image-20220402230806064" style="zoom:80%;" />
</li>
<li><p>实际使用中根据需要存入的数据大小定义不同的BLOB类型。</p>
</li>
<li><p>需要注意的是：如果存储的文件过大，数据库的性能会下降。</p>
</li>
<li><p>如果在指定了相关的Blob类型以后，还报错：xxx too large，那么在mysql的安装目录下，找my.ini文件加上如下的配置参数：<strong>max_allowed_packet&#x3D;16M</strong>。同时注意：修改了my.ini文件之后，需要重新启动mysql服务。</p>
</li>
</ul>
<h4 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span> ~~<span class="keyword">throws</span> Exception~~ &#123; <span class="comment">//正式应该使用Try catch进行操作</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JDBCUtils.getConnection();</span><br><span class="line">        <span class="comment">//改使用update进行操作</span></span><br><span class="line">		<span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;INSERT INTO customers(NAME,email,photo) VALUES(?,?,?);&quot;</span>;</span><br><span class="line">		<span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br><span class="line">		ps.setObject(<span class="number">1</span>,<span class="string">&quot;Tom&quot;</span>);</span><br><span class="line">		ps.setObject(<span class="number">2</span>,<span class="string">&quot;Tom@163.com&quot;</span>);</span><br><span class="line">		<span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;a1.jpg&quot;</span>));</span><br><span class="line">		ps.setBlob(<span class="number">3</span>,is);</span><br><span class="line">		ps.execute();</span><br><span class="line">		is.close();</span><br><span class="line">		JDBCUtils.closeResource(conn,ps);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span> ~~<span class="keyword">throws</span> Exception~~ &#123; <span class="comment">//正式应该使用Try catch进行操作</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JDBCUtils.getConnection();</span><br><span class="line">		<span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT NAME,email,photo FROM customers WHERE id = ?;&quot;</span>;</span><br><span class="line">		<span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br><span class="line">		ps.setObject(<span class="number">1</span>,<span class="number">27</span>);</span><br><span class="line">		<span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> ps.executeQuery();</span><br><span class="line">		<span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">			<span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;Name&quot;</span>);</span><br><span class="line">			<span class="type">String</span> <span class="variable">email</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;email&quot;</span>);</span><br><span class="line">			System.out.println(<span class="string">&quot;Name: &quot;</span> + name + <span class="string">&quot;email: &quot;</span> + email);</span><br><span class="line"></span><br><span class="line">			<span class="comment">//将Blob类型的数据保存到本地</span></span><br><span class="line">			<span class="type">Blob</span> <span class="variable">photo</span> <span class="operator">=</span> rs.getBlob(<span class="string">&quot;photo&quot;</span>);</span><br><span class="line">			<span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> photo.getBinaryStream();</span><br><span class="line">			<span class="type">FileOutputStream</span> <span class="variable">fis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;pic.jpg&quot;</span>));</span><br><span class="line">			<span class="type">byte</span>[] buffer = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">			<span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">while</span>((len = is.read(buffer)) != -<span class="number">1</span>)&#123;</span><br><span class="line">				fis.write(buffer,<span class="number">0</span>,len);</span><br><span class="line">			&#125;</span><br><span class="line">			fis.close();</span><br><span class="line">			is.close();</span><br><span class="line">		&#125;</span><br><span class="line">		JDBCUtils.closeResource(conn,ps);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="批量操作"><a href="#批量操作" class="headerlink" title="批量操作"></a>批量操作</h3><h4 id="方式一"><a href="#方式一" class="headerlink" title="方式一"></a>方式一</h4><p>使用Statement进行批量添加</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test3</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JDBCUtils.getConnection();</span><br><span class="line">    <span class="type">Statement</span> <span class="variable">st</span> <span class="operator">=</span> conn.createStatement();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100000</span>; i++) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;INSERT INTO goods(NAME) VALUES(&#x27;Jack_&quot;</span>+i+<span class="string">&quot;&#x27;)&quot;</span>;</span><br><span class="line">        st.execute(sql);</span><br><span class="line">    &#125;</span><br><span class="line">    JDBCUtils.closeResource(conn,st);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="方式二"><a href="#方式二" class="headerlink" title="方式二"></a>方式二</h4><p>使用PrepaerStatement进行批量添加</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test4</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JDBCUtils.getConnection();</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;INSERT INTO goods(NAME) VALUES(?);&quot;</span>;</span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100000</span>; i++) &#123;</span><br><span class="line">        ps.setObject(<span class="number">1</span>,<span class="string">&quot;jack_&quot;</span>+i);</span><br><span class="line">        ps.execute();</span><br><span class="line">    &#125;</span><br><span class="line">    JDBCUtils.closeResource(conn,ps);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>方式一：每次都会创建字符串变量，并且对SQL进行检查 </p>
<p>方式二：创建SQL缓存，不会多次创建，只对SQL检查一次 </p>
<h4 id="方式三"><a href="#方式三" class="headerlink" title="方式三"></a>方式三</h4><p>通过将需要执行的SQL缓存下来，批量执行，提升效率，5.1.7之前不支持批处理</p>
<ul>
<li><p>使用 <strong>addBatch() &#x2F; executeBatch() &#x2F; clearBatch()</strong></p>
</li>
<li><p>mysql服务器默认是关闭批处理的，我们需要通过一个参数，让mysql开启批处理的支持。</p>
<p><code>?rewriteBatchedStatements=true</code> 写在配置文件的url后面</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test5</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JDBCUtils.getConnection();</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;INSERT INTO goods(NAME) VALUES(?)&quot;</span>;</span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= <span class="number">100000</span>; i++) &#123;</span><br><span class="line">        ps.setObject(<span class="number">1</span>,<span class="string">&quot;jack_&quot;</span>+i);</span><br><span class="line">        <span class="comment">//缓存SQL</span></span><br><span class="line">        ps.addBatch();</span><br><span class="line">        <span class="keyword">if</span>(i%<span class="number">500</span> == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="comment">//将缓存的SQL批量执行</span></span><br><span class="line">            ps.executeBatch();</span><br><span class="line">            <span class="comment">//清理缓存</span></span><br><span class="line">            ps.clearBatch();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    JDBCUtils.closeResource(conn,ps);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="方式四"><a href="#方式四" class="headerlink" title="方式四"></a>方式四</h4><p>将自动提交事务关闭，全部SQL执行完毕之后再提交</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test6</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JDBCUtils.getConnection();</span><br><span class="line">    <span class="comment">//关闭事务自动提交</span></span><br><span class="line">    conn.setAutoCommit(<span class="literal">false</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;INSERT INTO goods(NAME) VALUES(?)&quot;</span>;</span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= <span class="number">1000000</span>; i++) &#123;</span><br><span class="line">        ps.setObject(<span class="number">1</span>,<span class="string">&quot;jack_&quot;</span>+i);</span><br><span class="line">        ps.addBatch();</span><br><span class="line">        <span class="keyword">if</span>(i%<span class="number">500</span> == <span class="number">0</span>)&#123;</span><br><span class="line">            ps.executeBatch();</span><br><span class="line">            ps.clearBatch();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//提交事务</span></span><br><span class="line">    conn.commit();</span><br><span class="line">    JDBCUtils.closeResource(conn,ps);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="JDBC事务"><a href="#JDBC事务" class="headerlink" title="JDBC事务"></a>JDBC事务</h2><ul>
<li>数据一旦提交，就不可回滚</li>
<li>哪些操作会导致数据的自动提交<ol>
<li>DDL操作一旦执行，就会自行提交 【set_autocommit &#x3D; false 对DDL操作无效】</li>
<li>DML默认情况下一旦执行，就会自动提交</li>
<li>默认再关闭连接时，会自动的提交数据</li>
</ol>
</li>
</ul>
<h3 id="模拟事务"><a href="#模拟事务" class="headerlink" title="模拟事务"></a>模拟事务</h3><ul>
<li>调用 Connection 对象的 **setAutoCommit(false)**取消自动提交事务</li>
<li>在所有的 SQL 语句都成功执行后，调用 <strong>commit()</strong> 方法提交事务</li>
<li>在出现异常时，调用 <strong>rollback()</strong> 方法回滚事务</li>
<li>若此时 Connection 没有被关闭，还可能被重复使用，则需要恢复其自动提交状态 setAutoCommit(true)。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test3</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//1. 获取连接</span></span><br><span class="line">        conn = JDBCUtills.getConnection();</span><br><span class="line">        <span class="comment">//2. 开启事务</span></span><br><span class="line">        conn.setAutoCommit(<span class="literal">false</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql1</span> <span class="operator">=</span> <span class="string">&quot;UPDATE user_table SET balance = 1100 WHERE USER = ?&quot;</span>;</span><br><span class="line">        <span class="comment">//3. 进行数据库操作</span></span><br><span class="line">        updateWithTx(conn,sql1,<span class="string">&quot;AA&quot;</span>);</span><br><span class="line">        <span class="comment">//模拟网络异常</span></span><br><span class="line">        System.out.println(<span class="number">10</span>/<span class="number">0</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql2</span> <span class="operator">=</span> <span class="string">&quot;UPDATE user_table SET balance = 900 WHERE USER = ?&quot;</span>;</span><br><span class="line">        updateWithTx(conn,sql2,<span class="string">&quot;BB&quot;</span>);</span><br><span class="line">        <span class="comment">//4.提交事务</span></span><br><span class="line">        conn.commit();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//5.异常回滚</span></span><br><span class="line">            conn.rollback();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException throwables) &#123;</span><br><span class="line">            throwables.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//6.恢复DML自动提交,主要针对数据库连接池</span></span><br><span class="line">            conn.setAutoCommit(<span class="literal">true</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException throwables) &#123;</span><br><span class="line">            throwables.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//7.关闭资源</span></span><br><span class="line">        JDBCUtills.closeResource(conn,<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//通用更新操作，再updateWithTx方法之中不要进行数据库的关闭 数据库连接的关闭会导致事务自动提交</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateWithTx</span><span class="params">(Connection conn,String sql, Object... args)</span>&#123;</span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        ps = conn.prepareStatement(sql);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length; i++) &#123;</span><br><span class="line">            ps.setObject(i+<span class="number">1</span>,args[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        ps.execute();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">finally</span> &#123;</span><br><span class="line">        JDBCUtills.closeResource(<span class="literal">null</span>,ps);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Oracle 支持的 2 种事务隔离级别：<strong>READ COMMITED</strong>, SERIALIZABLE，默认的事务隔离级别为: <strong>READ COMMITED</strong></li>
<li>Mysql 支持 4 种事务隔离级别：Mysql 默认的事务隔离级别为: REPEATABLE READ</li>
</ul>
<h3 id="隔离级别问题"><a href="#隔离级别问题" class="headerlink" title="隔离级别问题"></a>隔离级别问题</h3><img src="MySQL/image-20220402230843770.png" alt="image-20220402230843770" style="zoom:80%;" />

<h4 id="脏读"><a href="#脏读" class="headerlink" title="脏读"></a>脏读</h4><p> T2在T1读取数据的时候，对数据进行了更新，后续对数据进行了回滚操作 所以T1在后续的两次读取中看到的数据并不相同.</p>
<h4 id="不可重复读"><a href="#不可重复读" class="headerlink" title="不可重复读"></a>不可重复读</h4><p>当T1第一次读取数据时与第二次读取数据中间的时间 T2对数据进行了更新，并且提交 然后T1再对数据进行读取，发现两次数据并不一致。</p>
<h4 id="幻读"><a href="#幻读" class="headerlink" title="幻读"></a>幻读</h4><p>当T1第一次读取数据后，T2插入了一条新数据，并且提交 T1再对数据进行了更新，发现受影响行数与第一次读取到数据行数不一致</p>
<h2 id="Dao"><a href="#Dao" class="headerlink" title="Dao"></a>Dao</h2><h3 id="Dao相关实现类"><a href="#Dao相关实现类" class="headerlink" title="Dao相关实现类"></a>Dao相关实现类</h3><ul>
<li>DAO：Data Access Object访问数据信息的类和接口，包括了对数据的CRUD，而不包含任何业务相关的信息。有时也称作：BaseDAO</li>
<li>作用：为了实现功能的模块化，更有利于代码的维护和升级</li>
</ul>
<h3 id="BaseDao的实现"><a href="#BaseDao的实现" class="headerlink" title="BaseDao的实现"></a>BaseDao的实现</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*通用的增删改查操作</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">BaseDao</span> &#123;</span><br><span class="line">    <span class="comment">//事务通用多条数据查询</span></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; List&lt;T&gt; <span class="title function_">getInstance</span><span class="params">(Connection conn, Class&lt;T&gt; clazz, String sql, Object... args)</span> &#123;</span><br><span class="line">        List&lt;T&gt; list = <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ps = conn.prepareStatement(sql);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length; i++) &#123;</span><br><span class="line">                ps.setObject(i + <span class="number">1</span>, args[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            rs = ps.executeQuery();</span><br><span class="line">            <span class="type">ResultSetMetaData</span> <span class="variable">rsmd</span> <span class="operator">=</span> rs.getMetaData();</span><br><span class="line">            <span class="type">int</span> <span class="variable">columnCount</span> <span class="operator">=</span> rsmd.getColumnCount();</span><br><span class="line">            list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">                <span class="type">T</span> <span class="variable">t</span> <span class="operator">=</span> clazz.newInstance();</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; columnCount; i++) &#123;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">columnLabel</span> <span class="operator">=</span> rsmd.getColumnLabel(i + <span class="number">1</span>);</span><br><span class="line">                    <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> rs.getObject(i + <span class="number">1</span>);</span><br><span class="line">                    <span class="comment">//反射类所有字段，并且赋值</span></span><br><span class="line">                    <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> clazz.getDeclaredField(columnLabel);</span><br><span class="line">                    field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">                    field.set(t, value);</span><br><span class="line">                &#125;</span><br><span class="line">                list.add(t);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception throwables) &#123;</span><br><span class="line">            throwables.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            JDBCUtills.closeResource(<span class="literal">null</span>, ps, rs);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//事务通用更新</span></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="type">int</span> <span class="title function_">getUpdate</span><span class="params">(Connection conn, String sql, Object... args)</span> &#123;</span><br><span class="line">        List&lt;T&gt; list = <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">row</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ps = conn.prepareStatement(sql);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length; i++) &#123;</span><br><span class="line">                ps.setObject(i + <span class="number">1</span>, args[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            row = ps.executeUpdate();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception throwables) &#123;</span><br><span class="line">            throwables.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            JDBCUtills.closeResource(<span class="literal">null</span>, ps);</span><br><span class="line">            <span class="keyword">return</span> row;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//事务通用一条数据查询</span></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; T <span class="title function_">getValue</span><span class="params">(Connection conn, String sql, Object... args)</span> &#123;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">val</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ps = conn.prepareStatement(sql);</span><br><span class="line">            val = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length; i++) &#123;</span><br><span class="line">                ps.setObject(i + <span class="number">1</span>, args[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            rs = ps.executeQuery();</span><br><span class="line">            <span class="keyword">if</span> (rs.next()) &#123;</span><br><span class="line">                val = rs.getObject(<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException throwables) &#123;</span><br><span class="line">            throwables.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            JDBCUtills.closeResource(<span class="literal">null</span>, ps, rs);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (T) val;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Dao接口"><a href="#Dao接口" class="headerlink" title="Dao接口"></a>Dao接口</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">CustomerDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将cust对象添加到数据库之中</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(Connection conn, Customer cust)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//根据id号删除数据库中customer数据</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteById</span><span class="params">(Connection conn, <span class="type">int</span> id)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//根据id号修改数据库中customer数据</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">updateById</span><span class="params">(Connection conn,Customer cust, <span class="type">int</span> id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//根据id号查詢数据库中customer数据</span></span><br><span class="line">    Customer <span class="title function_">getCustomerById</span><span class="params">(Connection conn, <span class="type">int</span> id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//查询数据库customer表中所有的数据</span></span><br><span class="line">    List&lt;Customer&gt; <span class="title function_">getAll</span><span class="params">(Connection conn)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//查询数据库customer表中所有的行数</span></span><br><span class="line">    <span class="type">long</span> <span class="title function_">getCount</span><span class="params">(Connection conn)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//查询数据库customer表中年龄最大的生日</span></span><br><span class="line">    Date <span class="title function_">getMaxBirth</span><span class="params">(Connection conn)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Dao接口实现类"><a href="#Dao接口实现类" class="headerlink" title="Dao接口实现类"></a>Dao接口实现类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomerDaoImpl</span> <span class="keyword">extends</span> <span class="title class_">BaseDao</span> <span class="keyword">implements</span> <span class="title class_">CustomerDao</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(Connection conn, Customer cust)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into customers(name,email,birth) values(?,?,?)&quot;</span>;</span><br><span class="line">        getUpdate(conn,sql,cust.getName(),cust.getEmial(),cust.getBirth());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteById</span><span class="params">(Connection conn, <span class="type">int</span> id)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from customers where id = ?&quot;</span>;</span><br><span class="line">        getUpdate(conn,sql,id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateById</span><span class="params">(Connection conn, Customer cust, <span class="type">int</span> id)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update customers set name = ?, email = ?, birth = ? where id = ?&quot;</span>;</span><br><span class="line">        getUpdate(conn,sql,cust.getName(),cust.getEmial(),cust.getBirth(),id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Customer <span class="title function_">getCustomerById</span><span class="params">(Connection conn, <span class="type">int</span> id)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select name, email, birth from customers where id = ?&quot;</span>;</span><br><span class="line">        List&lt;Customer&gt; list = getInstance(conn, Customer.class, sql, id);</span><br><span class="line">        <span class="keyword">return</span> list.size() &gt; <span class="number">0</span> ? list.get(<span class="number">0</span>) :<span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Customer&gt; <span class="title function_">getAll</span><span class="params">(Connection conn)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select name, email, birth from customers&quot;</span>;</span><br><span class="line">        List&lt;Customer&gt; list = getInstance(conn, Customer.class, sql);</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">getCount</span><span class="params">(Connection conn)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select count(*) from customers&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span>  getValue(conn,sql);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Date <span class="title function_">getMaxBirth</span><span class="params">(Connection conn)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select max(birth) from customers&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> getValue(conn,sql);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h3><p><strong>BaseDao</strong>：实现对表的通用操作：通用增删改查</p>
<p><strong>Dao接口</strong>：实现对于某个表的的抽象方法</p>
<p><strong>Dao接口实现类</strong>：实现接口中的抽象方法</p>
<p>BaseDao类中增删改查的方法，没有关闭conn的操作 conn关闭会自动提交事务</p>
<h2 id="数据库连接池"><a href="#数据库连接池" class="headerlink" title="数据库连接池"></a>数据库连接池</h2><p>数据库连接池技术</p>
<ul>
<li><p><strong>数据库连接池的基本思想</strong>：为数据库连接建立一个“缓冲池”。预先在缓冲池中放入一定数量的连接，当需要建立数据库连接时，只需从“缓冲池”中取出一个，使用完毕之后再放回去。</p>
</li>
<li><p><strong>数据库连接池</strong>负责分配、管理和释放数据库连接，它<strong>允许应用程序重复使用一个现有的数据库连接，而不是重新建立一个</strong>。</p>
</li>
<li><p>数据库连接池在初始化时将创建一定数量的数据库连接放到连接池中，这些数据库连接的数量是由<strong>最小数据库连接数来设定</strong>的。无论这些数据库连接是否被使用，连接池都将一直保证至少拥有这么多的连接数量。连接池的<strong>最大数据库连接数量</strong>限定了这个连接池能占有的最大连接数，当应用程序向连接池请求的连接数超过最大连接数量时，这些请求将被加入到等待队列中。</p>
</li>
<li><p>工作原理</p>
</li>
</ul>
<img src="MySQL/image-20220402230859968.png" alt="image-20220402230859968" style="zoom:80%;" />

<p><strong>数据库连接池技术的优点</strong></p>
<ol>
<li>提高程序的响应速度（减少创建连接的响应时间）</li>
<li>降低资源的消耗（重复使用已经创建好的连接）</li>
<li>便于连接的管理</li>
</ol>
<p><strong>多种开源的数据库连接池</strong></p>
<ul>
<li>JDBC 的数据库连接池使用 javax.sql.DataSource 来表示，DataSource 只是一个接口，该接口通常由服务器(Weblogic, WebSphere, Tomcat)提供实现，也有一些开源组织提供实现：<ul>
<li><strong>DBCP</strong> 是Apache提供的数据库连接池。tomcat 服务器自带dbcp数据库连接池。<strong>速度相对c3p0较快</strong>，但因自身存在BUG，Hibernate3已不再提供支持。</li>
<li><strong>C3P0</strong> 是一个开源组织提供的一个数据库连接池，速度相对较慢，稳定性还可以。hibernate官方推荐使用</li>
<li><strong>Proxool</strong> 是sourceforge下的一个开源项目数据库连接池，有监控连接池状态的功能，<strong>稳定性较c3p0差一点</strong></li>
<li><strong>BoneCP</strong> 是一个开源组织提供的数据库连接池，速度快</li>
<li><strong>Druid</strong> 是阿里提供的数据库连接池，据说是集DBCP 、C3P0 、Proxool 优点于一身的数据库连接池，但是速度不确定是否有BoneCP快</li>
</ul>
</li>
<li><strong>DataSource</strong> 通常被称为数据源，它包含连接池和连接池管理两个部分，习惯上也经常把 DataSource 称为连接池，DataSource用来取代DriverManager来获取Connection，获取速度快，同时可以大幅度提高数据库访问速度。</li>
<li>特别注意：<ul>
<li>数据源和数据库连接不同，数据源无需创建多个，它是产生数据库连接的工厂，因此<strong>整个应用只需要一个数据源即可。</strong></li>
<li>当数据库访问结束后，程序还是像以前一样关闭数据库连接：conn.close(); 但conn.close()并没有关闭数据库的物理连接，它仅仅把数据库连接释放，归还给了数据库连接池。</li>
</ul>
</li>
</ul>
<h3 id="c3p0数据库连接池"><a href="#c3p0数据库连接池" class="headerlink" title="c3p0数据库连接池"></a>c3p0数据库连接池</h3><p>连接方式1：不推荐</p>
<ol>
<li>加载启动，导入c3p0的jar包</li>
<li>c3p0连接数据库</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">ComboPooledDataSource</span> <span class="variable">cpds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ComboPooledDataSource</span>();</span><br><span class="line">        cpds.setDriverClass( <span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span> ); <span class="comment">//loads the jdbc driver</span></span><br><span class="line">        cpds.setJdbcUrl( <span class="string">&quot;jdbc:mysql://localhost:3306/test&quot;</span> );</span><br><span class="line">        cpds.setUser(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        cpds.setPassword(<span class="string">&quot;123&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置数据库连接池</span></span><br><span class="line">        <span class="comment">//设置初始化数据库连接池的连接数</span></span><br><span class="line">        cpds.setInitialPoolSize(<span class="number">10</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> cpds.getConnection();</span><br><span class="line"></span><br><span class="line">		<span class="comment">//销毁c3p0连接池，一般不销毁</span></span><br><span class="line">        <span class="comment">//DataSources.destroy( cpds );</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>连接方式2：推荐  使用xml配置文件连接</p>
<p>c3p0-config.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> standalone=<span class="string">&quot;no&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">c3p0-config</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- This app is massive! --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">named-config</span> <span class="attr">name</span>=<span class="string">&quot;C3po&quot;</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span>123<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcUrl&quot;</span>&gt;</span>jdbc:mysql://localhost:3306/test<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClass&quot;</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- 涉及到数据库连接池的管理的相关属性的设置 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 若数据库中连接数不足时, 一次向数据库服务器申请多少个连接 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;acquireIncrement&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 初始化数据库连接池时连接的数量 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;initialPoolSize&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 数据库连接池中的最小的数据库连接数 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;minPoolSize&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 数据库连接池中的最大的数据库连接数 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxPoolSize&quot;</span>&gt;</span>10<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- C3P0 数据库连接池可以维护的 Statement 的个数 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxStatements&quot;</span>&gt;</span>20<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 每个连接同时可以使用的 Statement 对象的个数 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxStatementsPerConnection&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">named-config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">c3p0-config</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//数据库连接池-饿汉式</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">ComboPooledDataSource</span> <span class="variable">cpds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ComboPooledDataSource</span>(<span class="string">&quot;C3po&quot;</span>);</span><br><span class="line"><span class="comment">//返回连接</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> cpds.getConnection();</span><br><span class="line">    <span class="keyword">return</span> conn;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>💡创建c3p0-config.xml配置文件的方式进行数据库的连接，c3p0-config.xml配置文件创建在src项目根目录下会自动加载配置文件</p>
<h3 id="dbcp数据库连接池"><a href="#dbcp数据库连接池" class="headerlink" title="dbcp数据库连接池"></a>dbcp数据库连接池</h3><ul>
<li>加载驱动，导入dbcp的jar包</li>
<li>dbcp依赖pool，需要导入pool的jar包</li>
</ul>
<p>方式一：硬编码，不推荐</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">    <span class="comment">//创建dbcp的数据库连接池</span></span><br><span class="line">    <span class="type">BasicDataSource</span> <span class="variable">source</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BasicDataSource</span>();</span><br><span class="line">    source.setDriverClassName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">    source.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">    source.setPassword(<span class="string">&quot;123&quot;</span>);</span><br><span class="line">    source.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/test&quot;</span>);</span><br><span class="line">    <span class="comment">//设置数据库连接池</span></span><br><span class="line">    source.setInitialSize(<span class="number">10</span>);</span><br><span class="line">    source.setMaxActive(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> source.getConnection();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>方式二：配置文件，推荐</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">//读取properties配置文件</span></span><br><span class="line">    <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> ClassLoader.getSystemResourceAsStream(<span class="string">&quot;dbcp2.properties&quot;</span>);</span><br><span class="line">    <span class="type">Properties</span> <span class="variable">info</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">    info.load(is);</span><br><span class="line">    <span class="comment">//创建dbcp的数据库连接池</span></span><br><span class="line">    <span class="type">DataSource</span> <span class="variable">source</span> <span class="operator">=</span> BasicDataSourceFactory.createDataSource(info);</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> source.getConnection();</span><br><span class="line">    System.out.println(conn);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="⭐druid数据库连接池"><a href="#⭐druid数据库连接池" class="headerlink" title="⭐druid数据库连接池"></a>⭐druid数据库连接池</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">driverClassName</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/ks</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">4213</span></span><br><span class="line"><span class="comment">##初始化连接数量</span></span><br><span class="line"><span class="attr">initialSize</span>=<span class="string">5</span></span><br><span class="line"><span class="comment">##最大连接数量</span></span><br><span class="line"><span class="attr">maxActive</span>=<span class="string">10</span></span><br><span class="line"><span class="comment">##最大等待时间</span></span><br><span class="line"><span class="attr">maxWait</span>=<span class="string">3000</span></span><br></pre></td></tr></table></figure>

<ul>
<li>加载驱动，导入druid的jar包</li>
<li>方式一：不推荐，硬编码</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">source</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        <span class="comment">//硬编码加载</span></span><br><span class="line">        source.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        source.setPassword(<span class="string">&quot;123&quot;</span>);</span><br><span class="line">        source.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/test&quot;</span>);</span><br><span class="line">        source.setDriverClassName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//多态调用连接方法</span></span><br><span class="line">        <span class="type">DataSource</span> <span class="variable">s1</span> <span class="operator">=</span> source;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> s1.getConnection();</span><br><span class="line">        System.out.println(conn);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>方式二：推荐，配置文件</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Properties</span> <span class="variable">info</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        <span class="comment">//类加载器</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> ClassLoader.getSystemResourceAsStream(<span class="string">&quot;dbcp.properties&quot;</span>);</span><br><span class="line">        info.load(is);</span><br><span class="line">        <span class="type">DataSource</span> <span class="variable">source</span> <span class="operator">=</span> DruidDataSourceFactory.createDataSource(info);</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> source.getConnection();</span><br><span class="line">        System.out.println(conn);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="Spring-JDBC"><a href="#Spring-JDBC" class="headerlink" title="Spring JDBC"></a>Spring JDBC</h3><p>提供了一个JDBCTemplate对象</p>
<ol>
<li><p>导入jar包</p>
</li>
<li><p>创建jdbcTemplate对象，依赖数据源DataSource</p>
<p>jdbcTemplate template &#x3D; new jdbcTemplate(ds);</p>
</li>
<li><p>调用jdbctemplate的方法是来完成操作，直接执行sql语句</p>
<p>update(sql, ?, ?)：执行增删改操作</p>
<p>queryForMap()：查询结果将结果封装为Map集合；查询的结果只能为1</p>
<p>queryForList()：查询结果将结果封装为List集合；将查询的每个结果封装为Map集合</p>
<p>query()：将结果封装为JavaBean对象；利用BeanPropertyRowMapper实现类</p>
<p>queryForObject()：将结果封装为对象</p>
</li>
</ol>
<h3 id="总结-2"><a href="#总结-2" class="headerlink" title="总结"></a>总结</h3><ul>
<li><p>相比c3p0、dbcp数据库连接池，更加推荐druid</p>
</li>
<li><p>获取数据库连接池的方法时，推荐使用单例模式（饱汉式&#x2F;饿汉式）</p>
</li>
<li><p>注意：如果在servlet中使用数据库连接池，要将数据库连接池的jar包导入到WEB-INF目录下的lib目录中，因为servler项目部署到Tomcat服务器中</p>
<p>1）src 下的源文件（如：.java）经过了编译之后放在 WEB-INF&#x2F;classes 目录下</p>
<p>2）lib 包在编译前需要放在 WEB-INF 下编译后才能出现在 WEB-INF&#x2F;lib 目录下，所以除了 tomcat 自带的 jar 包（JRE）外，项目所需 jar 包都应放在 WEB-INF 的 lib 目录下，否则部署的web项目就会缺少lib包</p>
</li>
</ul>
<h1 id="Apache-DBUtils"><a href="#Apache-DBUtils" class="headerlink" title="Apache-DBUtils"></a>Apache-DBUtils</h1><p>使用PreparedStatement对CURD进行封装，底层一致，导入dbutils的jar包</p>
<ul>
<li>主要使用到QueryRunner、ResultSetHandler<T>这两个类</li>
<li>获取QueryRunner类：<strong>QueryRunner runner &#x3D; new QueryRunner();</strong><ul>
<li><strong>query</strong>方法，是用来做查询的         (connection，sql，对象，参数)</li>
<li><strong>update</strong>方法，用来做增删改操作</li>
<li><strong>batch</strong>方法，用来做批处理</li>
</ul>
</li>
</ul>
<h3 id="ResultSetHandler接口及实现类"><a href="#ResultSetHandler接口及实现类" class="headerlink" title="ResultSetHandler接口及实现类"></a>ResultSetHandler接口及实现类</h3><ul>
<li><p>该接口用于处理 java.sql.ResultSet，将数据结果集按要求转换为另一种形式。</p>
</li>
<li><p>ResultSetHandler 可以理解为接收结果的</p>
</li>
<li><p>接口的主要实现类：</p>
<ul>
<li>ArrayHandler：把结果集中的第一行数据转成对象数组。</li>
<li>ArrayListHandler：把结果集中的每一行数据都转成一个数组，再存放到List中。</li>
<li>BeanHandler：将结果集中的第一行数据封装到一个对应的JavaBean实例中。</li>
<li>BeanListHandler：将结果集中的每一行数据都封装到一个对应的JavaBean实例中，存放到List里。</li>
<li>ColumnListHandler：将结果集中某一列的数据存放到List中。</li>
<li>KeyedHandler(name)：将结果集中的每一行数据都封装到一个Map里，再把这些map再存到一个map里，其key为指定的key。</li>
<li>MapHandler：将结果集中的第一行数据封装到一个Map里，key是列名，value就是对应的值。</li>
<li>MapListHandler：将结果集中的每一行数据都封装到一个Map里，然后再存放到List</li>
<li>ScalarHandler：查询单个值对象</li>
</ul>
<p>ArrayHandler：把结果集中的第一行数据转成Object数组</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Object[] result = runner.query(con, sql, <span class="keyword">new</span> <span class="title class_">ArrayHandler</span>());</span><br><span class="line">    <span class="keyword">for</span>(Object obj : result)&#123;</span><br><span class="line">   		 System.out.print(obj);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>ArrayListHandler：把结果集中的每一行数据都转成一个数组，再存放到List中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Object[]&gt; result=  runner.query(con, sql, <span class="keyword">new</span> <span class="title class_">ArrayListHandler</span>());</span><br><span class="line">	<span class="comment">//集合的遍历</span></span><br><span class="line">    <span class="keyword">for</span>( Object[] objs  : result)&#123;</span><br><span class="line">    	<span class="comment">//遍历对象数组</span></span><br><span class="line">        <span class="keyword">for</span>(Object obj : objs)&#123;</span><br><span class="line">            System.out.print(obj+<span class="string">&#x27;  &#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    	System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>BeanHandler：将结果集中的第一行数据封装到一个对应的JavaBean对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Sort</span> <span class="variable">s</span> <span class="operator">=</span> runner.query(con, sql, <span class="keyword">new</span> <span class="title class_">BeanHandler</span>&lt;Sort&gt;(Sort.class));</span><br><span class="line">System.out.println(s);</span><br></pre></td></tr></table></figure>




<p>BeanListHandler：将结果集中的每一行数据都封装到一个对应的JavaBean对象中，存放到List集合</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Sort&gt; list = runner.query(con, sql, <span class="keyword">new</span> <span class="title class_">BeanListHandler</span>&lt;Sort&gt;(Sort.class));</span><br><span class="line">	<span class="keyword">for</span>(Sort s : list)&#123;</span><br><span class="line">   		System.out.println(s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>




<p>ColumnListHandler： 结果集指定列的数据,存储到List集合 List 每个列数据类型不同</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Object&gt; list = runner.query(con,sql,<span class="keyword">new</span> <span class="title class_">ColumnListHandler</span>&lt;Object&gt;(<span class="string">&#x27;id&#x27;</span>));</span><br><span class="line">    <span class="keyword">for</span>(Object obj :list)&#123;</span><br><span class="line">    	System.out.println(obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ScalarHandler: 对于查询后,只有1个结果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> runner.query(con, sql, <span class="keyword">new</span> <span class="title class_">ScalarHandler</span>&lt;Object&gt;());</span><br><span class="line">System.out.println(count);</span><br></pre></td></tr></table></figure>



<p>MapHandler：将结果集中的第一行数据封装到一个Map里，key是列名，value就是对应的值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String, Object&gt; map = runner.query(con, sql, <span class="keyword">new</span> <span class="title class_">MapHandler</span>());</span><br><span class="line">   <span class="comment">//遍历Map集合</span></span><br><span class="line">   <span class="keyword">for</span>(String key : map.keySet())&#123;</span><br><span class="line">    	System.out.println(key+<span class="string">&#x27;..&#x27;</span>+map.get(key));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>MapListHandler：将结果集中的每一行数据都封装到一个Map里，然后再存放到List</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Map&lt;String, Object&gt;&gt; list = runner.query(con,sql,<span class="keyword">new</span> <span class="title class_">MapListHandler</span>());</span><br><span class="line"><span class="comment">//遍历集合list</span></span><br><span class="line">	<span class="keyword">for</span>(Map map :list)&#123;</span><br><span class="line">   		<span class="keyword">for</span>(String key : map.keySet())&#123;</span><br><span class="line">      		System.out.print(key+<span class="string">&#x27;...&#x27;</span>+map.get(key));</span><br><span class="line">   	&#125;</span><br><span class="line">    System.out.println();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addTest</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//Druid连接池</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> source.getConnection();</span><br><span class="line">        <span class="comment">//DBUtills</span></span><br><span class="line">        <span class="type">QueryRunner</span> <span class="variable">runner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>();</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into user_table values(?,?,?)&quot;</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> runner.update(conn, sql, <span class="string">&quot;jack1&quot;</span>, <span class="string">&quot;123&quot;</span>, <span class="number">2000</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;insert successed&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="查询-1"><a href="#查询-1" class="headerlink" title="查询"></a>查询</h3><p><strong>查询单条记录</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   * 测试查询:查询一条记录</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * 使用ResultSetHandler的实现类：BeanHandler</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">querySingleTest</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">      <span class="comment">//Druid连接池</span></span><br><span class="line">      <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> source.getConnection();</span><br><span class="line">   <span class="comment">//DBUtills</span></span><br><span class="line">      <span class="type">QueryRunner</span> <span class="variable">runner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>();</span><br><span class="line"></span><br><span class="line">      <span class="comment">//查询单条结果</span></span><br><span class="line">      <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM customers WHERE id = ?&quot;</span>;</span><br><span class="line">      BeanHandler&lt;Customer&gt; handler = <span class="keyword">new</span> <span class="title class_">BeanHandler</span>(Customer.class);</span><br><span class="line">      <span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> runner.query(conn, sql, handler, <span class="number">1</span>);</span><br><span class="line">      System.out.println(customer);</span><br><span class="line"></span><br><span class="line"><span class="comment">//释放连接到资源池</span></span><br><span class="line">      JDBCUtills.closeResource(conn,<span class="literal">null</span>);</span><br><span class="line">  &#125;    </span><br></pre></td></tr></table></figure>

<p><strong>查询多条记录</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 测试查询:查询多条记录构成的集合</span></span><br><span class="line"><span class="comment">* 使用ResultSetHandler的实现类：BeanListHandler</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">queryMultipleTest</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">//Druid连接池</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> source.getConnection();</span><br><span class="line">    <span class="comment">//DBUtills</span></span><br><span class="line">    <span class="type">QueryRunner</span> <span class="variable">runner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//查询多条结果集</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql2</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM customers&quot;</span>;</span><br><span class="line">    BeanListHandler&lt;Customer&gt; listHandler = <span class="keyword">new</span> <span class="title class_">BeanListHandler</span>(Customer.class);</span><br><span class="line">    List&lt;Customer&gt; list = runner.query(conn, sql2, listHandler);</span><br><span class="line">    list.forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//释放连接到资源池</span></span><br><span class="line">    JDBCUtills.closeResource(conn,<span class="literal">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>查询单个值</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 测试查询:查询单个值</span></span><br><span class="line"><span class="comment"> * 使用ResultSetHandler的实现类：ScalarHandler</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">queryValueTest</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">//Druid连接池</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> source.getConnection();</span><br><span class="line">    <span class="comment">//DBUtills</span></span><br><span class="line">    <span class="type">QueryRunner</span> <span class="variable">runner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//查询单条结果</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT Count(*) FROM customers&quot;</span>;</span><br><span class="line">    <span class="type">ScalarHandler</span> <span class="variable">handler</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ScalarHandler</span>();</span><br><span class="line">    <span class="type">long</span> <span class="variable">o</span> <span class="operator">=</span> (<span class="type">long</span>) runner.query(conn, sql, handler);</span><br><span class="line">    System.out.println(o);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//释放连接到资源池</span></span><br><span class="line">    JDBCUtills.closeResource(conn,<span class="literal">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="自定义Handler"><a href="#自定义Handler" class="headerlink" title="自定义Handler"></a>自定义Handler</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="comment">//自定义resultHandler</span></span><br><span class="line"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">    <span class="comment">//Druid连接池</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> source.getConnection();</span><br><span class="line">    <span class="comment">//DBUtills</span></span><br><span class="line">    <span class="type">QueryRunner</span> <span class="variable">runner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//查询单条结果</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM customers where id = 1&quot;</span>;</span><br><span class="line">    ResultSetHandler&lt;Customer&gt; selfDefineHandler = <span class="keyword">new</span> <span class="title class_">ResultSetHandler</span>&lt;Customer&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Customer <span class="title function_">handle</span><span class="params">(ResultSet resultSet)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">            <span class="type">ResultSetMetaData</span> <span class="variable">rsmd</span> <span class="operator">=</span> resultSet.getMetaData();</span><br><span class="line">            <span class="type">int</span> <span class="variable">columnCount</span> <span class="operator">=</span> rsmd.getColumnCount();</span><br><span class="line">            <span class="keyword">if</span>(resultSet.next())&#123;</span><br><span class="line">                <span class="type">Customer</span> <span class="variable">cust</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Customer</span>();</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; columnCount; i++) &#123;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">columnLabel</span> <span class="operator">=</span> rsmd.getColumnLabel(i + <span class="number">1</span>);</span><br><span class="line">                    <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> resultSet.getObject(i + <span class="number">1</span>);</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> Customer.class.getDeclaredField(columnLabel);</span><br><span class="line">                        field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">                        field.set(cust,value);</span><br><span class="line">                        <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                            e.printStackTrace();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">finally</span> &#123;</span><br><span class="line">                            <span class="keyword">if</span>(resultSet!=<span class="literal">null</span>)</span><br><span class="line">                                resultSet.close();</span><br><span class="line">                        &#125;      </span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span> cust;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">Customer</span> <span class="variable">query</span> <span class="operator">=</span> runner.query(conn, sql, selfDefineHandler);</span><br><span class="line">        System.out.println(query);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//释放连接到资源池</span></span><br><span class="line">        JDBCUtills.closeResource(conn,<span class="literal">null</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>自定义ResultSetHandler接口的实现类，实现Handler方法 核心handle方法就是处理ResultSet 结果集，自定义返回类型</p>
<h3 id="资源关闭"><a href="#资源关闭" class="headerlink" title="资源关闭"></a>资源关闭</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">(Connection con, Statement st, ResultSet rs)</span>&#123;</span><br><span class="line">    <span class="comment">//方式1</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        DbUtils.close(con);</span><br><span class="line">        DbUtils.close(st);</span><br><span class="line">        DbUtils.close(rs);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException throwables) &#123;</span><br><span class="line">        throwables.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//方式2</span></span><br><span class="line">    DbUtils.closeQietly(rs);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/01/30/MySQL/" data-id="cl3u71bk1000f380l3mrdft01" data-title="MySQL" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-JavaScript" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/02/JavaScript/" class="article-date">
  <time class="dt-published" datetime="2020-12-02T08:43:29.000Z" itemprop="datePublished">2020-12-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/02/JavaScript/">JavaScript</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h1><h2 id="JavaScript概述"><a href="#JavaScript概述" class="headerlink" title="JavaScript概述"></a>JavaScript概述</h2><ol>
<li><p>JavaScript语言是一种脚本语言（解释型语言），JavaScript的“目标程序”是以普通文本的形式保存。用记事本是可以直接打开的。浏览器打开就直接解释执行了。</p>
</li>
<li><p>JavaScript是一门编程语言，专门用来操作HTML页面中的节点，让网页产生动态效果的。JavaScript中也有变量、数据类型、运算符、if语句、for循环、标识符、关键字等。</p>
</li>
<li><p>JavaScript和Java的区别</p>
<p>​	JavaScript运行在浏览器当中，浏览器中有执行JS代码的内核。</p>
<p>​	Java运行在JVM当中。JavaScript和Java没有任何关系。</p>
<p>​	Java语言是SUN公司开发的，JavaScript这个名字是SUN公司给起的名。</p>
</li>
</ol>
<h2 id="JavaScript包括三块：ECMAScript、DOM、BOM"><a href="#JavaScript包括三块：ECMAScript、DOM、BOM" class="headerlink" title="JavaScript包括三块：ECMAScript、DOM、BOM"></a>JavaScript包括三块：ECMAScript、DOM、BOM</h2><ol>
<li><p>ECMAScript是ECMA制定的262标准，JavaScript和JScript都遵守这个标准，ECMAScript是JavaScript核心语法</p>
</li>
<li><p>DOM编程是通过JavaScript对HTML中的dom节点进行操作，DOM规范是W3C制定的。（Document Object Model：文档对象模型）</p>
</li>
<li><p>BOM编程是对浏览器本身操作，例如：前进、后退、地址栏、关闭窗口、弹窗等。由于浏览器有不同的厂家制造，所以BOM缺少规范，一般只是有一个默认的行业规范。（Browser Object Model：浏览器对象模型）</p>
</li>
</ol>
<h2 id="嵌入JS三种方式"><a href="#嵌入JS三种方式" class="headerlink" title="嵌入JS三种方式"></a>嵌入JS三种方式</h2><h3 id="行间事件"><a href="#行间事件" class="headerlink" title="行间事件"></a>行间事件</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;hello&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;window.alert(&#x27;hello js&#x27;)&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<ol>
<li>JS中的任何一个事件都对应一个事件句柄，例如鼠标单击事件click，对应的事件句柄就是onclick，事件句柄都是以标签的属性方式存在。在事件句柄后面可以编写JS代码，当触发这个事件之后，这段JS代码则执行了。</li>
<li>window是JS中的内置BOM顶级对象，代表当前浏览器窗口，window对象有一个alert()函数，该函数可以在浏览器上弹出消息框。</li>
<li>window.alert()中的window.可以省略。</li>
</ol>
<h3 id="页面script标签嵌入"><a href="#页面script标签嵌入" class="headerlink" title="页面script标签嵌入"></a>页面script标签嵌入</h3><ol>
<li>&#96;&#96;&#96;html<script type="text/javascript">JS代码</script>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">2. window.alert()的执行会阻塞当前页面的加载</span><br><span class="line">3. 一个页面中可以写多个脚本块，脚本块的位置没有限制</span><br><span class="line">4. 暴露在脚本块中的JS代码在页面打开的时候遵循自上而下的顺序依次逐行执行</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 外部引入</span><br><span class="line"></span><br><span class="line">1. ```html</span><br><span class="line">   &lt;script type=&quot;text/javascript&quot; src=&quot;js文件路径&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="标识符和关键字"><a href="#标识符和关键字" class="headerlink" title="标识符和关键字"></a>标识符和关键字</h2><p>标识符命名规则和规范按照java执行</p>
<h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><h3 id="变量的声明与赋值"><a href="#变量的声明与赋值" class="headerlink" title="变量的声明与赋值"></a>变量的声明与赋值</h3><ol>
<li>变量未赋值，系统默认赋值undefined</li>
<li>JS是一种弱类型编程语言，一个变量var可以接收任何类型的数据</li>
<li>一行上也可以声明多个变量</li>
</ol>
<h3 id="局部变量和全局变量"><a href="#局部变量和全局变量" class="headerlink" title="局部变量和全局变量"></a>局部变量和全局变量</h3><p><strong>局部变量</strong>：函数的形参是局部变量，另外使用var关键字在函数体中声明的变量是局部变量，函数执行结束之后，局部变量的内存就释放了。</p>
<p><strong>全局变量</strong>：在函数体外声明的变量属于全局变量，另外不使用var关键字声明的变量无论位置在哪，它都是全局变量（没有var声明的变量，必须&#x3D;手动赋值，没有默认值undefined），全局变量在浏览器关闭时销毁。</p>
<h2 id="函数的定义与调用"><a href="#函数的定义与调用" class="headerlink" title="函数的定义与调用"></a>函数的定义与调用</h2><p>函数类似于java语言中的方法，是一段可以完成某个功能的可以被重复利用的代码片段</p>
<h3 id="普通函数定义"><a href="#普通函数定义" class="headerlink" title="普通函数定义"></a>普通函数定义</h3><p>function 函数名(形式参数列表){                                       	  function sum(a, b){</p>
<p>​		函数体;                                                                            		  return a + b;</p>
<p>}                                                                                               	}   																								  </p>
<p>注意：</p>
<ol>
<li><p>JS中的函数<strong>不需要指定返回值类型</strong>，因为JS是弱类型编程语言，变量可以接收任何类型的数据，也就是说JS中的函数可以返回任何类型的数据，当然也可以不返回任何数据。返回数据使用return语句。</p>
</li>
<li><p>JS中的函数在调用的时候，实参可以随意，例如调用以上的sum函数</p>
<p>​	（1）sum()，没有传任何实参的时候a和b变量没有赋值，则a和b都是undefined</p>
<p>​	（2）sum(10)，这样就表示a变量赋值10，b变量仍然是undefined</p>
<p>​	（3）sum(1,2)，这样则表示a是1，b是2。</p>
</li>
</ol>
<h3 id="把函数的声明当做类进行定义"><a href="#把函数的声明当做类进行定义" class="headerlink" title="把函数的声明当做类进行定义"></a>把函数的声明当做类进行定义</h3><p>函数名 &#x3D; function(形式参数列表){															sum &#x3D; function(a, b){</p>
<p>​	函数体;																							  			return a + b;</p>
<p>}																													}																														  </p>
<ol>
<li><p>JS中的函数定义在脚本块中，页面在打开的时候，函数并不会自动执行，函数是需要手动调用才能执行的。</p>
</li>
<li><p>由于JS是一种弱类型编程语言，所以函数不能同名，没有重载机制，同名会将前边的函数消灭掉</p>
</li>
<li><p>这样的代码顺序是可以的，页面打开的时候会先进行所有函数的声明，函数声明优先级较高。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">	<span class="title function_">sayHello</span>();</span><br><span class="line">	<span class="keyword">function</span> <span class="title function_">sayHello</span>(<span class="params"></span>)&#123;</span><br><span class="line">		<span class="title function_">alert</span>(<span class="string">&quot;Hello JS&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>用户点击按钮，调用函数</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">function</span> <span class="title function_">sayHello</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">		<span class="title function_">alert</span>(<span class="string">&quot;hello js&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">	&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;hello&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;sayHello();&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><p><strong>Undefined：</strong></p>
<p>（1）只有一个值undefined，变量声明没赋值，系统默认赋值undefined</p>
<p><strong>Number：</strong></p>
<p>（1）Number类型包括哪些值：0,1，-1,3.14,12,300，NaN，Infinity        NaN：表示数学表达式的结果应该是数字，但未返回数字时，返回NaN               Infinity：表示无穷大</p>
<p>（2）parseInt()：取整，不会四舍五入</p>
<p>（3）parseFloat()</p>
<p>（4）Math.ceil()：向上取整</p>
<p>（5）isNaN()：判断是否是数字类型的，先试图将类型转换为数字，成功了返回的是false</p>
<p>（6）Number()：可以把能转化为数组的数据但不是数字转化为数字</p>
<p><strong>String：</strong></p>
<p>（1）可以使用单引号，也可以用双引号</p>
<p>（2）JS中的字符串包括小String，也包括大String，小String属于原始类型，大String是JS的内置对象，大String属于Object类型。（小String是直接赋值字符串类型，大String是new String(“”)创建的）</p>
<p>（3）无论大String还是小String，它们的属性和方法都是通用的。</p>
<p>（4）字符串的substr()和substring()的区别。</p>
<p><strong>Null：</strong></p>
<p>（1）该类型只有一个值：null</p>
<p>（2）typeof运算符的执行结果是”object”</p>
<p><strong>Boolean：</strong></p>
<p>（1）只有两个值：true和false</p>
<p>（2）Boolean()：将不是Boolean类型的转化为Boolean类型</p>
<p>（3）JS中的if语句自动调用Boolean()函数</p>
<p><strong>Object</strong></p>
<p>（1）JS中定义一个类和定义一个函数语法是相同的</p>
<p>（2）JS中创建一个对象：new 类名()</p>
<p>（3）JS中访问对象属性：this.属性名；调用对象的方法：this.方法名 &#x3D; function(){}</p>
<p>（4）JS中的一个函数，既是函数声明，又是类的定义，同时函数名也可以看做构造方法名。直接调用函数表示普		  通函数调用，如果使用new运算符来调用该函数则会创建对象</p>
<p>（5）使用prototype属性动态的给对象扩展属性以及方法</p>
<p>ES6版本及之后添加了：<strong>Symbol</strong>和<strong>BigInt</strong></p>
<h2 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h2><h3 id="常用事件"><a href="#常用事件" class="headerlink" title="常用事件"></a>常用事件</h3><p>blur失去焦点</p>
<p>focus获得焦点</p>
<p>click鼠标单击</p>
<p>dblclick鼠标双击</p>
<p>keydown键盘按下</p>
<p>keyup键盘弹起</p>
<p>mousedown鼠标按下</p>
<p>mouseup鼠标弹起</p>
<p>mouseover鼠标经过</p>
<p>mousemove鼠标移动</p>
<p>mouseout鼠标离开</p>
<p>submit表单提交</p>
<p>reset表单重置</p>
<p>select文本被选定</p>
<p>load页面加载完毕</p>
<p>change下拉列表选中项改变，或文本框内容改变</p>
<h3 id="注册事件的两种方式"><a href="#注册事件的两种方式" class="headerlink" title="注册事件的两种方式"></a>注册事件的两种方式</h3><p>在标签中使用事件句柄的方式注册事件,当事件发生之后，注册在标签的代码执行</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span>=<span class="string">&quot;sayHello()&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>隐含的内置对象：</p>
<p>​	window：代表整个web窗口，是BOM的顶级对象</p>
<p>​	document：代表整个HTML文档，是DOM的顶级对象</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">	<span class="variable language_">window</span>.<span class="property">onload</span> = sayHello;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">或</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">	<span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123; </span></span><br><span class="line"><span class="language-javascript">	&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="代码的执行顺序"><a href="#代码的执行顺序" class="headerlink" title="代码的执行顺序"></a>代码的执行顺序</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">id</span>=<span class="string">&quot;btn&quot;</span> <span class="attr">value</span>=<span class="string">&quot;mybtn&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">var</span> elt = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;btn&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">	</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">		<span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">			<span class="keyword">var</span> elt = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;btn&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">		&#125;</span></span><br><span class="line"><span class="language-javascript">	</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">id</span>=<span class="string">&quot;btn&quot;</span> <span class="attr">value</span>=<span class="string">&quot;mybtn&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h2><h4 id="void运算符"><a href="#void运算符" class="headerlink" title="void运算符"></a>void运算符</h4><p>执行表达式，但不返回任何结果</p>
<p>void(表达式)</p>
<p>在a标签中的href中写javascript:void(0)就可以不跳转页面</p>
<h4 id="typeof运算符"><a href="#typeof运算符" class="headerlink" title="typeof运算符"></a>typeof运算符</h4><p>动态获取变量的数据类型</p>
<p>typeof a  获得a的数据类型，返回的是六个类型的字符串undefined，number，string，boolean，object，function（全部小写）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params">a, b</span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="string">&quot;number&quot;</span> === <span class="keyword">typeof</span> a &amp;&amp; <span class="string">&quot;number&quot;</span> === <span class="keyword">typeof</span> b)&#123;</span><br><span class="line">		<span class="keyword">return</span> a + b;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="title function_">alert</span>(<span class="string">&quot;数据格式不合法&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>&#x3D;、&#x3D;&#x3D;、&#x3D;&#x3D;&#x3D;三者的区别</strong></p>
<p>​	&#x3D;&#x3D;：等同运算符，比价值是否相等</p>
<p>​	&#x3D;&#x3D;&#x3D;：全等运算符，即比较值是否相等，还比较数据类型是否相等</p>
<h2 id="控制语句"><a href="#控制语句" class="headerlink" title="控制语句"></a>控制语句</h2><p>for..in语句遍历数组，以及遍历一个对象的属性</p>
<p>遍历数组：for(var index in 数组){}    index为数组元素的下标，和foreach有区别</p>
<p>遍历对象属性：for(var index in 对象){}  index为对象的属性名</p>
<h2 id="内置对象"><a href="#内置对象" class="headerlink" title="内置对象"></a>内置对象</h2><h3 id="Array"><a href="#Array" class="headerlink" title="Array"></a>Array</h3><p>创建数组：</p>
<p>​			var arr &#x3D; [元素1,元素2];       js中的数组长度可变</p>
<p>​			var arr &#x3D; new Array(3,2,1,5)</p>
<p>​			var arr &#x3D; new Array(3)创建数组长度为3的数组</p>
<p>JS中数组对象常用方法：push压栈，pop出栈，join连接，reverse翻转等</p>
<h3 id="Date"><a href="#Date" class="headerlink" title="Date"></a>Date</h3><p>（1）new Date() 获取当前系统时间</p>
<p>（2）new Date().getTime()获取时间戳</p>
<p>（3）new Date().getFullYear()、getMonth()等方法</p>
<h2 id="BOM和DOM"><a href="#BOM和DOM" class="headerlink" title="BOM和DOM"></a>BOM和DOM</h2><p><strong>BOM</strong>: Browser Object Model（浏览器对象模型），通过BOM的对象和方法可以完成浏览器窗口的操作，例如：关闭浏览器，前进，后退，修改地址栏上的地址等，BOM是包含DOM的。BOM的顶级内置对象是window</p>
<p><strong>DOM</strong>: Document Object Model（文档对象模型），通过DOM的对象和方法可以完成网页中元素的增删改，让网页产生动态效果，DOM的顶级内置对象是document</p>
<p><img src="file:///C:\Users\Lenovo\AppData\Local\Temp\ksohtml\wps746F.tmp.png" alt="img"> </p>
<h2 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h2><h3 id="正则表达式概述"><a href="#正则表达式概述" class="headerlink" title="正则表达式概述"></a>正则表达式概述</h3><p>（1）正则表达式是一门独立的学科，不止用在JS中</p>
<p>（2）正则表达式专门用来做字符串格式匹配的</p>
<h3 id="常用的正则表达式符号"><a href="#常用的正则表达式符号" class="headerlink" title="常用的正则表达式符号"></a>常用的正则表达式符号</h3><p>参考30分钟入门正则表达式：</p>
<p>^   字符串开始</p>
<p>$   字符串结束</p>
<p>\s   空白</p>
<p>*   0~N次</p>
<p>+   1~N次</p>
<p>?   0或1次</p>
<p>{3}   3次</p>
<p>{3,}   3~N次</p>
<p>{3,5}   3~5次</p>
<p>(a|b)   a或b</p>
<p>[a-z]   a到z</p>
<p>[^abc]   不是abc</p>
<h3 id="会创建JS中的正则表达式对象"><a href="#会创建JS中的正则表达式对象" class="headerlink" title="会创建JS中的正则表达式对象"></a>会创建JS中的正则表达式对象</h3><p>var regExp &#x3D; new RegExp(“正则表达式”,”标记”)</p>
<p>var regExp &#x3D; &#x2F;正则表达式&#x2F;标记</p>
<p>标记（可忽略不写）：g全局，i忽略大小写</p>
<p>（2）var regExp &#x3D; &#x2F;^[1-9][0-9]{4,}$&#x2F;;</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/12/02/JavaScript/" data-id="cl3u71bjt0007380lhi56dif1" data-title="JavaScript" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-JAVA" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/11/16/JAVA/" class="article-date">
  <time class="dt-published" datetime="2020-11-16T11:03:57.000Z" itemprop="datePublished">2020-11-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/11/16/JAVA/">JAVA</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://blog.csdn.net/PorkBird/article/details/113666542?spm=1001.2014.3001.5501">https://blog.csdn.net/PorkBird/article/details/113666542?spm=1001.2014.3001.5501</a></p>
<h2 id="JAVA"><a href="#JAVA" class="headerlink" title="JAVA"></a>JAVA</h2><p>JavaSE：标准版</p>
<p>JavaEE：企业版</p>
<p>JavaME：微型版</p>
<p>JDK：java开发工具箱</p>
<p>JRE：java运行环境</p>
<p>JVM：java虚拟机</p>
<p>JDK包括JRE，JRE包括JVM</p>
<h3 id="代码规范"><a href="#代码规范" class="headerlink" title="代码规范"></a>代码规范</h3><p>类名，接口名：首字母大写，后边每个单词的首字母大写</p>
<p>变量名，方法名：首字母小写，后边每个单词的首字母大写</p>
<p>常量名：全部大写，单词之间用_隔开</p>
<h3 id="经典异常"><a href="#经典异常" class="headerlink" title="经典异常"></a>经典异常</h3><p>空指针异常：NullpointerException</p>
<p>类型转换异常：ClassCastException</p>
<p>数组下标越界异常：ArraysIndexOutOfBoundsException</p>
<p>数字格式化异常：NumberFormatException</p>
<h3 id="标识符"><a href="#标识符" class="headerlink" title="标识符"></a>标识符</h3><p>组成：数字，字母，下划线，美元字符$</p>
<p>要求：不能由数字开头，区分大小写，不能是关键字</p>
<h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><p>组成：数据类型，名称，字面值（数据）</p>
<p>变量是内存中存储数据的最基本单元</p>
<p>局部变量：在方法体中声明的变量</p>
<p>成员变量(实例变量和静态变量)：在方法体外并在类体内声明的变量，若没手动赋值，系统会自动赋默认值</p>
<p>成员变量（堆内存）局部变量（栈内存）</p>
<h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><p>整形：byte(1),short(2),int(4),long(8)	java中将整数型默认为int，要将字面值后加L表示整数型为long</p>
<p>浮点型：float(4), double(8)	浮点型默认为double</p>
<p>布尔型：boolean(1)	java中只有两个值 float和true</p>
<p>字符型：char(2)   在c中字符型占用一个字节</p>
<p>一字节（byte）等于八比特位（bit）1byte &#x3D; 8bit</p>
<p>byte的取值范围为-128~127</p>
<h4 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h4><p>自动类型转换（向上转型）：自动从小容量到大容量转换byte&lt;short&lt;int&lt;long&lt;float&lt;double&lt;char</p>
<p>强制类型转换（向下转型）：大容量到小容量转换，可能会丢失精度</p>
<h3 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h3><p>算术运算符：+，-，*，&#x2F;,%,++,–</p>
<p>​			整数操作只能得到整数，要想得到小数，必须有浮点数参与运算。</p>
<p>关系运算符：&lt;,&gt;,&lt;&#x3D;,&gt;&#x3D;,&#x3D;&#x3D;,!&#x3D;</p>
<p>逻辑运算符：&amp;,|,!,^,&amp;&amp;,||（&amp;（|）和&amp;&amp;（||）最终的结果是一样的，但是&amp;&amp;（||）存在短路现象）</p>
<p>​			短路现象：第二个表达式可能不执行，执行效率较高</p>
<p>赋值运算符：&#x3D;，+&#x3D;，-&#x3D;，*&#x3D;，&#x2F;+，%&#x3D;</p>
<p>​		先执行等号右边的表达式，在将执行结果赋值给左边</p>
<p>字符串连接运算符：+</p>
<p>​	当+两边只要有一个是字符串，就会进行字符串连接运算</p>
<p>​	将一个变量塞到一个字符串当中应该是：“+变量+”</p>
<p>三目运算符：布尔表达式？表达式1：表达式2</p>
<h3 id="控制语句"><a href="#控制语句" class="headerlink" title="控制语句"></a>控制语句</h3><p>选择结构：if{}，if{}else{}，if{}else if{}，switch{}case  :{}</p>
<p>循环结构：for{}，while{}，do{}while{}</p>
<p>改变控制语句顺序：break，continue</p>
<h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><p>相当于c语言中的函数</p>
<p>语法：</p>
<p>​			[修饰符列表] 返回值类型 方法名 （形式参数列表）{</p>
<p>​			方法体；</p>
<p>​			}</p>
<p>定义在类体中，方法体中不能再定义方法</p>
<p>调用方法：</p>
<p>​	修饰符列表中有static时，调用该方法是:类名.方法名(实际参数列表）</p>
<p>​	当执行的程序和要调用的程序在一个类里类名.可以省略</p>
<h4 id="方法体"><a href="#方法体" class="headerlink" title="方法体"></a>方法体</h4><p>方法体中编写java语句</p>
<p>主方法是程序的入口</p>
<h4 id="方法重载（名称相同，参数不同）"><a href="#方法重载（名称相同，参数不同）" class="headerlink" title="方法重载（名称相同，参数不同）"></a>方法重载（名称相同，参数不同）</h4><p>要求：在同一类中，方法名相同，参数列表不同，参数数量不同，参数类型不同，参数顺序不同</p>
<ul>
<li>重载仅对应方法的定义，与方法的调用无关，调用方式参照标准格式</li>
<li>重载仅针对同一个类中方法的名称与参数进行识别，<strong>与返回值无关</strong>，换句话说不能通过返回值来判定两个方法是否相互构成重载</li>
</ul>
<h4 id="方法重写（覆盖）"><a href="#方法重写（覆盖）" class="headerlink" title="方法重写（覆盖）"></a>方法重写（覆盖）</h4><p>发生在具有继承关系的父子类之间（返回值，方法名，形参列表相同）</p>
<p>方法重写注意事项和要求</p>
<ol>
<li>重写方法的名称、形参列表必须与被重写方法的名称和参数列表一致。</li>
<li>子类重写父类方法时，访问权限必须大于或者等于父类 （暂时了解 ：缺省 &lt; protected &lt; public）</li>
<li>子类不能重写父类的静态方法和私有方法</li>
</ol>
<p>子类中所有的构造器默认都会先访问父类中无参的构造器，再执行自己。<strong>没有无参构造器，需要手动调用父类的有参构造器（super(参数)）</strong></p>
<h4 id="方法递归"><a href="#方法递归" class="headerlink" title="方法递归"></a>方法递归</h4><p>容易造成栈内存溢出</p>
<h4 id="构造方法"><a href="#构造方法" class="headerlink" title="构造方法"></a>构造方法</h4><p>构造方法：																			普通方法：</p>
<p>​	[修饰符列表] 构造方法名 （形式参数列表{						[修饰符列表]  返回值类型  方法名 （形式参数列表{</p>
<p>​	构造方法体；																		方法体；</p>
<p>​	}																							 }</p>
<p>构造方法名和类名必须保持一致 </p>
<p>构造方法不需要手动调用，创建对象时自动调用构造方法</p>
<h3 id="封装性"><a href="#封装性" class="headerlink" title="封装性"></a>封装性</h3><p>封装之后才会产生独立体–对象</p>
<p>安全性高，可重复利用性强</p>
<p>private私有化修饰，只能在本类中访问</p>
<p>封装：</p>
<p>​	private修饰</p>
<p>操作入口：</p>
<p>​	setters方法（外部修改）：</p>
<p>​	puhlic void setAge (int a){</p>
<p>​	 	age &#x3D; a;</p>
<p>​	}</p>
<p>​	getters方法（外部读取）：</p>
<p>​	puhlic int  getAge (){</p>
<p>​	 	return age;</p>
<p>​	}</p>
<p>自动抒写：右键–Source–setters and getters ；alt+insert快速生成</p>
<h3 id="继承性"><a href="#继承性" class="headerlink" title="继承性"></a>继承性</h3><p>语法：</p>
<p>​	[修饰符列表] class 类名 extends 父类名{</p>
<p>​		类体；</p>
<p>​	}</p>
<p>java中只有单继承，只能继承一个类，但可以继承多个接口</p>
<p>私有的类和构造方法不支持继承，私有的成员可以被继承，只是不能直接访问</p>
<p>有了继承才有了“方法覆盖”和“多态机制”，可以重复利用代码</p>
<p>在子类方法中访问成员（成员变量、成员方法）满足：就近原则</p>
<ol>
<li>先子类局部范围找</li>
<li>然后子类成员范围找</li>
<li>然后父类成员范围找，如果父类范围还没有找到则报错。</li>
</ol>
<h3 id="多态性（必需有继承关系）"><a href="#多态性（必需有继承关系）" class="headerlink" title="多态性（必需有继承关系）"></a>多态性（必需有继承关系）</h3><p>向上转型：子类型–&gt;父类型（自动类型转换） 强制类型转换有安全隐患</p>
<p>向下转型：父类型–&gt;子类型（强制类型转换）</p>
<p>子类型中特有的，必须进行强制类型转换</p>
<p>采用（引用 instanceof  An）判断引用是否指向An类型的对象</p>
<p>父类型引用指向子类型对象（降低程序的耦合度，提高程序的扩展力）</p>
<p>方法调用：编译看左边，运行看右边。<br>变量调用：编译看左边，运行也看左边。（多态侧重行为多态）</p>
<h3 id="类的定义"><a href="#类的定义" class="headerlink" title="类的定义"></a>类的定义</h3><p>类体：类体中不能直接编写java语句，除声明变量除外</p>
<p>语法：</p>
<p>​	[修饰符列表]  class 类名{</p>
<p>​	属性；一般用变量形式来定义（状态信息）</p>
<p>​	方法；(行为信息)</p>
<p>​	}</p>
<h3 id="对象的创建于使用"><a href="#对象的创建于使用" class="headerlink" title="对象的创建于使用"></a>对象的创建于使用</h3><p>new 类名()创建了一个对象，或者利用反射机制创建一个对象</p>
<p>Student s &#x3D; new Student();将新创建的对象的地址用局部变量保存（局部变量存放在栈中）（s为引用，引用了对象的地址，来访问对象）</p>
<p>java中只能通过引用来对堆内存中对象内部的实例变量进行操作</p>
<p>读取数据：引用.变量名          修改数据：引用.变量名 &#x3D; 值</p>
<h3 id="this关键字"><a href="#this关键字" class="headerlink" title="this关键字"></a>this关键字</h3><p>this是一个引用，是一个变量，this变量保存了内存地址指向自身，this存储在堆内存对象的内部</p>
<p>调用自身类的构造方法，当构造方法有参数时this不能省</p>
<p>this.访问本类的属性或方法</p>
<h3 id="super关键字"><a href="#super关键字" class="headerlink" title="super关键字"></a>super关键字</h3><p>子类调用父类的构造方法，当父类构造方法有参数时super不能省</p>
<p>super.访问父类的属性或方法</p>
<h3 id="static关键字"><a href="#static关键字" class="headerlink" title="static关键字"></a>static关键字</h3><p>静态的，修饰成员变量表示该成员变量只在内存中只存储一份，可以被共享访问、修改一般采用类名.的方式访问</p>
<p>静态方法只能访问静态的成员，不可以直接访问实例成员。</p>
<p>在方法区中分配内存</p>
<h4 id="静态代码块"><a href="#静态代码块" class="headerlink" title="静态代码块"></a>静态代码块</h4><p>语法：</p>
<p>​	static{</p>
<p>​	java语句；</p>
<p>​	}</p>
<p>在类加载时执行，并且只执行一次，通常完成数据的准备工作</p>
<h3 id="final关键字"><a href="#final关键字" class="headerlink" title="final关键字"></a>final关键字</h3><p>final修饰的类无法被继承，修饰的方法无法被覆盖</p>
<p>final修饰的变量一旦被赋值将不能再次赋值（实例变量必须手动赋值）</p>
<p>final修饰的引用一旦指向对象，将不能再指向其他对象，并且所指向的对象无法被垃圾回收器回收，但对象内部的内容可以改变</p>
<h4 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h4><p>public static final 类型 常量名 &#x3D; 值；</p>
<p>常量名全部大写，且单词之间用_链接</p>
<h3 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a>枚举</h3><p>修饰符  enum  枚举名称{<br>            第一行都是罗列枚举类实例的名称。<br>}</p>
<p>枚举类都是继承了枚举类型：java.lang.Enum<br>枚举都是最终类，不可以被继承。<br>构造器的构造器都是私有的，枚举对外不能创建对象。<br>枚举类的第一行默认都是罗列枚举对象的名称的。<br>枚举类相当于是多例模式。</p>
<h3 id="implements关键字"><a href="#implements关键字" class="headerlink" title="implements关键字"></a>implements关键字</h3><p>类继承接口（多继承）</p>
<p>语法：</p>
<p>​	[修饰符列表] class 类名implements 接口名{</p>
<p>​		必须实现接口中的抽象方法（要写public）；</p>
<p>​	}</p>
<h3 id="extends关键字"><a href="#extends关键字" class="headerlink" title="extends关键字"></a>extends关键字</h3><p>类继承类（单继承）</p>
<p>语法：</p>
<p>​	[修饰符列表] class 类名 extends 父类名{</p>
<p>​		类体；</p>
<p>​	}</p>
<h3 id="abstract关键字"><a href="#abstract关键字" class="headerlink" title="abstract关键字"></a>abstract关键字</h3><p>抽象类</p>
<p>语法：</p>
<p>​	[修饰符列表] abstract class 类名{</p>
<p>​	类体；</p>
<p>​	}</p>
<p>抽象方法：例如：public abstract void 方法名（）；</p>
<h3 id="transient关键字"><a href="#transient关键字" class="headerlink" title="transient关键字"></a>transient关键字</h3><p>游离的，不参与序列化</p>
<h3 id="抽象类"><a href="#抽象类" class="headerlink" title="抽象类"></a>抽象类</h3><p>不能创建对象，只能被继承使用，但是可以用抽象类类型引用调用方法</p>
<p>语法：</p>
<p>​	[修饰符列表] abstract class 类名{</p>
<p>​	类体；</p>
<p>​	}</p>
<h4 id="抽象方法"><a href="#抽象方法" class="headerlink" title="抽象方法"></a>抽象方法</h4><p>必须在抽象类中</p>
<p>public abstract void 方法名（）；</p>
<p>若非抽象类继承抽象类必须将抽象方法重写</p>
<h3 id="接口（就是体现规范的）"><a href="#接口（就是体现规范的）" class="headerlink" title="接口（就是体现规范的）"></a>接口（就是体现规范的）</h3><p>语法：</p>
<p>​	[修饰符列表] interface 接口名{</p>
<p>​		常量；</p>
<p>​		抽象方法；</p>
<p>​	}</p>
<p>接口支持多继承</p>
<p>接口中只有常量（public static final可以省略）和抽象方法（public abstract可以省略）</p>
<p>接口与接口之间没有继承关系也可以进行向下转型</p>
<p>接口不能直接new对象，但可以用接口类型引用调用方法</p>
<p>接口是用来被类实现（implements）的，实现接口的类称为实现类</p>
<p>类和类的关系：单继承。<br>类和接口的关系：多实现。<br>接口和接口的关系：多继承，一个接口可以同时继承多个接口</p>
<h3 id="内部类"><a href="#内部类" class="headerlink" title="内部类"></a>内部类</h3><p>内部类就是定义在一个类里面的类，里面的类可以理解成（寄生），外部类可以理解成（宿主）</p>
<p>语法：</p>
<p>public class People{</p>
<p>  &#x2F;&#x2F; 内部类</p>
<p>   public class Heart{</p>
<p>​    }</p>
<p>}</p>
<p>内部类通常可以方便访问外部类的成员，包括私有的成员</p>
<h4 id="匿名内部类"><a href="#匿名内部类" class="headerlink" title="匿名内部类"></a>匿名内部类</h4><p>new 类|抽象类名|或者接口名() {</p>
<p>​    重写方法;</p>
<p>};</p>
<p>特点总结：<br>    匿名内部类是一个没有名字的内部类。<br>    匿名内部类写出来就会产生一个匿名内部类的对象。<br>    匿名内部类的对象类型相当于是当前new的那个的类型的子类类型。</p>
<p>一个类要么默认继承了Object类，要么间接继承了Object类，Object类是Java中的祖宗类</p>
<p>String类中重写了toString()方法和equals()方法，可以直接使用</p>
<h4 id="Object类中的toString-方法（一般必须重写）"><a href="#Object类中的toString-方法（一般必须重写）" class="headerlink" title="Object类中的toString()方法（一般必须重写）"></a>Object类中的toString()方法（一般必须重写）</h4><p>目的：将java对象转换为字符串表示形式（输出时输出内容的形式），若不重写则输出内存地址</p>
<p>输出引用时自动调用toString方法</p>
<h4 id="Object类中的equals-方法（一般必须重写）"><a href="#Object类中的equals-方法（一般必须重写）" class="headerlink" title="Object类中的equals()方法（一般必须重写）"></a>Object类中的equals()方法（一般必须重写）</h4><p>目的：判断两个对象是否相等</p>
<p>默认的是用&#x3D;&#x3D;判断，但这判断的是对象的内存地址，并非对象</p>
<p>重写时要进行强制类型转换</p>
<h4 id="Object类中的finalize-方法"><a href="#Object类中的finalize-方法" class="headerlink" title="Object类中的finalize()方法"></a>Object类中的finalize()方法</h4><p>不需要手动调用，当java对象即将被垃圾回收器回收时自动调用该方法</p>
<h4 id="Object类中的wait-方法"><a href="#Object类中的wait-方法" class="headerlink" title="Object类中的wait()方法"></a>Object类中的wait()方法</h4><p>Object o &#x3D; new Object();</p>
<p>o.wait();</p>
<p>让正在o对象上活动的线程进入等待状态</p>
<p>o.notify();让正在o对象上的等待的进程唤醒</p>
<h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><p>声明语法格式：数据类型[] 变量名</p>
<p>初始化语法格式：静态：数据类型[] 变量名 &#x3D; {1， 2}			动态：数据类型[] 变量名 &#x3D; new  数据类型[x]</p>
<p>数组是引用数据类型，存放在堆内存中，父类是Object</p>
<p>数组可以存放基本数据类型，如果存储java对象，则存储的是对象的引用，并非java对象</p>
<p>java中规定数组一旦定义长度，数组的长度将不可变，但可以扩容（利用数组拷贝）</p>
<p>数组对象有java自带的length属性，用来获取数组元素个数</p>
<p>如果使用“数据类型[i]”取出数据，则“数据类型[i]”代表一个“数据类型”类型的对象，并不是数组</p>
<p>数组扩容：只能将数组拷贝到大数组中</p>
<p>数组拷贝：System.arraycopy(源数组，源数组起始位置，目标数组，目标起始位置，拷贝长度)</p>
<p>利用Object类型可以存取任何引用类型的的数据</p>
<h4 id="Arrays工具类（数组工具类）"><a href="#Arrays工具类（数组工具类）" class="headerlink" title="Arrays工具类（数组工具类）"></a>Arrays工具类（数组工具类）</h4><p>数组工具类，对数组进行操作，大部分都是静态的</p>
<p>Arrays.sort(数组)直接进行排序</p>
<h4 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h4><p>核心思想：左边位置的数据和右边位置的数据进行对比</p>
<p>两个for循环，第一个for决定有几个数据就循环比较几次，第二个for循环进行相邻数据的比较（因为第一个for循环执行一次之后就找出了最大值或最小值，所以第二个for循环可以少比较一个）</p>
<p>for(int i&#x3D;arr.length-1;  i&gt;0; i–)</p>
<p>​	for(int j&#x3D;0; j&lt;i; j++){</p>
<p>​			if(arr[j] &gt; arr[j+1]){</p>
<p>​				int temp;</p>
<p>​				temp &#x3D; arr[j];</p>
<p>​				arr[j] &#x3D; arr[j+1];</p>
<p>​				arr[j+1] &#x3D; temp;</p>
<p>​			}</p>
<p>}</p>
<h4 id="选择排序"><a href="#选择排序" class="headerlink" title="选择排序"></a>选择排序</h4><p>核心思想：循环一次找出数据中最新的元素，拿最小的元素和最前面的数据交换位置（交换完成之后该最小元素不参与下一次比较）</p>
<p>第一个数据和各个数据进行比较，交换，完成一次之后，在用第二个数据与后边的各个数据进行比较</p>
<p>两个for循环，第一个for决定有几个数据就循环比较几次，第二个for循环进行第一个数据和后边各个数据比较</p>
<p>for(int i&#x3D;0; i &lt; arr.length-1; i++){</p>
<p>​	int min &#x3D; i;</p>
<p>​	for(int j&#x3D;i+1; j &lt; arr.length; j++){</p>
<p>​		if(arr[j] &lt; arr[i]){</p>
<p>​			min &#x3D; j;</p>
<p>​		}</p>
<p>​		if(min !&#x3D; i){</p>
<p>​			int temp;</p>
<p>​			temp &#x3D; arr[min];</p>
<p>​			arr[i] &#x3D; temp;</p>
<p>​			arr[min] &#x3D; arr[i];</p>
<p>​		}</p>
<p>​	}</p>
<p>}</p>
<h4 id="二分查找"><a href="#二分查找" class="headerlink" title="二分查找"></a>二分查找</h4><p>先将数据进行从小到大排序，在进行查找</p>
<p>找出中间元素与要查找的元素比较，若中间元素小于目标元素，则将开始查找的下标变为中间元素下标+1</p>
<p>若中间元素大于目标元素则结束查找的下标变为中间元素的下标-1</p>
<p>设置开始下标，中间下标，结束下标</p>
<p>int begin &#x3D; 0;</p>
<p>int end &#x3D; arr.length-1;</p>
<p>int mid &#x3D; (begin+end)&#x2F;2;</p>
<p>while(begin &lt; end){</p>
<p>​	if (arr[mid] &#x3D;&#x3D; x)</p>
<p>​		return mid;</p>
<p>​	else if (arr[mid] &lt; x)</p>
<p>​		begin &#x3D; mid+1;</p>
<p>​	else if (arr[mid] &gt; x)</p>
<p>​		end &#x3D; mid-1;</p>
<p>}</p>
<h3 id="API"><a href="#API" class="headerlink" title="API"></a>API</h3><h4 id="String字符串"><a href="#String字符串" class="headerlink" title="String字符串"></a>String字符串</h4><p>String属于引用类型，使用双引号括起来的都是String对象，底层是byte数组实现的</p>
<p>String类中重写了toString()方法和equals()方法，可以直接使用（&#x3D;&#x3D;比较和equals()方法比较不一样，&#x3D;&#x3D;比较的是String类型变量存放的对象的地址值，而equals方法直接比较的String类型的对象是否相等）（使用equals方法比较字符串时建议用     字符串.equals(String对象)  这样可以避免空指针异常）</p>
<p>双引号括起来的字符串是不可变的，直接存储在方法区的字符串常量池中</p>
<p>若不使用new则不会再堆内存中开辟空间，该堆内存空间存放的是存放在字符串常量池中的String类型的内存地址</p>
<p>int i &#x3D; 100; 因为i是基本数据类型，所以i中保存的是100</p>
<p>String s &#x3D; “qqq”；因为s是引用数据类型，所以s中保存的是存放qqq对象的内存地址，“qqq”存放在方法区的字符串常量池当中，是一个对象</p>
<h5 id="String构造方法"><a href="#String构造方法" class="headerlink" title="String构造方法"></a>String构造方法</h5><ol>
<li>String s &#x3D; new String(“”);</li>
<li>String s &#x3D; “”;</li>
<li>String s &#x3D; new String(char数组);</li>
<li>String s &#x3D; new String(char数组，起始下标，长度);</li>
<li>String s &#x3D; new String(byte数组);</li>
<li>String s &#x3D; new String(byte数组，起始下标，长度);</li>
</ol>
<h5 id="StringBuffer字符串拼接"><a href="#StringBuffer字符串拼接" class="headerlink" title="StringBuffer字符串拼接"></a>StringBuffer字符串拼接</h5><p>StringBuffer底层是一个byte[]数组，是可变的，初始化容量是16（String底层压实byte[]数组但是不能改变）</p>
<p>目的：调用StringBuf.append拼接字符串节省了用+拼接时创建的中间字符串的内存空间</p>
<p>StringBuffer和StringBuilder的区别：StringBuffer的方法有关键字synchronized修饰，在多线程环境下运行时安全的</p>
<h4 id="Math类"><a href="#Math类" class="headerlink" title="Math类"></a>Math类</h4><p>包含执行基本数字运算的方法，Math类没有提供公开的构造器</p>
<table>
<thead>
<tr>
<th>public static int abs(int a)</th>
<th>获取参数绝对值</th>
</tr>
</thead>
<tbody><tr>
<td>public static double ceil(double a)</td>
<td>向上取整</td>
</tr>
<tr>
<td>public static double floor(double a)</td>
<td>向下取整</td>
</tr>
<tr>
<td>public static int round(float a)</td>
<td>四舍五入</td>
</tr>
<tr>
<td>public static int max(int a,int b)</td>
<td>获取两个int值中的较大值</td>
</tr>
<tr>
<td>public static double pow(double a,double b)</td>
<td>返回a的b次幂的值</td>
</tr>
<tr>
<td>public static double random()</td>
<td>返回值为double的随机值，范围[0.0,1.0)</td>
</tr>
</tbody></table>
<h4 id="System-类"><a href="#System-类" class="headerlink" title="System 类"></a>System 类</h4><p>System的功能是通用的，都是直接用类名调用即可，所以System不能被实例化</p>
<table>
<thead>
<tr>
<th>方法名</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>public static void exit(int status)</td>
<td>终止当前运行的 Java 虚拟机，非零表示异常终止</td>
</tr>
<tr>
<td>public static long currentTimeMillis()</td>
<td>返回当前系统的时间毫秒值形式</td>
</tr>
<tr>
<td>public static void arraycopy(数据源数组, 起始索引, 目的地数组, 起始索引, 拷贝个数)</td>
<td>数组拷贝</td>
</tr>
</tbody></table>
<h4 id="Date-类"><a href="#Date-类" class="headerlink" title="Date 类"></a>Date 类</h4><p>Date类的对象在Java中代表的是当前所在系统的此刻日期时间</p>
<ol>
<li>日期对象如何创建，如何获取时间毫秒值？<br>Date date &#x3D; new Date();<br>Long time &#x3D; date.getTime();（指的是从1970年1月1日    00:00:00走到此刻）</li>
<li>时间毫秒值怎么恢复成日期对象<br>Date d &#x3D; new Date(time);<br>d.setTime(time);</li>
</ol>
<h4 id="SimpleDateFormat-类"><a href="#SimpleDateFormat-类" class="headerlink" title="SimpleDateFormat 类"></a>SimpleDateFormat 类</h4><p>可以对Date对象或时间毫秒值格式化成我们喜欢的时间形式。</p>
<p> y	年、 M	月、 d	日、 H	时、 m	分、 s	秒</p>
<table>
<thead>
<tr>
<th>public final String <strong>format(Date date)</strong></th>
<th>将日期格式化成日期&#x2F;时间字符串</th>
</tr>
</thead>
<tbody><tr>
<td>public final String <strong>format(Object time)</strong></td>
<td>将时间毫秒值式化成日期&#x2F;时间字符串</td>
</tr>
<tr>
<td>public Date <strong>parse(String source)</strong></td>
<td>从给定字符串的开始解析文本以生成日期</td>
</tr>
</tbody></table>
<h4 id="Calendar类"><a href="#Calendar类" class="headerlink" title="Calendar类"></a>Calendar类</h4><p>public static Calendar getInstance()获取当前日历对象</p>
<table>
<thead>
<tr>
<th>方法名</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>public int get(int field)</td>
<td>取日期中的某个字段信息。</td>
</tr>
<tr>
<td>public void set(int field,int value)</td>
<td>修改日历的某个字段信息。</td>
</tr>
<tr>
<td>public void add(int field,int amount)</td>
<td>为某个字段增加&#x2F;减少指定的值</td>
</tr>
<tr>
<td>public final Date getTime()</td>
<td>拿到此刻日期对象。</td>
</tr>
<tr>
<td>public long getTimeInMillis()</td>
<td>拿到此刻时间毫秒值</td>
</tr>
</tbody></table>
<h4 id="Arrays类"><a href="#Arrays类" class="headerlink" title="Arrays类"></a>Arrays类</h4><p>数组操作工具类，专门用于操作数组元素的</p>
<table>
<thead>
<tr>
<th>public static String toString(类型[] a)</th>
<th>对数组进行排序</th>
</tr>
</thead>
<tbody><tr>
<td>public static void sort(类型[] a)</td>
<td>对数组进行默认升序排序</td>
</tr>
<tr>
<td>public static <T> void sort(类型[] a, Comparator&lt;? super T&gt; c)</td>
<td>使用比较器对象自定义排序</td>
</tr>
<tr>
<td>public static int binarySearch(int[] a, int key)</td>
<td>二分搜索数组中的数据，存在返回索引，不存在返回-1</td>
</tr>
</tbody></table>
<h3 id="包装类"><a href="#包装类" class="headerlink" title="包装类"></a>包装类</h3><p>八种包装类时引用数据类型，父类是Object</p>
<p>目的：传送对应的八种基本数据类型</p>
<p>java中为了提高运行效率，将[-128 ~ 127]之间所有的包装对象提前创建好，存放在方法区的整数型常量池中（类加载时自动缓存到内存中）（Integer x &#x3D; 127,  Integer y &#x3D; 127  因为x和y存放的内存地址相同所以x&#x3D;&#x3D;y ）</p>
<p>基本数据类型         包装类型</p>
<p>byte						java.lang.Byte</p>
<p>short					  java.lang.Short</p>
<p>int 						  java.lang.Integer</p>
<p>long						java.lang.Long</p>
<p>float						java.lang.Float</p>
<p>double				    java.lang.Double</p>
<p>boolean				  java.lang.Boolean</p>
<p>char						 java.lang.Character</p>
<h4 id="装箱和拆箱"><a href="#装箱和拆箱" class="headerlink" title="装箱和拆箱"></a>装箱和拆箱</h4><p>装箱：基本数据类型转换为引用数据类型</p>
<p>拆箱：引用数据类型转换为基本数据类型</p>
<p>JDK1.5之后，支持自动装箱自动拆箱</p>
<p>自动装箱：Integer x &#x3D; 100;（x是个引用，保存的是内存地址指向对象）</p>
<p>自动拆箱：int y &#x3D; x;（在用运算符+ - * &#x2F;是会自动拆箱）</p>
<p>可以把基本类型的数据转换成字符串类型&#x3D;</p>
<p>​	调用toString()方法得到字符串结果。<br>​	调用Integer.toString(基本类型的数据)</p>
<p>可以把字符串类型的数值转换成真实的数据类型</p>
<p>​	Integer.parseInt(“字符串类型的整数”)<br>​	Double.parseDouble(“字符串类型的小数”)</p>
<h3 id="枚举-1"><a href="#枚举-1" class="headerlink" title="枚举"></a>枚举</h3><p>结果又两种以上并且可一列举出来的，建议使用枚举类型</p>
<p>枚举中的每个值可以看做是一个常量</p>
<h3 id="异常"><a href="#异常" class="headerlink" title="异常"></a>异常</h3><p>异常：程序执行过程中的不正常情况 ，语法错误不算在异常体系中</p>
<p>作用：增强程序的健壮性</p>
<p>异常在java中以类的形式存在，每个异常类都可以创建异常对象</p>
<p>异常都是在运行阶段发生的，因为程序只有运行阶段才会new对象，因为异常的发生就是new异常对象</p>
<p>异常追踪信息从上往下看（SUN公司的代码就不用看了）</p>
<p>异常类可以自己定义：</p>
<ol>
<li>编写一个类继承Exception（编译时异常）或RuntimeException（运行时异常）</li>
<li>类中提供两个构造方法，一个无参的，一个带有String s参数的（语句中写super(s);）</li>
</ol>
<h4 id="异常结构"><a href="#异常结构" class="headerlink" title="异常结构"></a>异常结构</h4><p>Object:</p>
<p>​	Object下有Throwable（可抛出的）（所有的异常都是可抛出的）</p>
<p>​	Throwable下有两个分支：Error（不可处理的，直接退出JVM）和Exception（可处理的）</p>
<p>Exception：</p>
<p>​	Exception的直接子类：编译时异常（受控异常）（程序员必须对该错误进行处理，否则编译器报错）</p>
<p>​	RuntimeException：运行时异常（未受控异常）</p>
<h4 id="处理异常的两种方式"><a href="#处理异常的两种方式" class="headerlink" title="处理异常的两种方式"></a>处理异常的两种方式</h4><h5 id="throws关键字"><a href="#throws关键字" class="headerlink" title="throws关键字"></a>throws关键字</h5><ol>
<li>在方法声明的位置上使用throws关键字，抛给上一级（调用该方法的），上一级进行异常处理</li>
</ol>
<h5 id="try-catch"><a href="#try-catch" class="headerlink" title="try..catch"></a>try..catch</h5><ol>
<li>使用try{}catch(错误类名 变量名){}语句进行异常的捕捉</li>
</ol>
<p>只要异常没有捕捉，采取上报方式，此方法的后续代码将不被执行，若捕捉了则后续代码正常执行</p>
<h5 id="try-catch中的finally子句"><a href="#try-catch中的finally子句" class="headerlink" title="try..catch中的finally子句"></a>try..catch中的finally子句</h5><p>finally子句中的代码是最后执行的，并且一定会执行</p>
<p>通常在finally语句块中完成资源的释放和关闭</p>
<p>退出JVMfinally语句块不会执行</p>
<h4 id="手动抛出异常"><a href="#手动抛出异常" class="headerlink" title="手动抛出异常"></a>手动抛出异常</h4><p>throw new 异常类名(“1111”);手动抛出异常</p>
<p>String msg &#x3D; 变量名.getMessage();获取异常简单的描述信息（构造方法的参数）</p>
<p>变量名.printStackTrace();打印异常追踪的堆栈信息</p>
<h3 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h3><p>集合实际上就是容器，可以一次容纳多个对象</p>
<p>集合不能直接存储基本数据类型和java对象，存储的是java对象的内存地址（引用）</p>
<p>每一个不同的集合底层对应不同的数据结构</p>
<h4 id="单个方式存储元素，这一类集合的超级父类是：java-util-Collection"><a href="#单个方式存储元素，这一类集合的超级父类是：java-util-Collection" class="headerlink" title="单个方式存储元素，这一类集合的超级父类是：java.util.Collection"></a>单个方式存储元素，这一类集合的超级父类是：java.util.Collection</h4><p>​	接口：Iterable：可迭代的，可遍历的</p>
<p>​	接口：Collection泛化（继承）Iterable				接口：Iterator：集合的迭代器对象</p>
<p>​	接口：List集合：有序（存进去的顺序和取出来的顺序相同，每个元素都有下标）可重复（元素值可以相同）</p>
<p>​	实现类：ArrayList：底层是数组</p>
<p>​	实现类：LinkedList：底层是双向链表</p>
<p>​	实现类：Vector：底层是数组，线程安全的，效率较低，使用较少</p>
<p>​	接口：Set集合：无序（存进去的顺序和取出来的顺序不同，没有下标）不可重复</p>
<p>​	实现类：HashSet：底层是HashMap，放到HashSet集合中的元素等同于放到HashMap集合key部分了</p>
<p>​	接口：SortedSet集合：无序不可重复，但是元素是可排序的（大小顺序排序）</p>
<p>​	实现类：TreeSet：底层是HashMap，放到TreeSet集合中的元素等同于放到TreeMap集合key部分了	</p>
<h5 id="Collection接口常用方法"><a href="#Collection接口常用方法" class="headerlink" title="Collection接口常用方法"></a>Collection接口常用方法</h5><p>​	添加元素x：引用.add(x);   默认向集合末尾添加元素</p>
<p>​	获取集合中元素的个数：引用.size();</p>
<p>​	清空集合：引用.clear();</p>
<p>​	判断集合中是否包含x：引用.contains(x);  要重写equals方法</p>
<p>​	删除x元素：引用.remove(x);  要重写equals方法</p>
<p>​	判断集合是否为空：引用.isEmpty();</p>
<p>​	转换为数组：引用.toArray();</p>
<p>​	迭代（遍历）集合：</p>
<p>​		第一步：Iterator it &#x3D; 引用.iterator();获取集合的迭代器对象</p>
<p>​		第二步：it.hasNext();判断是否还有元素可以迭代</p>
<p>​		第三步：it.next();将迭代器前进一位，并且拿到迭代器指向的元素</p>
<p>如果数据结构发生变化，而没重写获取迭代器对象，java程序会报错，所以删除元素的时候要用迭代器指向当前元素（会自动更新迭代器和集合）</p>
<h5 id="List接口特有方法"><a href="#List接口特有方法" class="headerlink" title="List接口特有方法"></a>List接口特有方法</h5><p>在i位置处添加元素x：引用.add(i, x);   </p>
<p>获取i位置下的元素：引用.get(i);</p>
<p>获取x对象第一次出现处的索引（位置）：引用.indexOf(x);</p>
<p>获取x对象最后一次出现处的索引（位置）：引用.lastIndexOf(x);</p>
<p>删除i位置下的元素：引用.remove(i);</p>
<p>修改i位置下的元素：引用.set(i);</p>
<h5 id="ArrayList集合（数组）"><a href="#ArrayList集合（数组）" class="headerlink" title="ArrayList集合（数组）"></a>ArrayList集合（数组）</h5><p>默认初始化容量是10（底层先创建一个数组，当添加元素时容量变为10）</p>
<p>集合底层是Object[]数组</p>
<p>构造方法：new ArrayList();容量是10          new ArrayList(20);容量是20     	new ArrayList(引用);将其他集合转换为ArrayList集合</p>
<p>ArrayList集合扩容增长到原容量的1.5倍</p>
<p>优点：检索，查找效率较高</p>
<h5 id="LinkedList集合（双向链表）"><a href="#LinkedList集合（双向链表）" class="headerlink" title="LinkedList集合（双向链表）"></a>LinkedList集合（双向链表）</h5><p>没有固定容量</p>
<p>底层是双向链表</p>
<p>优点：增删效率较高</p>
<p>first指向头结点的前结点</p>
<p>last指向尾结点的后结点</p>
<h5 id="vector集合-数组"><a href="#vector集合-数组" class="headerlink" title="vector集合(数组)"></a>vector集合(数组)</h5><p>底层是一个数组</p>
<p>默认初始化容量是10</p>
<p>vector集合扩容增长到原来的2倍 </p>
<p>vector中所有的方法是线程同步的，都带有synchronized关键字，是线程安全的</p>
<p>Collections.synchronizedList(引用);将非线程安全的转换为线程安全的</p>
<h5 id="TreeSet集合（TreeMap）"><a href="#TreeSet集合（TreeMap）" class="headerlink" title="TreeSet集合（TreeMap）"></a>TreeSet集合（TreeMap）</h5><p>TreeSet集合底层是一个TreeMap，TreeMap集合底层是一个二叉树</p>
<p>放到TreeSet集合中的元素，相当于存放在TreeMap集合的key部分</p>
<p>无序不可重复，但是对String类型自动排序，如果是自定义类型，需要实现Comparable接口并实现compareTo方法（里面写比较规则，其中返回0表示相同会覆盖value；返回&gt;0会继续在右子树上查找；返回&lt;0会在左子树上查找）或者要在构造TreeSet或TreeMap集合的时候给它传一个比较器对象（创建比较器类，比较器类实现Comparator接口并实现compare方法）</p>
<p>当比较规则不会发生改变或者比较规则只有一个时建议实现Comparable接口；如果比较规则有多个并且频繁切换时建议实现Comparator接口</p>
<p>TreeSet和TreeMap集合是自平衡二叉树，遵循左小右大的原则存放</p>
<p>TreeSet和TreeMap集合和Iterator迭代器采用的都是中序遍历方式（左根右）</p>
<h4 id="键值对的方式存储元素，这一类集合的超级父类是：java-util-Map"><a href="#键值对的方式存储元素，这一类集合的超级父类是：java-util-Map" class="headerlink" title="键值对的方式存储元素，这一类集合的超级父类是：java.util.Map"></a>键值对的方式存储元素，这一类集合的超级父类是：java.util.Map</h4><p>​	接口：Map集合的key部分就是一个Set集合（往Set集合存放数据，实际上是往Map集合的key部分存放）</p>
<p>​	实现类：HashMap：底层是哈希表</p>
<p>​	实现类：Hashtable：底层是哈希表，是线程安全的，效率较低，使用较少</p>
<p>​	属性类：Properties：是线程安全的，并且key和value只能存储字符串String</p>
<p>​	接口：SortedMap集合：无序不可重复，但是元素是可排序的（大小顺序排序）</p>
<p>​	实现类：TreeMap：底层是二叉树，TreeMap集合的key可以自动按照大小顺序排序</p>
<h5 id="Map接口常用方法"><a href="#Map接口常用方法" class="headerlink" title="Map接口常用方法"></a>Map接口常用方法</h5><p>Map集合一key和value的方式存储数据：键值对，key和value都是引用类型，key起主导作用</p>
<p>V put( K key, V value);向Map集合中添加键值对</p>
<p>V get(Object key);通过key获取value</p>
<p>void clear();清空集合</p>
<p>boolean containsKey(Object key);判断Map中是否包含某个key</p>
<p>boolean containsValue(Object value);判断Map中是否包含某个value</p>
<p>boolean isEmpty();判断集合是否为空</p>
<p>Set<K> keySet();获取Map中所有的key（所有的键是一个set集合）</p>
<p>V remove(Object key);通过key键删除键值对</p>
<p>int size();获取键值对个数</p>
<p>Collection<V> values();获取Map集合中所有的value</p>
<p>Set&lt;Map.Entry&lt;K, V&gt;&gt;entrySet();将Map集合转换为Set集合</p>
<p>Map集合：</p>
<p>​	key  			value</p>
<p>​	1					z</p>
<p>Set集合：</p>
<p>​	1 &#x3D; z</p>
<p>Map集合通过entrySet()方法转换为Set集合，Set集合中元素类型是Map.Entry&lt;k,y&gt;</p>
<p>遍历Map集合</p>
<p>​	法一：调用keySet获取所有的key，用迭代器调用get()通过key获取value通</p>
<p>​	法二：调用entrySet()方法将Map集合直接全部转换为Set集合（元素将变为Map.Entry类型），在通过迭代器遍历Set集合，先拿到Map.Entry类型元素，在调用getKey()和getValue()逐个取出key和value</p>
<h5 id="HashMap集合（哈希表）"><a href="#HashMap集合（哈希表）" class="headerlink" title="HashMap集合（哈希表）"></a>HashMap集合（哈希表）</h5><p>底层是哈希表（数组和单链表组成）</p>
<p>默认初始化是16，当存储达到75%时，数组开始扩容，初始化容量必须是2的倍数</p>
<p>map.put(k, v)实现原理：</p>
<p>​	第一步，先将k，v封装到Node对象中。第二步，底层会调用hashCode()方法得出hash值，然后通过哈希函数或哈希算法，将hash值转换为数组下标，下标位置上没有任何元素，就把Node添加到该位置上，如果下标位置上有链表，此时会拿着k和链表中的每个k进行equals，如果所有的equals返回的都是false，那么会将新节点添加到链表的末尾，如果有一个equals返回true，那么这个节点的value将会被覆盖</p>
<p>v &#x3D; map.get(k)实现原理：</p>
<p>​	先调用hashCode()方法得出哈希值，通过哈希算法转换为数组下标，通过数组下标快速定位到某个位置上，如果该位置什么也没有，返回null，如果该位置上有单向链表，那么会拿着参数k和每个节点的k进行equals，如果所有的equals返回false，那么ger方法返回null，如果有一个equals返回true，那么此时该节点的value就是要找的</p>
<p>equals和hashCode方法必须重写，IDEA工具同时生成</p>
<p>HashMap的key和value都可以为null，Hashtable的key和value都不能为空</p>
<h5 id="Properties集合（哈希表）"><a href="#Properties集合（哈希表）" class="headerlink" title="Properties集合（哈希表）"></a>Properties集合（哈希表）</h5><p>Properties是一个Map集合，继承Hashtable，Properties的key和value都是String类型</p>
<p>存：引用.setProperty(“key”, “value”);</p>
<p>通过key取：引用.getProperty(“key”);</p>
<h5 id="TreeMap集合（二叉树）"><a href="#TreeMap集合（二叉树）" class="headerlink" title="TreeMap集合（二叉树）"></a>TreeMap集合（二叉树）</h5><p>TreeMap集合底层是一个二叉树</p>
<p>无序不可重复，但是对String类型自动排序，如果是自定义类型，需要实现Comparable接口并实现compareTo方法（里面写比较规则，其中返回0表示相同会覆盖value；返回&gt;0会继续在右子树上查找；返回&lt;0会在左子树上查找）或者要在构造TreeSet或TreeMap集合的时候给它传一个比较器对象（创建比较器类，比较器类实现Comparator接口并实现compare方法）</p>
<p>当比较规则不会发生改变或者比较规则只有一个时建议实现Comparable接口；如果比较规则有多个并且频繁切换时建议实现Comparator接口</p>
<p>TreeSet和TreeMap集合是自平衡二叉树，遵循左小右大的原则存放</p>
<p>TreeSet和TreeMap集合和Iterator迭代器采用的都是中序遍历方式（左根右）</p>
<h4 id="Collections工具类（集合工具类）"><a href="#Collections工具类（集合工具类）" class="headerlink" title="Collections工具类（集合工具类）"></a>Collections工具类（集合工具类）</h4><p>非线程安全的集合变为线程安全的集合：Collections.synchronizedList();</p>
<p>排序：Collections.sort();定义比较规则</p>
<h3 id="File"><a href="#File" class="headerlink" title="File"></a>File</h3><p>File类可以定位文件：进行删除、获取文本本身信息等操作</p>
<p>File file &#x3D; new File(“文件&#x2F;文件&#x2F;绝对路径&#x2F;相对路径”);</p>
<table>
<thead>
<tr>
<th>public boolean isDirectory()</th>
<th>测试此抽象路径名表示的File是否为文件夹</th>
</tr>
</thead>
<tbody><tr>
<td>public boolean isFile()</td>
<td>测试此抽象路径名表示的File是否为文件</td>
</tr>
<tr>
<td>public boolean exists()</td>
<td>测试此抽象路径名表示的File是否存在</td>
</tr>
<tr>
<td>public String getAbsolutePath()</td>
<td>返回此抽象路径名的绝对路径名字符串</td>
</tr>
<tr>
<td>public String getPath()</td>
<td>将此抽象路径名转换为路径名字符串</td>
</tr>
<tr>
<td>public String getName()</td>
<td>返回由此抽象路径名表示的文件或文件夹的名称</td>
</tr>
<tr>
<td>public long lastModified()</td>
<td>返回文件最后修改的时间毫秒值</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>public boolean createNewFile()</th>
<th>创建一个新的空的文件</th>
</tr>
</thead>
<tbody><tr>
<td>public boolean mkdir()</td>
<td>只能创建一级文件夹</td>
</tr>
<tr>
<td>public boolean mkdirs()</td>
<td>可以创建多级文件夹</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>public boolean delete()</th>
<th>删除由此抽象路径名表示的文件或空文件夹</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>public String[] list()</th>
<th>获取当前目录下所有的”一级文件名称”到一个字符串数组中去返回。</th>
</tr>
</thead>
<tbody><tr>
<td>public File[] listFiles()(常用)</td>
<td>获取当前目录下所有的”一级文件对象”到一个文件对象数组中去返回（重点）</td>
</tr>
</tbody></table>
<h3 id="IO流"><a href="#IO流" class="headerlink" title="IO流"></a>IO流</h3><p>硬盘-内存：读（Read），输入（Input），输入流（InputStream）</p>
<p>内存-硬盘：写（Write），输出（Output），输出流（OutputStream）</p>
<p>所有流都实现了Closeable接口，都是可关闭的，都有close()方法，并且用完流一定要关闭不然会浪费资源</p>
<p>所有的输出流都实现了Flushable接口，都是可刷新的，都有flush()方法，刷新就是强行将管道剩余数据输出，若不刷新可能会引起数据丢失</p>
<h4 id="IO流分类"><a href="#IO流分类" class="headerlink" title="IO流分类"></a>IO流分类</h4><p>节点流：一个流的构造方法	需要一个流的时候，这个被传过去的流</p>
<p>包装流（处理流）：外部负责包装</p>
<p>关闭流时只需要关闭处理流即可，节点流会自动关闭</p>
<h5 id="按内存分"><a href="#按内存分" class="headerlink" title="按内存分"></a>按内存分</h5><p>往内存中去，叫做输入（Input）</p>
<p>从内存中出，叫做输出（Output）</p>
<h5 id="按读取方式"><a href="#按读取方式" class="headerlink" title="按读取方式"></a>按读取方式</h5><p>按照字节的方式，一次读取一个byte（一次读取个二进制位），这种流什么文件多可以读取，读取完文件时就会读取到-1</p>
<p>InputStream 字节输入流； OutputStream  字节输出流</p>
<p>按照字符的方式，一次读取一个字符，这种流只能读取纯文本文件</p>
<p>Reader 字符输入流； Writer  字符输出流</p>
<h4 id="16个IO流"><a href="#16个IO流" class="headerlink" title="16个IO流"></a>16个IO流</h4><p>文件专属：</p>
<p>​	java.io.FileInputStream    </p>
<p>​	创建一个byte数组（设置长度），读取文件时用流引用读取byte数组，输出时再将byte数组转换成字符串（读取多少转换多少，读取时	会返回读取数量，读取完文件时就会读取到-1）</p>
<p>​	其它常用方法：int available();返回流当中剩余的没有读到的字节数量	</p>
<p>​								long skip(long n);跳过几个字节不读</p>
<p>​	java,io.FileOutputStream</p>
<p>​	用writer写入文件，writer(“文件名”, 0, 长度)可以控制文件从什么位置写入，写入几个字节</p>
<p>​	构造函数直接是创建的文件名字（入存在该文件会将该文件的内容清空），或者名字，true表示在文件的末尾处添加数据不删除原有数据</p>
<p>​	java,io.FileReader</p>
<p>​	创建一个char数组（设置长度），读取文件时用流引用读取char数组</p>
<p>​	只能读取纯文本文件（能用记事本编辑的）</p>
<p>​	java,io.FileWriter</p>
<p>转换流（将字节流转换为字符流）</p>
<p>​	java,io.InputStreamReader</p>
<p>​	java,io.OutputStreamWriter</p>
<p>缓冲流</p>
<p>​	java,io.BufferedReader</p>
<p>​	自带缓冲区不需要自定义char数组</p>
<p>​	java,io.BufferedWriter</p>
<p>​	java,io.BufferedInputStream</p>
<p>​	java,io.BufferedOutputStream</p>
<p>数据流</p>
<p>​	java.io.DataInputStream</p>
<p>​	读取文件时需要知道写入的文件的类型顺序</p>
<p>​	java.io.DataOutputStream</p>
<p>​	将数据和数据类型一并写入文件</p>
<p>标准输出流</p>
<p>​	不需要手动控制关闭流，默认指向控制台</p>
<p>​	可以利用构造函数传参的形式，将标准输出流改变指向（输出时会输出的指向的文件）</p>
<p>​	java.io.PrintWriter</p>
<p>​	java.io.PrintStream</p>
<p>对象专属流</p>
<p>​	java.io.ObiectInputStream  反序列化：DeSerialize，将硬盘上的数据重新恢复到内存中，恢复成java对象</p>
<p>​	java.io.ObjectOutputStream  序列化：Serialize，java对象存储到硬盘文件中，将java对象的状态保存下来的过程</p>
<p>参与序列化和反序列化的对象，必须实现Serializeable接口（标志接口），java虚拟机看到这个接口，会为该类自动生成一个序列化版本号</p>
<p>序列化版本号是用来区分类的，java虚拟机默认提供序列化版本号，这导致java类在序列化后续不能修改代码（手动创建序列化版本号private static final long serialVersionUID &#x3D; 1111L）</p>
<h5 id="File类"><a href="#File类" class="headerlink" title="File类"></a>File类</h5><p>File不能完成读和写</p>
<p>File对象表示文件和目录路径名的抽象表示形式</p>
<h4 id="IO-Properties联合应用"><a href="#IO-Properties联合应用" class="headerlink" title="IO+Properties联合应用"></a>IO+Properties联合应用</h4><p>将文件中的数据加载到Properties对象中吗，新建一个输入流对象，新建一个Map集合，调用Properties对象的load方法将文件的数据加载到Map集合中，等号&#x3D;左边做key，等号&#x3D;右边做value</p>
<h3 id="多线程"><a href="#多线程" class="headerlink" title="多线程"></a>多线程</h3><h4 id="进程和线程的关系"><a href="#进程和线程的关系" class="headerlink" title="进程和线程的关系"></a>进程和线程的关系</h4><p>进程是一个应用程序，进程和进程之间的内存不共享</p>
<p>线程是一个进程中的执行场景&#x2F;执行单元，一个进程可以启动多个线程，线程和线程之间的堆内存和方法去内存共享，栈内存独立</p>
<h4 id="线程分类"><a href="#线程分类" class="headerlink" title="线程分类"></a>线程分类</h4><p>用户线程：main方法时一个用户线程</p>
<p>守护线程：一般是一个死循环，所有用户线程结束，守护线程自动结束；回收机制是一个守护线程</p>
<p>​		setDaemon(true);将线程设置为守护线程</p>
<h4 id="实现线程"><a href="#实现线程" class="headerlink" title="实现线程"></a>实现线程</h4><h5 id="继承Thread类"><a href="#继承Thread类" class="headerlink" title="继承Thread类"></a>继承Thread类</h5><p>编写一个类，直接继承java.lang.Thread，重写run方法</p>
<p>创建线程对象，new继承了Thread的类</p>
<p>启动线程,调用线程对象的start方法，该方法会启动一个新的线程，开辟一个新的栈空间，启动线程成功 会自动调用run方法，并且run方法在分支线的栈底部，main方法在主线的栈底部（start方法只是为了开辟新的栈，瞬间结束）</p>
<h5 id="实现Runnable接口"><a href="#实现Runnable接口" class="headerlink" title="实现Runnable接口"></a>实现Runnable接口</h5><p>编写一个类，实现Runnable接口，实现run方法</p>
<p>创建实现Runnable接口的可运行的对象，将可运行的对象封装成一个线程对象（将实现Runnable接口的对象传到Thread对象中），启动线程</p>
<h5 id="实现Callable接口"><a href="#实现Callable接口" class="headerlink" title="实现Callable接口"></a>实现Callable接口</h5><p>这种方法实现线程可以获取线程的返回值</p>
<h4 id="线程的常用方法"><a href="#线程的常用方法" class="headerlink" title="线程的常用方法"></a>线程的常用方法</h4><p>setName() 设置线程名字</p>
<p>getName() 获取线程的名字</p>
<p>Thread.currentThread() 获取当前线程（该代码写在哪个线程的方法中，就获取的哪个线程）</p>
<p>sleep(毫秒) 让当前线程进入休眠状态（该代码写在哪个线程的方法中，就休眠的哪个线程）</p>
<p>interrupt() 终断睡眠（依靠了java的异常处理机制）</p>
<p>setPriority(优先数)设置线程优先级</p>
<p>getPriority()获取线程优先级</p>
<p>yield() 线程让位 该代码写在哪个线程的方法中，哪个线程让位）</p>
<p>t.join() 合并线程  当前线程进入阻塞，执行t线程</p>
<h4 id="线程安全"><a href="#线程安全" class="headerlink" title="线程安全"></a>线程安全</h4><p>使用线程同步机制（线程排队），解决线程安全问题</p>
<p>同步：线程之间发生了等待关系，线程排队（效率较低）</p>
<p>synchronized(){	在()中一定要写线程之间共享的对象，是谁和谁的共享对象谁和谁就会排队</p>
<p>​	同步代码块;</p>
<p>}</p>
<p>synchronized可以写在实例方法上，表示同步代码块是整个方法体</p>
<p>synchronized可以写在静态方法上，表示找类锁</p>
<p>异步：谁也不需要等谁，多线程并发（效率较高）</p>
<p>死锁</p>
<h3 id="反射机制"><a href="#反射机制" class="headerlink" title="反射机制"></a>反射机制</h3><p>通过java中的反射机制，可以操作字节码文件</p>
<h4 id="反射机制相关的重要类"><a href="#反射机制相关的重要类" class="headerlink" title="反射机制相关的重要类"></a>反射机制相关的重要类</h4><p>java.lang.Class：代表整个字节码，代表一个类型（整个类）</p>
<p>java.lang.reflect.Method：代表字节码中的方法字节码（类中的方法）</p>
<p>java.lang.reflect.Constructor：代表字节码中的构造方法字节码（类中的构造方法）</p>
<p>java.lang.reflect.Field：代表字节码中的属性字节码（类中的静态变量和实例变量）</p>
<h4 id="获取字节码（Class）"><a href="#获取字节码（Class）" class="headerlink" title="获取字节码（Class）"></a>获取字节码（Class）</h4><h5 id="Class-forName-“”"><a href="#Class-forName-“”" class="headerlink" title="Class.forName(“”);"></a>Class.forName(“”);</h5><p>是一个静态方法，方法的参数是一个字符串，字符串是一个完整的类名（带有包名）</p>
<p>这个代码的执行会加载类，所以类会执行静态代码块</p>
<h5 id="getClass-方法"><a href="#getClass-方法" class="headerlink" title="getClass()方法"></a>getClass()方法</h5><h5 id="任何类型-class"><a href="#任何类型-class" class="headerlink" title="任何类型.class"></a>任何类型.class</h5><h4 id="利用反射机制获取对象的属性（Field）"><a href="#利用反射机制获取对象的属性（Field）" class="headerlink" title="利用反射机制获取对象的属性（Field）"></a>利用反射机制获取对象的属性（Field）</h4><p>首先获取整个类（利用Class.forName(“带包名的完整类名”)方法），然后创建该类文件的对象（利用利用newInstance()方法调用无参构造函数）</p>
<p>通过getDeclaredField(“属性名”)方法获取单个属性</p>
<p>利用set(对象，值)方法修改属性的值</p>
<p>利用get(对象)方法获取属性的值</p>
<p>（私有属性调用setAccessible(true)方法打破封装，才能获取到属性）</p>
<p>获取整个类之后再用getFileds()方法获取类中public修饰的所有属性，利用getDeclaredFileds()方法获取所有属性，利用getType()和getName方法获取属性的类型，用过getName()方法获取属性的名字，通过getModifiers()获取修饰符列表（返回的是修饰符代码int类型，利用Modifier.toString()方法将代号转换为字符串）</p>
<h4 id="利用反射机制调用方法（Method）"><a href="#利用反射机制调用方法（Method）" class="headerlink" title="利用反射机制调用方法（Method）"></a>利用反射机制调用方法（Method）</h4><p>首先获取整个类（利用Class.forName(“带包名的完整类名”)方法），然后创建该类文件的对象（利用newInstance()方法调用无参构造函数）</p>
<p>通过getDeclaredMethod(“方法名”， 形参类型.class)方法获取方法</p>
<p>利用invoke(对象，实参)方法调用类的方法</p>
<h4 id="利用反射机制创建对象"><a href="#利用反射机制创建对象" class="headerlink" title="利用反射机制创建对象"></a>利用反射机制创建对象</h4><p>首先获取整个类（利用Class.forName(“带包名的完整类名”)方法）</p>
<p>利用getDeclaredConstructor(形参类型.class)获取有参构造方法</p>
<p>利用newInstance()方法调用无参构造函数创建对象</p>
<h4 id="利用反射机制获取注解"><a href="#利用反射机制获取注解" class="headerlink" title="利用反射机制获取注解"></a>利用反射机制获取注解</h4><p>首先获取整个类（利用Class.forName(“带包名的完整类名”)方法）</p>
<p>利用isAnnotationPresent(x.class)方法判断类上是否有注解@x</p>
<p>利用getAnnotation(x.class)方法获取注解对象</p>
<p>利用注解对象.属性名()获取注解中的属性</p>
<h4 id="获取父类和父接口"><a href="#获取父类和父接口" class="headerlink" title="获取父类和父接口"></a>获取父类和父接口</h4><p>利用getSuperclass()方法获取父类</p>
<p>利用getSuperclass()方法获取所有接口</p>
<h3 id="注解（注释）"><a href="#注解（注释）" class="headerlink" title="注解（注释）"></a>注解（注释）</h3><p>注解Annotation是一种引用数据类型，编译之后也会生成xx.class文件</p>
<p>语法：</p>
<p>​	[修饰符列表] @interface 注解类型名{}</p>
<p>使用规则：</p>
<pre><code> 1. @注解类型名
 2. 默认注解可以出现在任何位置上
</code></pre>
<p>如果注解中有属性，调用时必须给属性赋值（属性名 &#x3D; 属性值），除非利用default给属性指定默认值</p>
<p>（如果注解中只有一个属性名为value的属性，调用该注解可以直接给属性赋值（属性值））</p>
<h4 id="Override注解"><a href="#Override注解" class="headerlink" title="@Override注解"></a>@Override注解</h4><p>@Override注解只能注解方法</p>
<p>@Override注解是给编译器参考的，和运行阶段无关</p>
<p>java中的方法带有这个注解的，编译器都会进行编译检查，如果这个注解不是重写父类的方法，编译器报错</p>
<h4 id="元注解"><a href="#元注解" class="headerlink" title="元注解"></a>元注解</h4><p>用来标注“注解类型”的“注解”，成为元注解</p>
<h5 id="常见的元注解"><a href="#常见的元注解" class="headerlink" title="常见的元注解"></a>常见的元注解</h5><p>@Target(ElementType.METHOD)元注解：只能出现在方法上</p>
<p>@Retention(RetentionPolicy.SOURCE)元注解：只能保留在java源文件中</p>
<p>@Retention(RetentionPolicy.CLASS)元注解：保存在class文件中</p>
<p>@Retention(RetentionPolicy.RUNTIME)元注解：保存在class文件中，并且可以被反射机制读取到</p>
<h3 id="窗口创建"><a href="#窗口创建" class="headerlink" title="窗口创建"></a>窗口创建</h3><h4 id="创建窗体"><a href="#创建窗体" class="headerlink" title="创建窗体"></a>创建窗体</h4><p>窗体类：javax.swing.JFrame</p>
<p>​				创建一个类继承JFrame类，在该类中给窗口设置属性</p>
<p>​						setTitle()：设置窗口标题</p>
<p>​						setSize()：设置窗口大小</p>
<p>​						setLocationRelativeTo(null)：设置窗口位置，null表示相当于屏幕左上角居中</p>
<p>​						setResizable(false)：设置不允许玩家改变窗口大小，默认为true</p>
<p>​						setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE)：设置关闭窗口时结束程序</p>
<p>​						在主程序将窗口显示：setVisible(true)</p>
<p>面板类：javax.swing.JPanel</p>
<p>​				创建一个类继承JPanel类，在给类中给面板设置属性，在该类创建游戏的一切事物</p>
<p>​				创建完成之后，new Thread(){}.start()新开启一个线程，运行面板游戏中的事物</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用鼠标监听器</span></span><br><span class="line"><span class="type">MouseAdapter</span> <span class="variable">adapter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MouseAdapter</span>() &#123;</span><br><span class="line">    <span class="comment">//创建鼠标适配器</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//将鼠标适配器装入到面板监听器中</span></span><br><span class="line">addMouseListener(adapter);</span><br><span class="line">addMouseMotionListener(adapter);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">KeyAdapter</span> <span class="variable">adapter1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">KeyAdapter</span>() &#123;</span><br><span class="line">    <span class="comment">//创建键盘适配器</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//将键盘适配器添加到窗体的监视器中</span></span><br><span class="line">frame.addKeyListener(adapter1);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//专门画图的方法，将图片画到面板中</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">paint</span><span class="params">(Graphics g)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.paint(g);</span><br><span class="line">        <span class="comment">//画背景</span></span><br><span class="line">        g.drawImage(bj, <span class="number">0</span>, <span class="number">0</span>, <span class="number">500</span>, <span class="number">800</span>, <span class="literal">null</span>);</span><br><span class="line">        <span class="comment">//画战斗机</span></span><br><span class="line">        g.drawImage(hero.img, hero.x, hero.y, hero.w, hero.h, <span class="literal">null</span>);</span><br><span class="line">        <span class="comment">//画分数</span></span><br><span class="line">        g.setColor(Color.WHITE);</span><br><span class="line">        g.setFont(<span class="keyword">new</span> <span class="title class_">Font</span>(<span class="string">&quot;楷体&quot;</span>, Font.BOLD, <span class="number">20</span>));</span><br><span class="line">        g.drawString(<span class="string">&quot;分数：&quot;</span>+score, <span class="number">10</span>, <span class="number">30</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取图片的类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建静态方法，调用时不用创建对象，直接用类名调用</span></span><br><span class="line"><span class="comment">     * path 获取该项目中的相对路径</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> BufferedImage <span class="title function_">getImg</span><span class="params">(String path)</span>&#123;</span><br><span class="line">        <span class="comment">//使用反射机制获取该类的路径,相对于src</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">BufferedImage</span> <span class="variable">img</span> <span class="operator">=</span> ImageIO.read(App.class.getResource(path));</span><br><span class="line">            <span class="comment">//如果找到图片返回该图片</span></span><br><span class="line">            <span class="keyword">return</span> img;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="comment">//没有找对该图片则抛出异常，程序停止运行</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="零碎知识"><a href="#零碎知识" class="headerlink" title="零碎知识"></a>零碎知识</h3><h5 id="JVM内存"><a href="#JVM内存" class="headerlink" title="JVM内存"></a>JVM内存</h5><p>方法区内存：存放class字节码代码片段，静态变量存放在方法区内存中</p>
<p>栈内存：执行方法时分配的内存</p>
<p>堆内存：存放new创建的对象</p>
<h5 id="Javac是一个编译器工具"><a href="#Javac是一个编译器工具" class="headerlink" title="Javac是一个编译器工具"></a>Javac是一个编译器工具</h5><p>javac  java源文件路径（在DOS中使用）</p>
<p>配置path环境，使在任意位置都可以使用javac</p>
<p>java源文件编译之后生成一个class文件，最终程序运行class文件</p>
<h5 id="java是一个运行工具"><a href="#java是一个运行工具" class="headerlink" title="java是一个运行工具"></a>java是一个运行工具</h5><p>java  类名（在DOS中使用，使用时必须将目录打开到该类所在的目录）</p>
<p>配置classpath环境，使在当前路径可以使用java</p>
<h5 id="javadoc注释"><a href="#javadoc注释" class="headerlink" title="javadoc注释"></a>javadoc注释</h5><p>&#x2F;**</p>
<ul>
<li></li>
<li></li>
</ul>
<p>*&#x2F;  该注释会被javadoc.exe工具解析提取并生成帮助文档</p>
<h5 id="public-class-和class的区别"><a href="#public-class-和class的区别" class="headerlink" title="public class 和class的区别"></a>public class 和class的区别</h5><p>一个 java源文件中可以有多个class</p>
<p>一个java源文件中的一个class会生成一个**.class字节码文件</p>
<p>一个java源文件中不是必须包含public class ，如果包含则源文件名和该类名必须保持一致（只能包含一个public class）</p>
<p>每个class中可以编写一个main方法，运行时可以单个执行class字节码文件</p>
<h5 id="定时器"><a href="#定时器" class="headerlink" title="定时器"></a>定时器</h5><p>间隔特定的时间，指定特定的程序</p>
<p>定时器：java.util.Timer</p>
<p>​	schedule(定时任务，定时开始时间，定时时间)</p>
<p>Spring框架中有定时器</p>
<h5 id="可变长度参数"><a href="#可变长度参数" class="headerlink" title="可变长度参数"></a>可变长度参数</h5><p>语法：类型…</p>
<p>参数长度为0-n个</p>
<p>可变长度参数列表必须在最后一个位置上，而且只能有一个</p>
<p>可变长度参数可以看成是一个数组</p>
<h5 id="类加载器"><a href="#类加载器" class="headerlink" title="类加载器"></a>类加载器</h5><p>启动类加载器：加载C:\Program Files\Java\jdk1.8.0_221\jre\lib\rt.jar</p>
<p>扩展类加载器：C:\Program Files\Java\jdk1.8.0_221\jre\lib\ext*.jar</p>
<p>应用类加载器：classpath中的jar包</p>
<p>代码在开始执行之前，会将所需要的类全部加载到JVM当中</p>
<p>首先通过启动类加载器，如果通过类加载器加载不到时，会通过拓展类加载器加载，如果拓展类加载器加载不到，会通过应用类加载器加载</p>
<p>java中为了保证类加载的安全使用了双亲委派机制</p>
<h5 id="实例化对象"><a href="#实例化对象" class="headerlink" title="实例化对象"></a>实例化对象</h5><p>通过newInstance()方法，实例化对象（内部实际上调用了无参构造方法）</p>
<p>通过IO流读取属性文件（&#x3D;形式），将文件内容加载到Map集合中，通过key获取value，通过反射机制获取字节码文件，在创建对象</p>
<h5 id="获取一个文件的绝对路径"><a href="#获取一个文件的绝对路径" class="headerlink" title="获取一个文件的绝对路径"></a>获取一个文件的绝对路径</h5><p>Thread.currentThread().getContextClassLoader().getResource(“文件名.文件类型”).getPath();</p>
<p>该文件必须在类（src）目录下</p>
<h5 id="资源绑定器"><a href="#资源绑定器" class="headerlink" title="资源绑定器"></a>资源绑定器</h5><p>只能绑定xx.properties文件，并且该文件必须在类路径下</p>
<p>ResourceBundle bundle &#x3D; ResourceBundle.getBundle(“文件名”);</p>
<h5 id="UML：统一建模语言"><a href="#UML：统一建模语言" class="headerlink" title="UML：统一建模语言"></a>UML：统一建模语言</h5><p>工程初期设计类与类之间的关系</p>
<h5 id="Scanner类"><a href="#Scanner类" class="headerlink" title="Scanner类"></a>Scanner类</h5><p>在包java.util中</p>
<h5 id="转义字符"><a href="#转义字符" class="headerlink" title="转义字符\"></a>转义字符\</h5><p>\将普通字符转义为特殊字符，将特殊字符转义为普通字符</p>
<h5 id="native2ascii-exe命令"><a href="#native2ascii-exe命令" class="headerlink" title="native2ascii.exe命令"></a>native2ascii.exe命令</h5><p>将文字转化为unicode编码形式</p>
<h5 id="字面值"><a href="#字面值" class="headerlink" title="字面值"></a>字面值</h5><p>字面值就是数据</p>
<h5 id="包机制packa"><a href="#包机制packa" class="headerlink" title="包机制packa"></a>包机制packa</h5><p>在java源文件中的第一句编写package语句（package 包名）</p>
<p>包名：公司域名倒序+项目名+模块+功能名</p>
<p>使用package机制后，运行时要创建想要的文件夹（类名变为包名（调用时））</p>
<h5 id="import"><a href="#import" class="headerlink" title="import"></a>import</h5><p>用来完成导入其他类</p>
<p>import 类名   或   import 包名.*</p>
<h5 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h5><p>优点：集合中存储的元素类型统一，从集合中取出的元素类型是泛型指定的类型，不需要大量的向下类型转换</p>
<p>砖石表达式：JDK8之后new 类名&lt;这里的类型会自动推断&gt;</p>
<h5 id="增强for循环：foreach"><a href="#增强for循环：foreach" class="headerlink" title="增强for循环：foreach"></a>增强for循环：foreach</h5><p>for (元素类型 变量名：数组或集合){</p>
<p>​	System.out.println(变量名);  输出的就是数组或集合的各个元素</p>
<p>}  </p>
<p>缺点：没有下标</p>
<h5 id="java对日期的处理"><a href="#java对日期的处理" class="headerlink" title="java对日期的处理"></a>java对日期的处理</h5><ol>
<li><p>获取系统时间：java.util.Date Time &#x3D; new java.util.Date();直接调用无参构造方法，获取系统时间</p>
</li>
<li><p>Date转换为String：java.text.SimpleDateFormat sdf &#x3D; new java.text.SimpleDateFormat(“yyyy-MM-dd HH:mm:ss SSS”);专门处理设置输出时日期格式</p>
<p>（年y，月M，日d，时H，分m，秒s，毫秒S）几个表示几位</p>
<p>用该格式调用format()方法，将获取的系统时间传入，输出日期</p>
</li>
<li><p>String转换为Date：调用parse()方法（字符串字符格式和SimpleDateFormat格式要相同）</p>
</li>
</ol>
<p>long x &#x3D; System.currentTimeMillis();获取一个毫秒数</p>
<p>高精度处理数字：BigDecimal();</p>
<h5 id="通过常量获取最大值最小值"><a href="#通过常量获取最大值最小值" class="headerlink" title="通过常量获取最大值最小值"></a>通过常量获取最大值最小值</h5><p>最大值：包装类.MAX_VALUE</p>
<p>最小值：枣庄类.MIN_VALUE</p>
<h5 id="String、int、Integer之间的互相转换"><a href="#String、int、Integer之间的互相转换" class="headerlink" title="String、int、Integer之间的互相转换"></a>String、int、Integer之间的互相转换</h5><p>String-int:Integer.parseInt(“123”);</p>
<p>int-String:数字+‘’“，String.valueOf(int)</p>
<p>int-Integer:装箱</p>
<p>Integer-int:装箱</p>
<p>String-Integer:Integer.valueOf(“123”)</p>
<p>Integer-String:Integer.valueOf(Integer对象)</p>
<h5 id="main方法String参数"><a href="#main方法String参数" class="headerlink" title="main方法String参数"></a>main方法String参数</h5><p>接收用户参数，可以通过Run-Edit设置账户，密码</p>
<h5 id="类型和类型之间的关系"><a href="#类型和类型之间的关系" class="headerlink" title="类型和类型之间的关系"></a>类型和类型之间的关系</h5><p>is a（我是一个人）（A extends B）：满足is a的表示继承关系</p>
<p>has a（我有一个电脑）(A{ B b; })：满足has a的表示关联关系  通常以属性的方式存在</p>
<p>like a（厨师像菜单）(A implements B)：满足like a的表示实现关系  通常是类实现接口</p>
<h5 id="内部类-1"><a href="#内部类-1" class="headerlink" title="内部类"></a>内部类</h5><p>静态内部类</p>
<p>实例内部类</p>
<p>局部内部类</p>
<p>匿名内部类：new一个接口，但是要加{}实现接口中的抽象方法</p>
<h5 id="集成开发环境IDE"><a href="#集成开发环境IDE" class="headerlink" title="集成开发环境IDE"></a>集成开发环境IDE</h5><p>workspace：工作区，将编写的java代码和自动生成的class字节码文件存放在工作区</p>
<p>.metadata文件存放MEclipse软件的工作状态</p>
<p>打开窗口：Window–show view–Other</p>
<p>切换布局：右上角</p>
<p>还原布局：window–reset</p>
<p>Package Explore、Navigator、Project Explore：可以看到java源文件</p>
<p>Console：控制台窗口</p>
<p>创建java工程：创建工程名称（一般小写），指定java存放的路径，选择java运行环境（JRE配置），Project layout工程的目录布局（多数情况下，选择两个独立的文件夹存放源码src和字节码bin），在src目录下创建软件包（package机制）new–package，在软件包下创建一个java类new–class</p>
<p>显示行号：左侧栏–show line number</p>
<p>字体设置：window–Preferences–输入font–colors and fonts–Basic–Text Font–Edit</p>
<p>快捷键：ctrl-D 删除一行，alt-&#x2F;自动补全，出现红色下划线表示出错Ctrl -1自动纠错，Ctrl-&#x2F;单行注释，Ctrl-shift-&#x2F;多行注释</p>
<p>Ctrl-鼠标移动到该位置点击可查看访问那个属性，alt+insert快速生成</p>
<p>设置断点–右键–Debug</p>
<h5 id="空指针异常"><a href="#空指针异常" class="headerlink" title="空指针异常"></a>空指针异常</h5><p>编译会通过，运行时出现错误：java.lang.NullPointerException</p>
<p>原因：空引用访问“实例”相关的数据一定会出现空指针异常（实例相关的数据：有对象参与的数据）</p>
<p>（当对象呗回收了，但引用还指向该对象时引起的空引用）</p>
<h5 id="键盘输入数据"><a href="#键盘输入数据" class="headerlink" title="键盘输入数据"></a>键盘输入数据</h5><p>java.util.Scanner s &#x3D; new  java.util.Scanner(System.in);</p>
<p>String str &#x3D; s.next();或int num &#x3D; s.nextInt();</p>
<h5 id="屏幕输出"><a href="#屏幕输出" class="headerlink" title="屏幕输出"></a>屏幕输出</h5><p>System.out.println(“”);</p>
<h5 id="自动垃圾回收机制（GC机制）"><a href="#自动垃圾回收机制（GC机制）" class="headerlink" title="自动垃圾回收机制（GC机制）"></a>自动垃圾回收机制（GC机制）</h5><p>当堆内存中的java对象成为垃圾数据时会被垃圾回收器回收</p>
<h3 id="日志技术"><a href="#日志技术" class="headerlink" title="日志技术"></a>日志技术</h3><p>可以将系统执行的信息选择性的记录到指定的位置（控制台、文件中、数据库中）。</p>
<p>可以随时以开关的形式控制是否记录日志，无需修改源代码。</p>
<p>使用：</p>
<p>在项目下新建文件夹lib，导入Logback的相关jar包到该文件夹下，并添加到项目依赖库中去。</p>
<p>②：将Logback的核心配置文件logback.xml直接拷贝到src目录下（必须是src下）。<br>③：在代码中获取日志的对象</p>
<p>public static final Logger LOGGER &#x3D; LoggerFactory.getLogger(“类对象”);</p>
<p>④：使用日志对象LOGGER调用其方法输出不能的日志信息</p>
<p>输出到控制台的配置标志：<appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender"></p>
<p>输出到系统文件的配置标志：<appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender"></p>
<p>具体在<root level="INFO">标签的level属性中设置日志级别。</p>
<h3 id="网络编程"><a href="#网络编程" class="headerlink" title="网络编程"></a>网络编程</h3><p><strong>实现网络编程关键的三要素</strong></p>
<p>​	IP地址：设备在网络中的地址，是唯一的标识。<br>​	端口：应用程序在设备中唯一的标识。<br>​	协议:   数据在网络中传输的规则，常见的协议有UDP协议和TCP协议。</p>
<p><strong>IP常用命令：</strong><br>    ipconfig：查看本机IP地址<br>    ping IP地址：检查网络是否连通</p>
<p>注意：本机IP: 127.0.0.1或者localhost：称为回送地址也可称本地回环地址，只会寻找当前所在本机</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/11/16/JAVA/" data-id="cl3u71bjw000a380lbyqxexif" data-title="JAVA" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; 上一页</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">五月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">四月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">三月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">一月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">十一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/05/31/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2022/04/04/LeetCode/">LeetCode</a>
          </li>
        
          <li>
            <a href="/2022/04/01/SpringBoot2/">SpringBoot2</a>
          </li>
        
          <li>
            <a href="/2022/03/30/MyBatisPlus/">MyBatis-Plus</a>
          </li>
        
          <li>
            <a href="/2022/03/29/RabbitMQ/">RabbitMQ</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 ��ǿ��Сǿ<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>